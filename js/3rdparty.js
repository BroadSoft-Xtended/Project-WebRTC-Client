/***************************************************
* Created on Mon Jan 14 15:32:43 GMT 2013 by:
*
* Copyright 2013 Broadsoft
* http://www.broadsoft.com
***************************************************/


function getLastValue(a,b,c,d){return getLastValueAt(a,b,c,d,1)}function getLastValueAt(a,b,c,d,e){var f=getDataSeries(a.id,b,c,d);return f?f.dataPoints_[f.dataPoints_.length-e].value:null}function getAvgValue(a,b,c,d){var e=getDataSeries(a.id,b,c,d);return e?e.getAvg():null}function getDataSeries(a,b,c,d){var e=this.dataSeriesId(a,b,c,d);return dataSeries[e]}function getValueBefore(a,b,c,d,e){var f=this.dataSeriesId(a.id,b,c,d),g=dataSeries[f];if(g){for(i=g.dataPoints_.length-1;i>=0;i--)if(g.dataPoints_[i].time<e)return g.dataPoints_[i].value;return g.dataPoints_[0].value}return null}function dataSeriesId(a,b,c,d){return a+"-"+b+"-"+c+"-"+d}function graphViewId(a,b,c,d){return a.id+"-"+b+"-"+c+"-"+d}function matchesType(a,b,c){return"video"==b&&isVideoStats(c)?!0:"audio"==b&&isAudioStats(c)&&("googJitterReceived"!=a||containsLabel(c,"audioOutputLevel"))?!0:!1}function isVideoStats(a){return containsLabel(a,"googFrameHeightSent")||containsLabel(a,"googFrameHeightReceived")}function isAudioStats(a){return containsLabel(a,"audioInputLevel")||containsLabel(a,"audioOutputLevel")}function getStatsDataType(a,b){return isVideoStats(b)?"video":isAudioStats(b)&&("googJitterReceived"!=a||containsLabel(b,"audioOutputLevel"))?"audio":null}function containsLabel(a,b){for(var c=0;c<a.length-1;c+=2)if(a[c]==b)return!0;return!1}function updateGraph(a,b,c,d,e){var f=bweCompoundGraphConfig[e]?"bweCompound":e,g=this.graphViewId(a,b,c,f);if(!graphViews[g]){var h=getStatsDataType(e,d.values);graphViews[g]=createStatsGraphView(a,b,c,f,h);var i=new Date(d.timestamp);graphViews[g].setDateRange(i,i)}var j=this.dataSeriesId(a.id,b,c,e);graphViews[g].hasDataSeries(dataSeries[j])||graphViews[g].addDataSeries(dataSeries[j]),graphViews[g].updateEndDate()}function drawSingleReport(a,b,c,d){if(d&&d.values)for(var e=0;e<d.values.length-1;e+=2){var f=d.values[e],g=parseInt(d.values[e+1]);if(!isNaN(g)){var h=dataSeriesId(a.id,b,c,f),i=h,j=f,k=g;dataConversionConfig[f]&&(addDataSeriesPoint(h,d.timestamp,f,g),k=dataConversionConfig[f].convertFunction(dataSeries[h],a,b,c),j=dataConversionConfig[f].convertedName,i=dataSeriesId(a.id,b,c,j)),addDataSeriesPoint(i,d.timestamp,j,k),updateGraph(a,b,c,d,f),j!=f&&updateGraph(a,b,c,d,j)}}}function addDataSeriesPoint(a,b,c,d){dataSeries[a]||(dataSeries[a]=new TimelineDataSeries,bweCompoundGraphConfig[c]&&dataSeries[a].setColor(bweCompoundGraphConfig[c].color)),"packetsLost"==c&&0>d&&(d=0),dataSeries[a].addPoint(b,d)}function ensureStatsGraphTopContainer(a,b,c){var d=a.id+"-"+b+"-"+c+"-graph-container",e=$('[id="'+d+'"]')[0];return e||(e=document.createElement("div"),e.id=d,e.className="stats-graph-container",a.appendChild(e)),e}function createStatsGraphView(a,b,c,d,e){var f=ensureStatsGraphTopContainer(a,b,c),g=a.id+"-"+b+"-"+c+"-"+d,h=g+"-div",i=g+"-canvas",j=document.createElement("div");return j.className="stats-graph-sub-container "+d+"-"+e,f.appendChild(j),j.innerHTML="<div>"+d+"</div><div id="+h+"><canvas id="+i+"></canvas></div>","bweCompound"==d&&j.insertBefore(createBweCompoundLegend(a,b+"-"+c),$('[id="'+h+'"]')[0]),new TimelineGraphView(h,i)}function createBweCompoundLegend(a,b){var c=document.createElement("div");for(var d in bweCompoundGraphConfig){var e=document.createElement("div");c.appendChild(e),e.innerHTML="<input type=checkbox checked></input>"+d,e.style.color=bweCompoundGraphConfig[d].color,e.dataSeriesId=a.id+"-"+b+"-"+d,e.graphViewId=a.id+"-"+b+"-bweCompound",e.firstChild.addEventListener("click",function(a){var b=dataSeries[a.target.parentNode.dataSeriesId];b.show(a.target.checked),graphViews[a.target.parentNode.graphViewId].repaint()})}return c}function initialize(){ssrcInfoManager=new SsrcInfoManager,peerConnectionUpdateTable=new PeerConnectionUpdateTable,statsTable=new StatsTable(ssrcInfoManager)}function getPeerConnectionId(a){return a.pid+"-"+a.lid}function extractSsrcInfo(a){("setLocalDescription"==a.type||"setRemoteDescription"==a.type)&&ssrcInfoManager.addSsrcStreamInfo(a.value)}function removePeerConnection(a){var b=$('[id="'+getPeerConnectionId(a)+'"]')[0];b&&peerConnectionsListElem.removeChild(b)}function addPeerConnection(a){var b=$('[id="'+getPeerConnectionId(a)+'"]')[0];return b||(b=document.createElement("li"),peerConnectionsListElem.appendChild(b),b.id=getPeerConnectionId(a)),b.innerHTML="<h3>PeerConnection "+b.id+"</h3><div>"+a.url+" "+a.servers+" "+a.constraints+"</div>",b.firstChild.title="Click to collapse or expand",b.firstChild.addEventListener("click",function(a){a.target.parentElement.className=""==a.target.parentElement.className?"peer-connection-hidden":""}),b}function updatePeerConnection(a){var b=$('[id="'+getPeerConnectionId(a)+'"]')[0];peerConnectionUpdateTable.addPeerConnectionUpdate(b,a),extractSsrcInfo(a)}function updateAllPeerConnections(a){for(var b=0;b<a.length;++b)for(var c=addPeerConnection(a[b]),d=a[b].log,e=0;e<d.length;++e)peerConnectionUpdateTable.addPeerConnectionUpdate(c,d[e]),extractSsrcInfo(d[e])}function addStats(a){var b=getPeerConnectionElement(a);if(b)for(var c=0;c<a.reports.length;++c){var d=a.reports[c];if(drawSingleReport(b,d.type,d.id,d.stats),statsTable.addStatsReport(b,d.type,d.id,d),isVideoStats(d.stats.values)){var e=new Date((new Date).getTime()-6e4),f=getLastValue(b,d.type,d.id,"packetsLost"),g=getLastValue(b,d.type,d.id,"packetsReceived");if(null!=f&&null!=g){var h=getValueBefore(b,d.type,d.id,"packetsLost",e),i=getValueBefore(b,d.type,d.id,"packetsReceived",e),j=(f-h)/(g-i)*100;10>j?($("#quality1").fadeIn(10),$("#quality2, #quality3, #quality4").fadeOut(10)):j>10&&20>j?($("#quality2").fadeIn(10),$("#quality1, #quality3, #quality4").fadeOut(10)):j>20&&100>j?($("#quality3").fadeIn(10),$("#quality1, #quality2, #quality4").fadeOut(10)):j>100&&1e3>j&&($("#quality4").fadeIn(10),$("#quality1, #quality2, #quality3").fadeOut(10))}}}}function getPeerConnectionElement(a){return $('[id="'+getPeerConnectionId(a)+'"]')[0]}function updateDumpStatus(a){dumpCreator.onUpdate(a)}function hex_sha1(a){return binb2hex(core_sha1(str2binb(a),a.length*chrsz))}function b64_sha1(a){return binb2b64(core_sha1(str2binb(a),a.length*chrsz))}function str_sha1(a){return binb2str(core_sha1(str2binb(a),a.length*chrsz))}function hex_hmac_sha1(a,b){return binb2hex(core_hmac_sha1(a,b))}function b64_hmac_sha1(a,b){return binb2b64(core_hmac_sha1(a,b))}function str_hmac_sha1(a,b){return binb2str(core_hmac_sha1(a,b))}function sha1_vm_test(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==hex_sha1("abc")}function core_sha1(a,b){a[b>>5]|=128<<24-b%32,a[(b+64>>9<<4)+15]=b;var c,d,e,f,g,h,i,j,k=new Array(80),l=1732584193,m=-271733879,n=-1732584194,o=271733878,p=-1009589776;for(c=0;c<a.length;c+=16){for(f=l,g=m,h=n,i=o,j=p,d=0;80>d;d++)k[d]=16>d?a[c+d]:rol(k[d-3]^k[d-8]^k[d-14]^k[d-16],1),e=safe_add(safe_add(rol(l,5),sha1_ft(d,m,n,o)),safe_add(safe_add(p,k[d]),sha1_kt(d))),p=o,o=n,n=rol(m,30),m=l,l=e;l=safe_add(l,f),m=safe_add(m,g),n=safe_add(n,h),o=safe_add(o,i),p=safe_add(p,j)}return[l,m,n,o,p]}function sha1_ft(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d}function sha1_kt(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514}function core_hmac_sha1(a,b){var c=str2binb(a);c.length>16&&(c=core_sha1(c,a.length*chrsz));for(var d=new Array(16),e=new Array(16),f=0;16>f;f++)d[f]=909522486^c[f],e[f]=1549556828^c[f];var g=core_sha1(d.concat(str2binb(b)),512+b.length*chrsz);return core_sha1(e.concat(g),672)}function safe_add(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function rol(a,b){return a<<b|a>>>32-b}function str2binb(a){for(var b=[],c=(1<<chrsz)-1,d=0;d<a.length*chrsz;d+=chrsz)b[d>>5]|=(a.charCodeAt(d/chrsz)&c)<<32-chrsz-d%32;return b}function binb2str(a){for(var b="",c=(1<<chrsz)-1,d=0;d<32*a.length;d+=chrsz)b+=String.fromCharCode(a[d>>5]>>>32-chrsz-d%32&c);return b}function binb2hex(a){for(var b=hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(a[d>>2]>>8*(3-d%4)+4&15)+b.charAt(a[d>>2]>>8*(3-d%4)&15);return c}function binb2b64(a){for(var b,c,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e="",f=0;f<4*a.length;f+=3)for(b=(a[f>>2]>>8*(3-f%4)&255)<<16|(a[f+1>>2]>>8*(3-(f+1)%4)&255)<<8|a[f+2>>2]>>8*(3-(f+2)%4)&255,c=0;4>c;c++)e+=8*f+6*c>32*a.length?b64pad:d.charAt(b>>6*(3-c)&63);return e}!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function c(a){var b=a.length,c=fb.type(a);return"function"===c||fb.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}function d(a,b,c){if(fb.isFunction(b))return fb.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return fb.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(nb.test(b))return fb.filter(b,a,c);b=fb.filter(b,a)}return fb.grep(a,function(a){return fb.inArray(a,b)>=0!==c})}function e(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}function f(a){var b=vb[a]={};return fb.each(a.match(ub)||[],function(a,c){b[c]=!0}),b}function g(){pb.addEventListener?(pb.removeEventListener("DOMContentLoaded",h,!1),a.removeEventListener("load",h,!1)):(pb.detachEvent("onreadystatechange",h),a.detachEvent("onload",h))}function h(){(pb.addEventListener||"load"===event.type||"complete"===pb.readyState)&&(g(),fb.ready())}function i(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(Ab,"-$1").toLowerCase();if(c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:zb.test(c)?fb.parseJSON(c):c}catch(e){}fb.data(a,b,c)}else c=void 0}return c}function j(a){var b;for(b in a)if(("data"!==b||!fb.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function k(a,b,c,d){if(fb.acceptData(a)){var e,f,g=fb.expando,h=a.nodeType,i=h?fb.cache:a,j=h?a[g]:a[g]&&g;if(j&&i[j]&&(d||i[j].data)||void 0!==c||"string"!=typeof b)return j||(j=h?a[g]=W.pop()||fb.guid++:g),i[j]||(i[j]=h?{}:{toJSON:fb.noop}),("object"==typeof b||"function"==typeof b)&&(d?i[j]=fb.extend(i[j],b):i[j].data=fb.extend(i[j].data,b)),f=i[j],d||(f.data||(f.data={}),f=f.data),void 0!==c&&(f[fb.camelCase(b)]=c),"string"==typeof b?(e=f[b],null==e&&(e=f[fb.camelCase(b)])):e=f,e}}function l(a,b,c){if(fb.acceptData(a)){var d,e,f=a.nodeType,g=f?fb.cache:a,h=f?a[fb.expando]:fb.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){fb.isArray(b)?b=b.concat(fb.map(b,fb.camelCase)):b in d?b=[b]:(b=fb.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;for(;e--;)delete d[b[e]];if(c?!j(d):!fb.isEmptyObject(d))return}(c||(delete g[h].data,j(g[h])))&&(f?fb.cleanData([a],!0):db.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}function m(){return!0}function n(){return!1}function o(){try{return pb.activeElement}catch(a){}}function p(a){var b=Lb.split("|"),c=a.createDocumentFragment();if(c.createElement)for(;b.length;)c.createElement(b.pop());return c}function q(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==yb?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==yb?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||fb.nodeName(d,b)?f.push(d):fb.merge(f,q(d,b));return void 0===b||b&&fb.nodeName(a,b)?fb.merge([a],f):f}function r(a){Fb.test(a.type)&&(a.defaultChecked=a.checked)}function s(a,b){return fb.nodeName(a,"table")&&fb.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function t(a){return a.type=(null!==fb.find.attr(a,"type"))+"/"+a.type,a}function u(a){var b=Wb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function v(a,b){for(var c,d=0;null!=(c=a[d]);d++)fb._data(c,"globalEval",!b||fb._data(b[d],"globalEval"))}function w(a,b){if(1===b.nodeType&&fb.hasData(a)){var c,d,e,f=fb._data(a),g=fb._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)fb.event.add(b,c,h[c][d])}g.data&&(g.data=fb.extend({},g.data))}}function x(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!db.noCloneEvent&&b[fb.expando]){e=fb._data(b);for(d in e.events)fb.removeEvent(b,d,e.handle);b.removeAttribute(fb.expando)}"script"===c&&b.text!==a.text?(t(b).text=a.text,u(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),db.html5Clone&&a.innerHTML&&!fb.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&Fb.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}}function y(b,c){var d=fb(c.createElement(b)).appendTo(c.body),e=a.getDefaultComputedStyle?a.getDefaultComputedStyle(d[0]).display:fb.css(d[0],"display");return d.detach(),e}function z(a){var b=pb,c=ac[a];return c||(c=y(a,b),"none"!==c&&c||(_b=(_b||fb("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(_b[0].contentWindow||_b[0].contentDocument).document,b.write(),b.close(),c=y(a,b),_b.detach()),ac[a]=c),c}function A(a,b){return{get:function(){var c=a();return null!=c?c?void delete this.get:(this.get=b).apply(this,arguments):void 0}}}function B(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=nc.length;e--;)if(b=nc[e]+c,b in a)return b;return d}function C(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=fb._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&Db(d)&&(f[g]=fb._data(d,"olddisplay",z(d.nodeName)))):f[g]||(e=Db(d),(c&&"none"!==c||!e)&&fb._data(d,"olddisplay",e?c:fb.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function D(a,b,c){var d=jc.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function E(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=fb.css(a,c+Cb[f],!0,e)),d?("content"===c&&(g-=fb.css(a,"padding"+Cb[f],!0,e)),"margin"!==c&&(g-=fb.css(a,"border"+Cb[f]+"Width",!0,e))):(g+=fb.css(a,"padding"+Cb[f],!0,e),"padding"!==c&&(g+=fb.css(a,"border"+Cb[f]+"Width",!0,e)));return g}function F(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=bc(a),g=db.boxSizing()&&"border-box"===fb.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=cc(a,b,f),(0>e||null==e)&&(e=a.style[b]),ec.test(e))return e;d=g&&(db.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+E(a,b,c||(g?"border":"content"),d,f)+"px"}function G(a,b,c,d,e){return new G.prototype.init(a,b,c,d,e)}function H(){return setTimeout(function(){oc=void 0}),oc=fb.now()}function I(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=Cb[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function J(a,b,c){for(var d,e=(uc[b]||[]).concat(uc["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function K(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},n=a.style,o=a.nodeType&&Db(a),p=fb._data(a,"fxshow");c.queue||(h=fb._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,fb.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[n.overflow,n.overflowX,n.overflowY],j=fb.css(a,"display"),k=z(a.nodeName),"none"===j&&(j=k),"inline"===j&&"none"===fb.css(a,"float")&&(db.inlineBlockNeedsLayout&&"inline"!==k?n.zoom=1:n.display="inline-block")),c.overflow&&(n.overflow="hidden",db.shrinkWrapBlocks()||l.always(function(){n.overflow=c.overflow[0],n.overflowX=c.overflow[1],n.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],qc.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(o?"hide":"show")){if("show"!==e||!p||void 0===p[d])continue;o=!0}m[d]=p&&p[d]||fb.style(a,d)}if(!fb.isEmptyObject(m)){p?"hidden"in p&&(o=p.hidden):p=fb._data(a,"fxshow",{}),f&&(p.hidden=!o),o?fb(a).show():l.done(function(){fb(a).hide()}),l.done(function(){var b;fb._removeData(a,"fxshow");for(b in m)fb.style(a,b,m[b])});for(d in m)g=J(o?p[d]:0,d,l),d in p||(p[d]=g.start,o&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function L(a,b){var c,d,e,f,g;for(c in a)if(d=fb.camelCase(c),e=b[d],f=a[c],fb.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=fb.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function M(a,b,c){var d,e,f=0,g=tc.length,h=fb.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=oc||H(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:fb.extend({},b),opts:fb.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:oc||H(),duration:c.duration,tweens:[],createTween:function(b,c){var d=fb.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(L(k,j.opts.specialEasing);g>f;f++)if(d=tc[f].call(j,a,k,j.opts))return d;return fb.map(k,J,j),fb.isFunction(j.opts.start)&&j.opts.start.call(a,j),fb.fx.timer(fb.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function N(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(ub)||[];if(fb.isFunction(c))for(;d=f[e++];)"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function O(a,b,c,d){function e(h){var i;return f[h]=!0,fb.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===Sc;return e(b.dataTypes[0])||!f["*"]&&e("*")}function P(a,b){var c,d,e=fb.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&fb.extend(!0,a,c),a}function Q(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function R(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function S(a,b,c,d){var e;if(fb.isArray(b))fb.each(b,function(b,e){c||Wc.test(a)?d(a,e):S(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==fb.type(b))d(a,b);else for(e in b)S(a+"["+e+"]",b[e],c,d)}function T(){try{return new a.XMLHttpRequest}catch(b){}}function U(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function V(a){return fb.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var W=[],X=W.slice,Y=W.concat,Z=W.push,$=W.indexOf,_={},ab=_.toString,bb=_.hasOwnProperty,cb="".trim,db={},eb="1.11.0",fb=function(a,b){return new fb.fn.init(a,b)},gb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,hb=/^-ms-/,ib=/-([\da-z])/gi,jb=function(a,b){return b.toUpperCase()};fb.fn=fb.prototype={jquery:eb,constructor:fb,selector:"",length:0,toArray:function(){return X.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:X.call(this)},pushStack:function(a){var b=fb.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return fb.each(this,a,b)},map:function(a){return this.pushStack(fb.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(X.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:Z,sort:W.sort,splice:W.splice},fb.extend=fb.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||fb.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(fb.isPlainObject(c)||(b=fb.isArray(c)))?(b?(b=!1,f=a&&fb.isArray(a)?a:[]):f=a&&fb.isPlainObject(a)?a:{},g[d]=fb.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},fb.extend({expando:"jQuery"+(eb+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===fb.type(a)},isArray:Array.isArray||function(a){return"array"===fb.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return a-parseFloat(a)>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==fb.type(a)||a.nodeType||fb.isWindow(a))return!1;try{if(a.constructor&&!bb.call(a,"constructor")&&!bb.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(db.ownLast)for(b in a)return bb.call(a,b);for(b in a);return void 0===b||bb.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?_[ab.call(a)]||"object":typeof a},globalEval:function(b){b&&fb.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(hb,"ms-").replace(ib,jb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,g=a.length,h=c(a);if(d){if(h)for(;g>f&&(e=b.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=b.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=b.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),e===!1)break;return a},trim:cb&&!cb.call("﻿ ")?function(a){return null==a?"":cb.call(a)}:function(a){return null==a?"":(a+"").replace(gb,"")},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?fb.merge(d,"string"==typeof a?[a]:a):Z.call(d,a)),d},inArray:function(a,b,c){var d;if(b){if($)return $.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;)a[e++]=b[d++];if(c!==c)for(;void 0!==b[d];)a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,d){var e,f=0,g=a.length,h=c(a),i=[];if(h)for(;g>f;f++)e=b(a[f],f,d),null!=e&&i.push(e);else for(f in a)e=b(a[f],f,d),null!=e&&i.push(e);return Y.apply([],i)},guid:1,proxy:function(a,b){var c,d,e;return"string"==typeof b&&(e=a[b],b=a,a=e),fb.isFunction(a)?(c=X.call(arguments,2),d=function(){return a.apply(b||this,c.concat(X.call(arguments)))},d.guid=a.guid=a.guid||fb.guid++,d):void 0},now:function(){return+new Date},support:db}),fb.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){_["[object "+b+"]"]=b.toLowerCase()});var kb=function(a){function b(a,b,c,d){var e,f,g,h,i,j,l,o,p,q;if((b?b.ownerDocument||b:O)!==G&&F(b),b=b||G,c=c||[],!a||"string"!=typeof a)return c;if(1!==(h=b.nodeType)&&9!==h)return[];if(I&&!d){if(e=sb.exec(a))if(g=e[1]){if(9===h){if(f=b.getElementById(g),!f||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&M(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return _.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&x.getElementsByClassName&&b.getElementsByClassName)return _.apply(c,b.getElementsByClassName(g)),c}if(x.qsa&&(!J||!J.test(a))){if(o=l=N,p=b,q=9===h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(j=m(a),(l=b.getAttribute("id"))?o=l.replace(ub,"\\$&"):b.setAttribute("id",o),o="[id='"+o+"'] ",i=j.length;i--;)j[i]=o+n(j[i]);p=tb.test(a)&&k(b.parentNode)||b,q=j.join(",")}if(q)try{return _.apply(c,p.querySelectorAll(q)),c}catch(r){}finally{l||b.removeAttribute("id")}}}return v(a.replace(ib,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>y.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[N]=!0,a}function e(a){var b=G.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=a.length;d--;)y.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||W)-(~a.sourceIndex||W);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function i(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function j(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function k(a){return a&&typeof a.getElementsByTagName!==V&&a}function l(){}function m(a,c){var d,e,f,g,h,i,j,k=S[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=y.preFilter;h;){(!d||(e=jb.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=kb.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ib," ")}),h=h.slice(d.length));for(g in y.filter)!(e=ob[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):S(a,i).slice(0)}function n(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function o(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Q++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[P,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[N]||(b[N]={}),(h=i[d])&&h[0]===P&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function p(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function q(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function r(a,b,c,e,f,g){return e&&!e[N]&&(e=r(e)),f&&!f[N]&&(f=r(f,g)),d(function(d,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=d||u(b||"*",h.nodeType?[h]:h,[]),r=!a||!d&&b?p:q(p,m,a,h,i),s=c?f||(d?a:o||e)?[]:g:r;if(c&&c(r,s,h,i),e)for(j=q(s,n),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(s[n[k]]=!(r[n[k]]=l));if(d){if(f||a){if(f){for(j=[],k=s.length;k--;)(l=s[k])&&j.push(r[k]=l);f(null,s=[],j,i)}for(k=s.length;k--;)(l=s[k])&&(j=f?bb.call(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else s=q(s===g?s.splice(o,s.length):s),f?f(null,g,s,i):_.apply(g,s)})}function s(a){for(var b,c,d,e=a.length,f=y.relative[a[0].type],g=f||y.relative[" "],h=f?1:0,i=o(function(a){return a===b},g,!0),j=o(function(a){return bb.call(b,a)>-1},g,!0),k=[function(a,c,d){return!f&&(d||c!==C)||((b=c).nodeType?i(a,c,d):j(a,c,d))}];e>h;h++)if(c=y.relative[a[h].type])k=[o(p(k),c)];else{if(c=y.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;e>d&&!y.relative[a[d].type];d++);return r(h>1&&p(k),h>1&&n(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ib,"$1"),c,d>h&&s(a.slice(h,d)),e>d&&s(a=a.slice(d)),e>d&&n(a))}k.push(c)}return p(k)}function t(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,o="0",p=d&&[],r=[],s=C,t=d||f&&y.find.TAG("*",j),u=P+=null==s?1:Math.random()||.1,v=t.length;for(j&&(C=g!==G&&g);o!==v&&null!=(k=t[o]);o++){if(f&&k){for(l=0;m=a[l++];)if(m(k,g,h)){i.push(k);break}j&&(P=u)}e&&((k=!m&&k)&&n--,d&&p.push(k))}if(n+=o,e&&o!==n){for(l=0;m=c[l++];)m(p,r,g,h);if(d){if(n>0)for(;o--;)p[o]||r[o]||(r[o]=Z.call(i));r=q(r)}_.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(P=u,C=s),p};return e?d(g):g}function u(a,c,d){for(var e=0,f=c.length;f>e;e++)b(a,c[e],d);return d}function v(a,b,c,d){var e,f,g,h,i,j=m(a);if(!d&&1===j.length){if(f=j[0]=j[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&x.getById&&9===b.nodeType&&I&&y.relative[f[1].type]){if(b=(y.find.ID(g.matches[0].replace(vb,wb),b)||[])[0],!b)return c;a=a.slice(f.shift().value.length)}for(e=ob.needsContext.test(a)?0:f.length;e--&&(g=f[e],!y.relative[h=g.type]);)if((i=y.find[h])&&(d=i(g.matches[0].replace(vb,wb),tb.test(f[0].type)&&k(b.parentNode)||b))){if(f.splice(e,1),a=d.length&&n(f),!a)return _.apply(c,d),c;break}}return B(a,j)(d,b,!I,c,tb.test(a)&&k(b.parentNode)||b),c}var w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+-new Date,O=a.document,P=0,Q=0,R=c(),S=c(),T=c(),U=function(a,b){return a===b&&(E=!0),0},V="undefined",W=1<<31,X={}.hasOwnProperty,Y=[],Z=Y.pop,$=Y.push,_=Y.push,ab=Y.slice,bb=Y.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},cb="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",db="[\\x20\\t\\r\\n\\f]",eb="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",fb=eb.replace("w","w#"),gb="\\["+db+"*("+eb+")"+db+"*(?:([*^$|!~]?=)"+db+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+fb+")|)|)"+db+"*\\]",hb=":("+eb+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+gb.replace(3,8)+")*)|.*)\\)|)",ib=new RegExp("^"+db+"+|((?:^|[^\\\\])(?:\\\\.)*)"+db+"+$","g"),jb=new RegExp("^"+db+"*,"+db+"*"),kb=new RegExp("^"+db+"*([>+~]|"+db+")"+db+"*"),lb=new RegExp("="+db+"*([^\\]'\"]*?)"+db+"*\\]","g"),mb=new RegExp(hb),nb=new RegExp("^"+fb+"$"),ob={ID:new RegExp("^#("+eb+")"),CLASS:new RegExp("^\\.("+eb+")"),TAG:new RegExp("^("+eb.replace("w","w*")+")"),ATTR:new RegExp("^"+gb),PSEUDO:new RegExp("^"+hb),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+db+"*(even|odd|(([+-]|)(\\d*)n|)"+db+"*(?:([+-]|)"+db+"*(\\d+)|))"+db+"*\\)|)","i"),bool:new RegExp("^(?:"+cb+")$","i"),needsContext:new RegExp("^"+db+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+db+"*((?:-\\d)?\\d*)"+db+"*\\)|)(?=[^-]|$)","i")},pb=/^(?:input|select|textarea|button)$/i,qb=/^h\d$/i,rb=/^[^{]+\{\s*\[native \w/,sb=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tb=/[+~]/,ub=/'|\\/g,vb=new RegExp("\\\\([\\da-f]{1,6}"+db+"?|("+db+")|.)","ig"),wb=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{_.apply(Y=ab.call(O.childNodes),O.childNodes),Y[O.childNodes.length].nodeType}catch(xb){_={apply:Y.length?function(a,b){$.apply(a,ab.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}x=b.support={},A=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},F=b.setDocument=function(a){var b,c=a?a.ownerDocument||a:O,d=c.defaultView;return c!==G&&9===c.nodeType&&c.documentElement?(G=c,H=c.documentElement,I=!A(c),d&&d!==d.top&&(d.addEventListener?d.addEventListener("unload",function(){F()},!1):d.attachEvent&&d.attachEvent("onunload",function(){F()})),x.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),x.getElementsByTagName=e(function(a){return a.appendChild(c.createComment("")),!a.getElementsByTagName("*").length}),x.getElementsByClassName=rb.test(c.getElementsByClassName)&&e(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),x.getById=e(function(a){return H.appendChild(a).id=N,!c.getElementsByName||!c.getElementsByName(N).length
}),x.getById?(y.find.ID=function(a,b){if(typeof b.getElementById!==V&&I){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},y.filter.ID=function(a){var b=a.replace(vb,wb);return function(a){return a.getAttribute("id")===b}}):(delete y.find.ID,y.filter.ID=function(a){var b=a.replace(vb,wb);return function(a){var c=typeof a.getAttributeNode!==V&&a.getAttributeNode("id");return c&&c.value===b}}),y.find.TAG=x.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==V?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},y.find.CLASS=x.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==V&&I?b.getElementsByClassName(a):void 0},K=[],J=[],(x.qsa=rb.test(c.querySelectorAll))&&(e(function(a){a.innerHTML="<select t=''><option selected=''></option></select>",a.querySelectorAll("[t^='']").length&&J.push("[*^$]="+db+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||J.push("\\["+db+"*(?:value|"+cb+")"),a.querySelectorAll(":checked").length||J.push(":checked")}),e(function(a){var b=c.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&J.push("name"+db+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||J.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),J.push(",.*:")})),(x.matchesSelector=rb.test(L=H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&e(function(a){x.disconnectedMatch=L.call(a,"div"),L.call(a,"[s!='']:x"),K.push("!=",hb)}),J=J.length&&new RegExp(J.join("|")),K=K.length&&new RegExp(K.join("|")),b=rb.test(H.compareDocumentPosition),M=b||rb.test(H.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},U=b?function(a,b){if(a===b)return E=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!x.sortDetached&&b.compareDocumentPosition(a)===d?a===c||a.ownerDocument===O&&M(O,a)?-1:b===c||b.ownerDocument===O&&M(O,b)?1:D?bb.call(D,a)-bb.call(D,b):0:4&d?-1:1)}:function(a,b){if(a===b)return E=!0,0;var d,e=0,f=a.parentNode,h=b.parentNode,i=[a],j=[b];if(!f||!h)return a===c?-1:b===c?1:f?-1:h?1:D?bb.call(D,a)-bb.call(D,b):0;if(f===h)return g(a,b);for(d=a;d=d.parentNode;)i.unshift(d);for(d=b;d=d.parentNode;)j.unshift(d);for(;i[e]===j[e];)e++;return e?g(i[e],j[e]):i[e]===O?-1:j[e]===O?1:0},c):G},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==G&&F(a),c=c.replace(lb,"='$1']"),!(!x.matchesSelector||!I||K&&K.test(c)||J&&J.test(c)))try{var d=L.call(a,c);if(d||x.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return b(c,G,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==G&&F(a),M(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==G&&F(a);var c=y.attrHandle[b.toLowerCase()],d=c&&X.call(y.attrHandle,b.toLowerCase())?c(a,b,!I):void 0;return void 0!==d?d:x.attributes||!I?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(E=!x.detectDuplicates,D=!x.sortStable&&a.slice(0),a.sort(U),E){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return D=null,a},z=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=z(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=z(b);return c},y=b.selectors={cacheLength:50,createPseudo:d,match:ob,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(vb,wb),a[3]=(a[4]||a[5]||"").replace(vb,wb),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return ob.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&mb.test(c)&&(b=m(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(vb,wb).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=R[a+" "];return b||(b=new RegExp("(^|"+db+")"+a+"("+db+"|$)"))&&R(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==V&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:c?(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f+" ").indexOf(d)>-1:"|="===c?f===d||f.slice(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[N]||(q[N]={}),j=k[a]||[],n=j[0]===P&&j[1],m=j[0]===P&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[P,n,m];break}}else if(s&&(j=(b[N]||(b[N]={}))[a])&&j[0]===P)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[N]||(l[N]={}))[a]=[P,m]),l!==b)););return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,c){var e,f=y.pseudos[a]||y.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[N]?f(c):f.length>1?(e=[a,a,"",c],y.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=bb.call(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=B(a.replace(ib,"$1"));return e[N]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return function(b){return(b.textContent||b.innerText||z(b)).indexOf(a)>-1}}),lang:d(function(a){return nb.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(vb,wb).toLowerCase(),function(b){var c;do if(c=I?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===H},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!y.pseudos.empty(a)},header:function(a){return qb.test(a.nodeName)},input:function(a){return pb.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:j(function(){return[0]}),last:j(function(a,b){return[b-1]}),eq:j(function(a,b,c){return[0>c?c+b:c]}),even:j(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:j(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:j(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:j(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},y.pseudos.nth=y.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})y.pseudos[w]=h(w);for(w in{submit:!0,reset:!0})y.pseudos[w]=i(w);return l.prototype=y.filters=y.pseudos,y.setFilters=new l,B=b.compile=function(a,b){var c,d=[],e=[],f=T[a+" "];if(!f){for(b||(b=m(a)),c=b.length;c--;)f=s(b[c]),f[N]?d.push(f):e.push(f);f=T(a,t(e,d))}return f},x.sortStable=N.split("").sort(U).join("")===N,x.detectDuplicates=!!E,F(),x.sortDetached=e(function(a){return 1&a.compareDocumentPosition(G.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),x.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(cb,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(a);fb.find=kb,fb.expr=kb.selectors,fb.expr[":"]=fb.expr.pseudos,fb.unique=kb.uniqueSort,fb.text=kb.getText,fb.isXMLDoc=kb.isXML,fb.contains=kb.contains;var lb=fb.expr.match.needsContext,mb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,nb=/^.[^:#\[\.,]*$/;fb.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?fb.find.matchesSelector(d,a)?[d]:[]:fb.find.matches(a,fb.grep(b,function(a){return 1===a.nodeType}))},fb.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(fb(a).filter(function(){for(b=0;e>b;b++)if(fb.contains(d[b],this))return!0}));for(b=0;e>b;b++)fb.find(a,d[b],c);return c=this.pushStack(e>1?fb.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(d(this,a||[],!1))},not:function(a){return this.pushStack(d(this,a||[],!0))},is:function(a){return!!d(this,"string"==typeof a&&lb.test(a)?fb(a):a||[],!1).length}});var ob,pb=a.document,qb=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,rb=fb.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:qb.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||ob).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof fb?b[0]:b,fb.merge(this,fb.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:pb,!0)),mb.test(c[1])&&fb.isPlainObject(b))for(c in b)fb.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=pb.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return ob.find(a);this.length=1,this[0]=d}return this.context=pb,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):fb.isFunction(a)?"undefined"!=typeof ob.ready?ob.ready(a):a(fb):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),fb.makeArray(a,this))};rb.prototype=fb.fn,ob=fb(pb);var sb=/^(?:parents|prev(?:Until|All))/,tb={children:!0,contents:!0,next:!0,prev:!0};fb.extend({dir:function(a,b,c){for(var d=[],e=a[b];e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!fb(e).is(c));)1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),fb.fn.extend({has:function(a){var b,c=fb(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(fb.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=lb.test(a)||"string"!=typeof a?fb(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&fb.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?fb.unique(f):f)},index:function(a){return a?"string"==typeof a?fb.inArray(this[0],fb(a)):fb.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(fb.unique(fb.merge(this.get(),fb(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),fb.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return fb.dir(a,"parentNode")},parentsUntil:function(a,b,c){return fb.dir(a,"parentNode",c)},next:function(a){return e(a,"nextSibling")},prev:function(a){return e(a,"previousSibling")},nextAll:function(a){return fb.dir(a,"nextSibling")},prevAll:function(a){return fb.dir(a,"previousSibling")},nextUntil:function(a,b,c){return fb.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return fb.dir(a,"previousSibling",c)},siblings:function(a){return fb.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return fb.sibling(a.firstChild)},contents:function(a){return fb.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:fb.merge([],a.childNodes)}},function(a,b){fb.fn[a]=function(c,d){var e=fb.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=fb.filter(d,e)),this.length>1&&(tb[a]||(e=fb.unique(e)),sb.test(a)&&(e=e.reverse())),this.pushStack(e)}});var ub=/\S+/g,vb={};fb.Callbacks=function(a){a="string"==typeof a?vb[a]||f(a):fb.extend({},a);var b,c,d,e,g,h,i=[],j=!a.once&&[],k=function(f){for(c=a.memory&&f,d=!0,g=h||0,h=0,e=i.length,b=!0;i&&e>g;g++)if(i[g].apply(f[0],f[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,i&&(j?j.length&&k(j.shift()):c?i=[]:l.disable())},l={add:function(){if(i){var d=i.length;!function f(b){fb.each(b,function(b,c){var d=fb.type(c);"function"===d?a.unique&&l.has(c)||i.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),b?e=i.length:c&&(h=d,k(c))}return this},remove:function(){return i&&fb.each(arguments,function(a,c){for(var d;(d=fb.inArray(c,i,d))>-1;)i.splice(d,1),b&&(e>=d&&e--,g>=d&&g--)}),this},has:function(a){return a?fb.inArray(a,i)>-1:!(!i||!i.length)},empty:function(){return i=[],e=0,this},disable:function(){return i=j=c=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,c||l.disable(),this},locked:function(){return!j},fireWith:function(a,c){return!i||d&&!j||(c=c||[],c=[a,c.slice?c.slice():c],b?j.push(c):k(c)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!d}};return l},fb.extend({Deferred:function(a){var b=[["resolve","done",fb.Callbacks("once memory"),"resolved"],["reject","fail",fb.Callbacks("once memory"),"rejected"],["notify","progress",fb.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return fb.Deferred(function(c){fb.each(b,function(b,f){var g=fb.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&fb.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?fb.extend(a,d):d}},e={};return d.pipe=d.then,fb.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=X.call(arguments),g=f.length,h=1!==g||a&&fb.isFunction(a.promise)?g:0,i=1===h?a:fb.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?X.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);g>e;e++)f[e]&&fb.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var wb;fb.fn.ready=function(a){return fb.ready.promise().done(a),this},fb.extend({isReady:!1,readyWait:1,holdReady:function(a){a?fb.readyWait++:fb.ready(!0)},ready:function(a){if(a===!0?!--fb.readyWait:!fb.isReady){if(!pb.body)return setTimeout(fb.ready);fb.isReady=!0,a!==!0&&--fb.readyWait>0||(wb.resolveWith(pb,[fb]),fb.fn.trigger&&fb(pb).trigger("ready").off("ready"))}}}),fb.ready.promise=function(b){if(!wb)if(wb=fb.Deferred(),"complete"===pb.readyState)setTimeout(fb.ready);else if(pb.addEventListener)pb.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1);else{pb.attachEvent("onreadystatechange",h),a.attachEvent("onload",h);var c=!1;try{c=null==a.frameElement&&pb.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!fb.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}g(),fb.ready()}}()}return wb.promise(b)};var xb,yb="undefined";for(xb in fb(db))break;db.ownLast="0"!==xb,db.inlineBlockNeedsLayout=!1,fb(function(){var a,b,c=pb.getElementsByTagName("body")[0];c&&(a=pb.createElement("div"),a.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",b=pb.createElement("div"),c.appendChild(a).appendChild(b),typeof b.style.zoom!==yb&&(b.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(db.inlineBlockNeedsLayout=3===b.offsetWidth)&&(c.style.zoom=1)),c.removeChild(a),a=b=null)}),function(){var a=pb.createElement("div");if(null==db.deleteExpando){db.deleteExpando=!0;try{delete a.test}catch(b){db.deleteExpando=!1}}a=null}(),fb.acceptData=function(a){var b=fb.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute("classid")===b};var zb=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ab=/([A-Z])/g;fb.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?fb.cache[a[fb.expando]]:a[fb.expando],!!a&&!j(a)},data:function(a,b,c){return k(a,b,c)},removeData:function(a,b){return l(a,b)},_data:function(a,b,c){return k(a,b,c,!0)},_removeData:function(a,b){return l(a,b,!0)}}),fb.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=fb.data(f),1===f.nodeType&&!fb._data(f,"parsedAttrs"))){for(c=g.length;c--;)d=g[c].name,0===d.indexOf("data-")&&(d=fb.camelCase(d.slice(5)),i(f,d,e[d]));fb._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){fb.data(this,a)}):arguments.length>1?this.each(function(){fb.data(this,a,b)}):f?i(f,a,fb.data(f,a)):void 0},removeData:function(a){return this.each(function(){fb.removeData(this,a)})}}),fb.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=fb._data(a,b),c&&(!d||fb.isArray(c)?d=fb._data(a,b,fb.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=fb.queue(a,b),d=c.length,e=c.shift(),f=fb._queueHooks(a,b),g=function(){fb.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return fb._data(a,c)||fb._data(a,c,{empty:fb.Callbacks("once memory").add(function(){fb._removeData(a,b+"queue"),fb._removeData(a,c)})})}}),fb.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?fb.queue(this[0],a):void 0===b?this:this.each(function(){var c=fb.queue(this,a,b);fb._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&fb.dequeue(this,a)})},dequeue:function(a){return this.each(function(){fb.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=fb.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)c=fb._data(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Bb=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Cb=["Top","Right","Bottom","Left"],Db=function(a,b){return a=b||a,"none"===fb.css(a,"display")||!fb.contains(a.ownerDocument,a)},Eb=fb.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===fb.type(c)){e=!0;for(h in c)fb.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,fb.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(fb(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},Fb=/^(?:checkbox|radio)$/i;!function(){var a=pb.createDocumentFragment(),b=pb.createElement("div"),c=pb.createElement("input");if(b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a>",db.leadingWhitespace=3===b.firstChild.nodeType,db.tbody=!b.getElementsByTagName("tbody").length,db.htmlSerialize=!!b.getElementsByTagName("link").length,db.html5Clone="<:nav></:nav>"!==pb.createElement("nav").cloneNode(!0).outerHTML,c.type="checkbox",c.checked=!0,a.appendChild(c),db.appendChecked=c.checked,b.innerHTML="<textarea>x</textarea>",db.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,a.appendChild(b),b.innerHTML="<input type='radio' checked='checked' name='t'/>",db.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,db.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){db.noCloneEvent=!1}),b.cloneNode(!0).click()),null==db.deleteExpando){db.deleteExpando=!0;try{delete b.test}catch(d){db.deleteExpando=!1}}a=b=c=null}(),function(){var b,c,d=pb.createElement("div");for(b in{submit:!0,change:!0,focusin:!0})c="on"+b,(db[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),db[b+"Bubbles"]=d.attributes[c].expando===!1);d=null}();var Gb=/^(?:input|select|textarea)$/i,Hb=/^key/,Ib=/^(?:mouse|contextmenu)|click/,Jb=/^(?:focusinfocus|focusoutblur)$/,Kb=/^([^.]*)(?:\.(.+)|)$/;fb.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=fb._data(a);if(q){for(c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=fb.guid++),(g=q.events)||(g=q.events={}),(k=q.handle)||(k=q.handle=function(a){return typeof fb===yb||a&&fb.event.triggered===a.type?void 0:fb.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(ub)||[""],h=b.length;h--;)f=Kb.exec(b[h])||[],n=p=f[1],o=(f[2]||"").split(".").sort(),n&&(j=fb.event.special[n]||{},n=(e?j.delegateType:j.bindType)||n,j=fb.event.special[n]||{},l=fb.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&fb.expr.match.needsContext.test(e),namespace:o.join(".")},i),(m=g[n])||(m=g[n]=[],m.delegateCount=0,j.setup&&j.setup.call(a,d,o,k)!==!1||(a.addEventListener?a.addEventListener(n,k,!1):a.attachEvent&&a.attachEvent("on"+n,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,l):m.push(l),fb.event.global[n]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=fb.hasData(a)&&fb._data(a);if(q&&(k=q.events)){for(b=(b||"").match(ub)||[""],j=b.length;j--;)if(h=Kb.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=fb.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=k[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;f--;)g=m[f],!e&&p!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||fb.removeEvent(a,n,q.handle),delete k[n])}else for(n in k)fb.event.remove(a,n+b[j],c,d,!0);fb.isEmptyObject(k)&&(delete q.handle,fb._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,j,k,l,m=[d||pb],n=bb.call(b,"type")?b.type:b,o=bb.call(b,"namespace")?b.namespace.split("."):[];if(h=k=d=d||pb,3!==d.nodeType&&8!==d.nodeType&&!Jb.test(n+fb.event.triggered)&&(n.indexOf(".")>=0&&(o=n.split("."),n=o.shift(),o.sort()),g=n.indexOf(":")<0&&"on"+n,b=b[fb.expando]?b:new fb.Event(n,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=o.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:fb.makeArray(c,[b]),j=fb.event.special[n]||{},e||!j.trigger||j.trigger.apply(d,c)!==!1)){if(!e&&!j.noBubble&&!fb.isWindow(d)){for(i=j.delegateType||n,Jb.test(i+n)||(h=h.parentNode);h;h=h.parentNode)m.push(h),k=h;k===(d.ownerDocument||pb)&&m.push(k.defaultView||k.parentWindow||a)}for(l=0;(h=m[l++])&&!b.isPropagationStopped();)b.type=l>1?i:j.bindType||n,f=(fb._data(h,"events")||{})[b.type]&&fb._data(h,"handle"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&fb.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=n,!e&&!b.isDefaultPrevented()&&(!j._default||j._default.apply(m.pop(),c)===!1)&&fb.acceptData(d)&&g&&d[n]&&!fb.isWindow(d)){k=d[g],k&&(d[g]=null),fb.event.triggered=n;try{d[n]()}catch(p){}fb.event.triggered=void 0,k&&(d[g]=k)}return b.result}},dispatch:function(a){a=fb.event.fix(a);var b,c,d,e,f,g=[],h=X.call(arguments),i=(fb._data(this,"events")||{})[a.type]||[],j=fb.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||j.preDispatch.call(this,a)!==!1){for(g=fb.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,f=0;(d=e.handlers[f++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(d.namespace))&&(a.handleObj=d,a.data=d.data,c=((fb.event.special[d.origType]||{}).handle||d.handler).apply(e.elem,h),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+" ",void 0===e[c]&&(e[c]=d.needsContext?fb(c,this).index(i)>=0:fb.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[fb.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Ib.test(e)?this.mouseHooks:Hb.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new fb.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||pb),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||pb,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==o()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===o()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return fb.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return fb.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=fb.extend(new fb.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?fb.event.trigger(e,null,b):fb.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},fb.removeEvent=pb.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===yb&&(a[d]=null),a.detachEvent(d,c))},fb.Event=function(a,b){return this instanceof fb.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&(a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault())?m:n):this.type=a,b&&fb.extend(this,b),this.timeStamp=a&&a.timeStamp||fb.now(),void(this[fb.expando]=!0)):new fb.Event(a,b)},fb.Event.prototype={isDefaultPrevented:n,isPropagationStopped:n,isImmediatePropagationStopped:n,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=m,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=m,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=m,this.stopPropagation()}},fb.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){fb.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!fb.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),db.submitBubbles||(fb.event.special.submit={setup:function(){return fb.nodeName(this,"form")?!1:void fb.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=fb.nodeName(b,"input")||fb.nodeName(b,"button")?b.form:void 0;c&&!fb._data(c,"submitBubbles")&&(fb.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),fb._data(c,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&fb.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return fb.nodeName(this,"form")?!1:void fb.event.remove(this,"._submit")}}),db.changeBubbles||(fb.event.special.change={setup:function(){return Gb.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(fb.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),fb.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),fb.event.simulate("change",this,a,!0)})),!1):void fb.event.add(this,"beforeactivate._change",function(a){var b=a.target;Gb.test(b.nodeName)&&!fb._data(b,"changeBubbles")&&(fb.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||fb.event.simulate("change",this.parentNode,a,!0)}),fb._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return fb.event.remove(this,"._change"),!Gb.test(this.nodeName)}}),db.focusinBubbles||fb.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){fb.event.simulate(b,a.target,fb.event.fix(a),!0)};fb.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=fb._data(d,b);e||d.addEventListener(a,c,!0),fb._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=fb._data(d,b)-1;e?fb._data(d,b,e):(d.removeEventListener(a,c,!0),fb._removeData(d,b))}}}),fb.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=n;
else if(!d)return this;return 1===e&&(g=d,d=function(a){return fb().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=fb.guid++)),this.each(function(){fb.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,fb(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=n),this.each(function(){fb.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){fb.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?fb.event.trigger(a,b,c,!0):void 0}});var Lb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Mb=/ jQuery\d+="(?:null|\d+)"/g,Nb=new RegExp("<(?:"+Lb+")[\\s/>]","i"),Ob=/^\s+/,Pb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Qb=/<([\w:]+)/,Rb=/<tbody/i,Sb=/<|&#?\w+;/,Tb=/<(?:script|style|link)/i,Ub=/checked\s*(?:[^=]|=\s*.checked.)/i,Vb=/^$|\/(?:java|ecma)script/i,Wb=/^true\/(.*)/,Xb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Yb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:db.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Zb=p(pb),$b=Zb.appendChild(pb.createElement("div"));Yb.optgroup=Yb.option,Yb.tbody=Yb.tfoot=Yb.colgroup=Yb.caption=Yb.thead,Yb.th=Yb.td,fb.extend({clone:function(a,b,c){var d,e,f,g,h,i=fb.contains(a.ownerDocument,a);if(db.html5Clone||fb.isXMLDoc(a)||!Nb.test("<"+a.nodeName+">")?f=a.cloneNode(!0):($b.innerHTML=a.outerHTML,$b.removeChild(f=$b.firstChild)),!(db.noCloneEvent&&db.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||fb.isXMLDoc(a)))for(d=q(f),h=q(a),g=0;null!=(e=h[g]);++g)d[g]&&x(e,d[g]);if(b)if(c)for(h=h||q(a),d=d||q(f),g=0;null!=(e=h[g]);g++)w(e,d[g]);else w(a,f);return d=q(f,"script"),d.length>0&&v(d,!i&&q(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k,l=a.length,m=p(b),n=[],o=0;l>o;o++)if(f=a[o],f||0===f)if("object"===fb.type(f))fb.merge(n,f.nodeType?[f]:f);else if(Sb.test(f)){for(h=h||m.appendChild(b.createElement("div")),i=(Qb.exec(f)||["",""])[1].toLowerCase(),k=Yb[i]||Yb._default,h.innerHTML=k[1]+f.replace(Pb,"<$1></$2>")+k[2],e=k[0];e--;)h=h.lastChild;if(!db.leadingWhitespace&&Ob.test(f)&&n.push(b.createTextNode(Ob.exec(f)[0])),!db.tbody)for(f="table"!==i||Rb.test(f)?"<table>"!==k[1]||Rb.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;e--;)fb.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j);for(fb.merge(n,h.childNodes),h.textContent="";h.firstChild;)h.removeChild(h.firstChild);h=m.lastChild}else n.push(b.createTextNode(f));for(h&&m.removeChild(h),db.appendChecked||fb.grep(q(n,"input"),r),o=0;f=n[o++];)if((!d||-1===fb.inArray(f,d))&&(g=fb.contains(f.ownerDocument,f),h=q(m.appendChild(f),"script"),g&&v(h),c))for(e=0;f=h[e++];)Vb.test(f.type||"")&&c.push(f);return h=null,m},cleanData:function(a,b){for(var c,d,e,f,g=0,h=fb.expando,i=fb.cache,j=db.deleteExpando,k=fb.event.special;null!=(c=a[g]);g++)if((b||fb.acceptData(c))&&(e=c[h],f=e&&i[e])){if(f.events)for(d in f.events)k[d]?fb.event.remove(c,d):fb.removeEvent(c,d,f.handle);i[e]&&(delete i[e],j?delete c[h]:typeof c.removeAttribute!==yb?c.removeAttribute(h):c[h]=null,W.push(e))}}}),fb.fn.extend({text:function(a){return Eb(this,function(a){return void 0===a?fb.text(this):this.empty().append((this[0]&&this[0].ownerDocument||pb).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=s(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=s(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?fb.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||fb.cleanData(q(c)),c.parentNode&&(b&&fb.contains(c.ownerDocument,c)&&v(q(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&fb.cleanData(q(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&fb.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return fb.clone(this,a,b)})},html:function(a){return Eb(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(Mb,""):void 0;if(!("string"!=typeof a||Tb.test(a)||!db.htmlSerialize&&Nb.test(a)||!db.leadingWhitespace&&Ob.test(a)||Yb[(Qb.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(Pb,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(fb.cleanData(q(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,fb.cleanData(q(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=Y.apply([],a);var c,d,e,f,g,h,i=0,j=this.length,k=this,l=j-1,m=a[0],n=fb.isFunction(m);if(n||j>1&&"string"==typeof m&&!db.checkClone&&Ub.test(m))return this.each(function(c){var d=k.eq(c);n&&(a[0]=m.call(this,c,d.html())),d.domManip(a,b)});if(j&&(h=fb.buildFragment(a,this[0].ownerDocument,!1,this),c=h.firstChild,1===h.childNodes.length&&(h=c),c)){for(f=fb.map(q(h,"script"),t),e=f.length;j>i;i++)d=h,i!==l&&(d=fb.clone(d,!0,!0),e&&fb.merge(f,q(d,"script"))),b.call(this[i],d,i);if(e)for(g=f[f.length-1].ownerDocument,fb.map(f,u),i=0;e>i;i++)d=f[i],Vb.test(d.type||"")&&!fb._data(d,"globalEval")&&fb.contains(g,d)&&(d.src?fb._evalUrl&&fb._evalUrl(d.src):fb.globalEval((d.text||d.textContent||d.innerHTML||"").replace(Xb,"")));h=c=null}return this}}),fb.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){fb.fn[a]=function(a){for(var c,d=0,e=[],f=fb(a),g=f.length-1;g>=d;d++)c=d===g?this:this.clone(!0),fb(f[d])[b](c),Z.apply(e,c.get());return this.pushStack(e)}});var _b,ac={};!function(){var a,b,c=pb.createElement("div"),d="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";c.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=c.getElementsByTagName("a")[0],a.style.cssText="float:left;opacity:.5",db.opacity=/^0.5/.test(a.style.opacity),db.cssFloat=!!a.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",db.clearCloneStyle="content-box"===c.style.backgroundClip,a=c=null,db.shrinkWrapBlocks=function(){var a,c,e,f;if(null==b){if(a=pb.getElementsByTagName("body")[0],!a)return;f="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",c=pb.createElement("div"),e=pb.createElement("div"),a.appendChild(c).appendChild(e),b=!1,typeof e.style.zoom!==yb&&(e.style.cssText=d+";width:1px;padding:1px;zoom:1",e.innerHTML="<div></div>",e.firstChild.style.width="5px",b=3!==e.offsetWidth),a.removeChild(c),a=c=e=null}return b}}();var bc,cc,dc=/^margin/,ec=new RegExp("^("+Bb+")(?!px)[a-z%]+$","i"),fc=/^(top|right|bottom|left)$/;a.getComputedStyle?(bc=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)},cc=function(a,b,c){var d,e,f,g,h=a.style;return c=c||bc(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(""!==g||fb.contains(a.ownerDocument,a)||(g=fb.style(a,b)),ec.test(g)&&dc.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""}):pb.documentElement.currentStyle&&(bc=function(a){return a.currentStyle},cc=function(a,b,c){var d,e,f,g,h=a.style;return c=c||bc(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),ec.test(g)&&!fc.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"}),!function(){function b(){var b,c,d=pb.getElementsByTagName("body")[0];d&&(b=pb.createElement("div"),c=pb.createElement("div"),b.style.cssText=j,d.appendChild(b).appendChild(c),c.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",fb.swap(d,null!=d.style.zoom?{zoom:1}:{},function(){e=4===c.offsetWidth}),f=!0,g=!1,h=!0,a.getComputedStyle&&(g="1%"!==(a.getComputedStyle(c,null)||{}).top,f="4px"===(a.getComputedStyle(c,null)||{width:"4px"}).width),d.removeChild(b),c=d=null)}var c,d,e,f,g,h,i=pb.createElement("div"),j="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",k="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",c=i.getElementsByTagName("a")[0],c.style.cssText="float:left;opacity:.5",db.opacity=/^0.5/.test(c.style.opacity),db.cssFloat=!!c.style.cssFloat,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",db.clearCloneStyle="content-box"===i.style.backgroundClip,c=i=null,fb.extend(db,{reliableHiddenOffsets:function(){if(null!=d)return d;var a,b,c,e=pb.createElement("div"),f=pb.getElementsByTagName("body")[0];return f?(e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=pb.createElement("div"),a.style.cssText=j,f.appendChild(a).appendChild(e),e.innerHTML="<table><tr><td></td><td>t</td></tr></table>",b=e.getElementsByTagName("td"),b[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===b[0].offsetHeight,b[0].style.display="",b[1].style.display="none",d=c&&0===b[0].offsetHeight,f.removeChild(a),e=f=null,d):void 0},boxSizing:function(){return null==e&&b(),e},boxSizingReliable:function(){return null==f&&b(),f},pixelPosition:function(){return null==g&&b(),g},reliableMarginRight:function(){var b,c,d,e;if(null==h&&a.getComputedStyle){if(b=pb.getElementsByTagName("body")[0],!b)return;c=pb.createElement("div"),d=pb.createElement("div"),c.style.cssText=j,b.appendChild(c).appendChild(d),e=d.appendChild(pb.createElement("div")),e.style.cssText=d.style.cssText=k,e.style.marginRight=e.style.width="0",d.style.width="1px",h=!parseFloat((a.getComputedStyle(e,null)||{}).marginRight),b.removeChild(c)}return h}})}(),fb.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var gc=/alpha\([^)]*\)/i,hc=/opacity\s*=\s*([^)]*)/,ic=/^(none|table(?!-c[ea]).+)/,jc=new RegExp("^("+Bb+")(.*)$","i"),kc=new RegExp("^([+-])=("+Bb+")","i"),lc={position:"absolute",visibility:"hidden",display:"block"},mc={letterSpacing:0,fontWeight:400},nc=["Webkit","O","Moz","ms"];fb.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=cc(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":db.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=fb.camelCase(b),i=a.style;if(b=fb.cssProps[h]||(fb.cssProps[h]=B(i,h)),g=fb.cssHooks[b]||fb.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,"string"===f&&(e=kc.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(fb.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||fb.cssNumber[h]||(c+="px"),db.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]="",i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=fb.camelCase(b);return b=fb.cssProps[h]||(fb.cssProps[h]=B(a.style,h)),g=fb.cssHooks[b]||fb.cssHooks[h],g&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=cc(a,b,d)),"normal"===f&&b in mc&&(f=mc[b]),""===c||c?(e=parseFloat(f),c===!0||fb.isNumeric(e)?e||0:f):f}}),fb.each(["height","width"],function(a,b){fb.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&ic.test(fb.css(a,"display"))?fb.swap(a,lc,function(){return F(a,b,d)}):F(a,b,d):void 0},set:function(a,c,d){var e=d&&bc(a);return D(a,c,d?E(a,b,d,db.boxSizing()&&"border-box"===fb.css(a,"boxSizing",!1,e),e):0)}}}),db.opacity||(fb.cssHooks.opacity={get:function(a,b){return hc.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=fb.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===fb.trim(f.replace(gc,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=gc.test(f)?f.replace(gc,e):f+" "+e)}}),fb.cssHooks.marginRight=A(db.reliableMarginRight,function(a,b){return b?fb.swap(a,{display:"inline-block"},cc,[a,"marginRight"]):void 0}),fb.each({margin:"",padding:"",border:"Width"},function(a,b){fb.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+Cb[d]+b]=f[d]||f[d-2]||f[0];return e}},dc.test(a)||(fb.cssHooks[a+b].set=D)}),fb.fn.extend({css:function(a,b){return Eb(this,function(a,b,c){var d,e,f={},g=0;if(fb.isArray(b)){for(d=bc(a),e=b.length;e>g;g++)f[b[g]]=fb.css(a,b[g],!1,d);return f}return void 0!==c?fb.style(a,b,c):fb.css(a,b)},a,b,arguments.length>1)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){Db(this)?fb(this).show():fb(this).hide()})}}),fb.Tween=G,G.prototype={constructor:G,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(fb.cssNumber[c]?"":"px")},cur:function(){var a=G.propHooks[this.prop];return a&&a.get?a.get(this):G.propHooks._default.get(this)},run:function(a){var b,c=G.propHooks[this.prop];return this.pos=b=this.options.duration?fb.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):G.propHooks._default.set(this),this}},G.prototype.init.prototype=G.prototype,G.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=fb.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){fb.fx.step[a.prop]?fb.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[fb.cssProps[a.prop]]||fb.cssHooks[a.prop])?fb.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},G.propHooks.scrollTop=G.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},fb.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},fb.fx=G.prototype.init,fb.fx.step={};var oc,pc,qc=/^(?:toggle|show|hide)$/,rc=new RegExp("^(?:([+-])=|)("+Bb+")([a-z%]*)$","i"),sc=/queueHooks$/,tc=[K],uc={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=rc.exec(b),f=e&&e[3]||(fb.cssNumber[a]?"":"px"),g=(fb.cssNumber[a]||"px"!==f&&+d)&&rc.exec(fb.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,fb.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};fb.Animation=fb.extend(M,{tweener:function(a,b){fb.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],uc[c]=uc[c]||[],uc[c].unshift(b)},prefilter:function(a,b){b?tc.unshift(a):tc.push(a)}}),fb.speed=function(a,b,c){var d=a&&"object"==typeof a?fb.extend({},a):{complete:c||!c&&b||fb.isFunction(a)&&a,duration:a,easing:c&&b||b&&!fb.isFunction(b)&&b};return d.duration=fb.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in fb.fx.speeds?fb.fx.speeds[d.duration]:fb.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){fb.isFunction(d.old)&&d.old.call(this),d.queue&&fb.dequeue(this,d.queue)},d},fb.fn.extend({fadeTo:function(a,b,c,d){return this.filter(Db).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=fb.isEmptyObject(a),f=fb.speed(b,c,d),g=function(){var b=M(this,fb.extend({},a),f);(e||fb._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=fb.timers,g=fb._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&sc.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&fb.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=fb._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=fb.timers,g=d?d.length:0;for(c.finish=!0,fb.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),fb.each(["toggle","show","hide"],function(a,b){var c=fb.fn[b];fb.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(I(b,!0),a,d,e)}}),fb.each({slideDown:I("show"),slideUp:I("hide"),slideToggle:I("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){fb.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),fb.timers=[],fb.fx.tick=function(){var a,b=fb.timers,c=0;for(oc=fb.now();c<b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||fb.fx.stop(),oc=void 0},fb.fx.timer=function(a){fb.timers.push(a),a()?fb.fx.start():fb.timers.pop()},fb.fx.interval=13,fb.fx.start=function(){pc||(pc=setInterval(fb.fx.tick,fb.fx.interval))},fb.fx.stop=function(){clearInterval(pc),pc=null},fb.fx.speeds={slow:600,fast:200,_default:400},fb.fn.delay=function(a,b){return a=fb.fx?fb.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e=pb.createElement("div");e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=e.getElementsByTagName("a")[0],c=pb.createElement("select"),d=c.appendChild(pb.createElement("option")),b=e.getElementsByTagName("input")[0],a.style.cssText="top:1px",db.getSetAttribute="t"!==e.className,db.style=/top/.test(a.getAttribute("style")),db.hrefNormalized="/a"===a.getAttribute("href"),db.checkOn=!!b.value,db.optSelected=d.selected,db.enctype=!!pb.createElement("form").enctype,c.disabled=!0,db.optDisabled=!d.disabled,b=pb.createElement("input"),b.setAttribute("value",""),db.input=""===b.getAttribute("value"),b.value="t",b.setAttribute("type","radio"),db.radioValue="t"===b.value,a=b=c=d=e=null}();var vc=/\r/g;fb.fn.extend({val:function(a){var b,c,d,e=this[0];return arguments.length?(d=fb.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,fb(this).val()):a,null==e?e="":"number"==typeof e?e+="":fb.isArray(e)&&(e=fb.map(e,function(a){return null==a?"":a+""})),b=fb.valHooks[this.type]||fb.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))})):e?(b=fb.valHooks[e.type]||fb.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(vc,""):null==c?"":c)):void 0}}),fb.extend({valHooks:{option:{get:function(a){var b=fb.find.attr(a,"value");return null!=b?b:fb.text(a)}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(db.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&fb.nodeName(c.parentNode,"optgroup"))){if(b=fb(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=fb.makeArray(b),g=e.length;g--;)if(d=e[g],fb.inArray(fb.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),fb.each(["radio","checkbox"],function(){fb.valHooks[this]={set:function(a,b){return fb.isArray(b)?a.checked=fb.inArray(fb(a).val(),b)>=0:void 0}},db.checkOn||(fb.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var wc,xc,yc=fb.expr.attrHandle,zc=/^(?:checked|selected)$/i,Ac=db.getSetAttribute,Bc=db.input;fb.fn.extend({attr:function(a,b){return Eb(this,fb.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){fb.removeAttr(this,a)})}}),fb.extend({attr:function(a,b,c){var d,e,f=a.nodeType;return a&&3!==f&&8!==f&&2!==f?typeof a.getAttribute===yb?fb.prop(a,b,c):(1===f&&fb.isXMLDoc(a)||(b=b.toLowerCase(),d=fb.attrHooks[b]||(fb.expr.match.bool.test(b)?xc:wc)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=fb.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void fb.removeAttr(a,b)):void 0},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(ub);if(f&&1===a.nodeType)for(;c=f[e++];)d=fb.propFix[c]||c,fb.expr.match.bool.test(c)?Bc&&Ac||!zc.test(c)?a[d]=!1:a[fb.camelCase("default-"+c)]=a[d]=!1:fb.attr(a,c,""),a.removeAttribute(Ac?c:d)},attrHooks:{type:{set:function(a,b){if(!db.radioValue&&"radio"===b&&fb.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),xc={set:function(a,b,c){return b===!1?fb.removeAttr(a,c):Bc&&Ac||!zc.test(c)?a.setAttribute(!Ac&&fb.propFix[c]||c,c):a[fb.camelCase("default-"+c)]=a[c]=!0,c}},fb.each(fb.expr.match.bool.source.match(/\w+/g),function(a,b){var c=yc[b]||fb.find.attr;yc[b]=Bc&&Ac||!zc.test(b)?function(a,b,d){var e,f;return d||(f=yc[b],yc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,yc[b]=f),e}:function(a,b,c){return c?void 0:a[fb.camelCase("default-"+b)]?b.toLowerCase():null}}),Bc&&Ac||(fb.attrHooks.value={set:function(a,b,c){return fb.nodeName(a,"input")?void(a.defaultValue=b):wc&&wc.set(a,b,c)}}),Ac||(wc={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0}},yc.id=yc.name=yc.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},fb.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:wc.set},fb.attrHooks.contenteditable={set:function(a,b,c){wc.set(a,""===b?!1:b,c)}},fb.each(["width","height"],function(a,b){fb.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),db.style||(fb.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var Cc=/^(?:input|select|textarea|button|object)$/i,Dc=/^(?:a|area)$/i;fb.fn.extend({prop:function(a,b){return Eb(this,fb.prop,a,b,arguments.length>1)},removeProp:function(a){return a=fb.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),fb.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;return a&&3!==g&&8!==g&&2!==g?(f=1!==g||!fb.isXMLDoc(a),f&&(b=fb.propFix[b]||b,e=fb.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]):void 0},propHooks:{tabIndex:{get:function(a){var b=fb.find.attr(a,"tabindex");return b?parseInt(b,10):Cc.test(a.nodeName)||Dc.test(a.nodeName)&&a.href?0:-1}}}}),db.hrefNormalized||fb.each(["href","src"],function(a,b){fb.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),db.optSelected||(fb.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),fb.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){fb.propFix[this.toLowerCase()]=this}),db.enctype||(fb.propFix.enctype="encoding");var Ec=/[\t\r\n\f]/g;fb.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;if(fb.isFunction(a))return this.each(function(b){fb(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(ub)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Ec," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=fb.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;if(fb.isFunction(a))return this.each(function(b){fb(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(ub)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Ec," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");g=a?fb.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(fb.isFunction(a)?function(c){fb(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c)for(var b,d=0,e=fb(this),f=a.match(ub)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===yb||"boolean"===c)&&(this.className&&fb._data(this,"__className__",this.className),this.className=this.className||a===!1?"":fb._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(Ec," ").indexOf(b)>=0)return!0;return!1}}),fb.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){fb.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),fb.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var Fc=fb.now(),Gc=/\?/,Hc=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;fb.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=fb.trim(b+"");return e&&!fb.trim(e.replace(Hc,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():fb.error("Invalid JSON: "+b)},fb.parseXML=function(b){var c,d;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||fb.error("Invalid XML: "+b),c};var Ic,Jc,Kc=/#.*$/,Lc=/([?&])_=[^&]*/,Mc=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Nc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Oc=/^(?:GET|HEAD)$/,Pc=/^\/\//,Qc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Rc={},Sc={},Tc="*/".concat("*");try{Jc=location.href}catch(Uc){Jc=pb.createElement("a"),Jc.href="",Jc=Jc.href}Ic=Qc.exec(Jc.toLowerCase())||[],fb.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Jc,type:"GET",isLocal:Nc.test(Ic[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Tc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":fb.parseJSON,"text xml":fb.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?P(P(a,fb.ajaxSettings),b):P(fb.ajaxSettings,a)},ajaxPrefilter:N(Rc),ajaxTransport:N(Sc),ajax:function(a,b){function c(a,b,c,d){var e,k,r,s,u,w=b;2!==t&&(t=2,h&&clearTimeout(h),j=void 0,g=d||"",v.readyState=a>0?4:0,e=a>=200&&300>a||304===a,c&&(s=Q(l,v,c)),s=R(l,s,v,e),e?(l.ifModified&&(u=v.getResponseHeader("Last-Modified"),u&&(fb.lastModified[f]=u),u=v.getResponseHeader("etag"),u&&(fb.etag[f]=u)),204===a||"HEAD"===l.type?w="nocontent":304===a?w="notmodified":(w=s.state,k=s.data,r=s.error,e=!r)):(r=w,(a||!w)&&(w="error",0>a&&(a=0))),v.status=a,v.statusText=(b||w)+"",e?o.resolveWith(m,[k,w,v]):o.rejectWith(m,[v,w,r]),v.statusCode(q),q=void 0,i&&n.trigger(e?"ajaxSuccess":"ajaxError",[v,l,e?k:r]),p.fireWith(m,[v,w]),i&&(n.trigger("ajaxComplete",[v,l]),--fb.active||fb.event.trigger("ajaxStop")))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var d,e,f,g,h,i,j,k,l=fb.ajaxSetup({},b),m=l.context||l,n=l.context&&(m.nodeType||m.jquery)?fb(m):fb.event,o=fb.Deferred(),p=fb.Callbacks("once memory"),q=l.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!k)for(k={};b=Mc.exec(g);)k[b[1].toLowerCase()]=b[2];b=k[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?g:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(l.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return j&&j.abort(b),c(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,l.url=((a||l.url||Jc)+"").replace(Kc,"").replace(Pc,Ic[1]+"//"),l.type=b.method||b.type||l.method||l.type,l.dataTypes=fb.trim(l.dataType||"*").toLowerCase().match(ub)||[""],null==l.crossDomain&&(d=Qc.exec(l.url.toLowerCase()),l.crossDomain=!(!d||d[1]===Ic[1]&&d[2]===Ic[2]&&(d[3]||("http:"===d[1]?"80":"443"))===(Ic[3]||("http:"===Ic[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=fb.param(l.data,l.traditional)),O(Rc,l,b,v),2===t)return v;i=l.global,i&&0===fb.active++&&fb.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!Oc.test(l.type),f=l.url,l.hasContent||(l.data&&(f=l.url+=(Gc.test(f)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=Lc.test(f)?f.replace(Lc,"$1_="+Fc++):f+(Gc.test(f)?"&":"?")+"_="+Fc++)),l.ifModified&&(fb.lastModified[f]&&v.setRequestHeader("If-Modified-Since",fb.lastModified[f]),fb.etag[f]&&v.setRequestHeader("If-None-Match",fb.etag[f])),(l.data&&l.hasContent&&l.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",l.contentType),v.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+Tc+"; q=0.01":""):l.accepts["*"]);for(e in l.headers)v.setRequestHeader(e,l.headers[e]);if(l.beforeSend&&(l.beforeSend.call(m,v,l)===!1||2===t))return v.abort();u="abort";for(e in{success:1,error:1,complete:1})v[e](l[e]);if(j=O(Sc,l,b,v)){v.readyState=1,i&&n.trigger("ajaxSend",[v,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){v.abort("timeout")
},l.timeout));try{t=1,j.send(r,c)}catch(w){if(!(2>t))throw w;c(-1,w)}}else c(-1,"No Transport");return v},getJSON:function(a,b,c){return fb.get(a,b,c,"json")},getScript:function(a,b){return fb.get(a,void 0,b,"script")}}),fb.each(["get","post"],function(a,b){fb[b]=function(a,c,d,e){return fb.isFunction(c)&&(e=e||d,d=c,c=void 0),fb.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),fb.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){fb.fn[b]=function(a){return this.on(b,a)}}),fb._evalUrl=function(a){return fb.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},fb.fn.extend({wrapAll:function(a){if(fb.isFunction(a))return this.each(function(b){fb(this).wrapAll(a.call(this,b))});if(this[0]){var b=fb(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(fb.isFunction(a)?function(b){fb(this).wrapInner(a.call(this,b))}:function(){var b=fb(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=fb.isFunction(a);return this.each(function(c){fb(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){fb.nodeName(this,"body")||fb(this).replaceWith(this.childNodes)}).end()}}),fb.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!db.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||fb.css(a,"display"))},fb.expr.filters.visible=function(a){return!fb.expr.filters.hidden(a)};var Vc=/%20/g,Wc=/\[\]$/,Xc=/\r?\n/g,Yc=/^(?:submit|button|image|reset|file)$/i,Zc=/^(?:input|select|textarea|keygen)/i;fb.param=function(a,b){var c,d=[],e=function(a,b){b=fb.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=fb.ajaxSettings&&fb.ajaxSettings.traditional),fb.isArray(a)||a.jquery&&!fb.isPlainObject(a))fb.each(a,function(){e(this.name,this.value)});else for(c in a)S(c,a[c],b,e);return d.join("&").replace(Vc,"+")},fb.fn.extend({serialize:function(){return fb.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=fb.prop(this,"elements");return a?fb.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!fb(this).is(":disabled")&&Zc.test(this.nodeName)&&!Yc.test(a)&&(this.checked||!Fb.test(a))}).map(function(a,b){var c=fb(this).val();return null==c?null:fb.isArray(c)?fb.map(c,function(a){return{name:b.name,value:a.replace(Xc,"\r\n")}}):{name:b.name,value:c.replace(Xc,"\r\n")}}).get()}}),fb.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&T()||U()}:T;var $c=0,_c={},ad=fb.ajaxSettings.xhr();a.ActiveXObject&&fb(a).on("unload",function(){for(var a in _c)_c[a](void 0,!0)}),db.cors=!!ad&&"withCredentials"in ad,ad=db.ajax=!!ad,ad&&fb.ajaxTransport(function(a){if(!a.crossDomain||db.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++$c;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete _c[g],b=void 0,f.onreadystatechange=fb.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=_c[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}}),fb.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return fb.globalEval(a),a}}}),fb.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),fb.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=pb.head||fb("head")[0]||pb.documentElement;return{send:function(d,e){b=pb.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var bd=[],cd=/(=)\?(?=&|$)|\?\?/;fb.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=bd.pop()||fb.expando+"_"+Fc++;return this[a]=!0,a}}),fb.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(cd.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&cd.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=fb.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(cd,"$1"+e):b.jsonp!==!1&&(b.url+=(Gc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||fb.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,bd.push(e)),g&&fb.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),fb.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||pb;var d=mb.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=fb.buildFragment([a],b,e),e&&e.length&&fb(e).remove(),fb.merge([],d.childNodes))};var dd=fb.fn.load;fb.fn.load=function(a,b,c){if("string"!=typeof a&&dd)return dd.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=a.slice(h,a.length),a=a.slice(0,h)),fb.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),g.length>0&&fb.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?fb("<div>").append(fb.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},fb.expr.filters.animated=function(a){return fb.grep(fb.timers,function(b){return a===b.elem}).length};var ed=a.document.documentElement;fb.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=fb.css(a,"position"),l=fb(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=fb.css(a,"top"),i=fb.css(a,"left"),j=("absolute"===k||"fixed"===k)&&fb.inArray("auto",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),fb.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},fb.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){fb.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;return f?(b=f.documentElement,fb.contains(b,e)?(typeof e.getBoundingClientRect!==yb&&(d=e.getBoundingClientRect()),c=V(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d):void 0},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===fb.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),fb.nodeName(a[0],"html")||(c=a.offset()),c.top+=fb.css(a[0],"borderTopWidth",!0),c.left+=fb.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-fb.css(d,"marginTop",!0),left:b.left-c.left-fb.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||ed;a&&!fb.nodeName(a,"html")&&"static"===fb.css(a,"position");)a=a.offsetParent;return a||ed})}}),fb.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);fb.fn[a]=function(d){return Eb(this,function(a,d,e){var f=V(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?fb(f).scrollLeft():e,c?e:fb(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),fb.each(["top","left"],function(a,b){fb.cssHooks[b]=A(db.pixelPosition,function(a,c){return c?(c=cc(a,b),ec.test(c)?fb(a).position()[b]+"px":c):void 0})}),fb.each({Height:"height",Width:"width"},function(a,b){fb.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){fb.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return Eb(this,function(b,c,d){var e;return fb.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?fb.css(b,c,g):fb.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),fb.fn.size=function(){return this.length},fb.fn.andSelf=fb.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return fb});var fd=a.jQuery,gd=a.$;return fb.noConflict=function(b){return a.$===fb&&(a.$=gd),b&&a.jQuery===fb&&(a.jQuery=fd),fb},typeof b===yb&&(a.jQuery=a.$=fb),fb}),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(a){return a}function c(a){return decodeURIComponent(a.replace(e," "))}function d(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return f.json?JSON.parse(a):a}catch(b){}}var e=/\+/g,f=a.cookie=function(e,g,h){if(void 0!==g){if(h=a.extend({},f.defaults,h),"number"==typeof h.expires){var i=h.expires,j=h.expires=new Date;j.setDate(j.getDate()+i)}return g=f.json?JSON.stringify(g):String(g),document.cookie=[f.raw?e:encodeURIComponent(e),"=",f.raw?g:encodeURIComponent(g),h.expires?"; expires="+h.expires.toUTCString():"",h.path?"; path="+h.path:"",h.domain?"; domain="+h.domain:"",h.secure?"; secure":""].join("")}for(var k=f.raw?b:c,l=document.cookie.split("; "),m=e?void 0:{},n=0,o=l.length;o>n;n++){var p=l[n].split("="),q=k(p.shift()),r=k(p.join("="));if(e&&e===q){m=d(r);break}e||(m[q]=d(r))}return m};f.defaults={},a.removeCookie=function(b,c){return void 0!==a.cookie(b)?(a.cookie(b,"",a.extend({},c,{expires:-1})),!0):!1}}),function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;e.length>d;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(jQuery),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(c,d,e){var f,g,h,i,j={},k=c.split(".")[0];c=c.split(".")[1],f=k+"-"+c,e||(e=d,d=a.Widget),a.expr[":"][f.toLowerCase()]=function(b){return!!a.data(b,f)},a[k]=a[k]||{},g=a[k][c],h=a[k][c]=function(a,c){return this._createWidget?(arguments.length&&this._createWidget(a,c),b):new h(a,c)},a.extend(h,g,{version:e.version,_proto:a.extend({},e),_childConstructors:[]}),i=new d,i.options=a.widget.extend({},i.options),a.each(e,function(c,e){return a.isFunction(e)?(j[c]=function(){var a=function(){return d.prototype[c].apply(this,arguments)},b=function(a){return d.prototype[c].apply(this,a)};return function(){var c,d=this._super,f=this._superApply;return this._super=a,this._superApply=b,c=e.apply(this,arguments),this._super=d,this._superApply=f,c}}(),b):(j[c]=e,b)}),h.prototype=a.widget.extend(i,{widgetEventPrefix:g?i.widgetEventPrefix:c},j,{constructor:h,namespace:k,widgetName:c,widgetFullName:f}),g?(a.each(g._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,h,c._proto)}),delete g._childConstructors):d._childConstructors.push(h),a.widget.bridge(c,h)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,this.each(h?function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):b):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}:function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;e.length-1>g;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),d===b)return f[c]===b?null:f[c];f[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(c,d,e){var f,g=this;"boolean"!=typeof c&&(e=d,d=c,c=!1),e?(d=f=a(d),this.bindings=this.bindings.add(d)):(e=d,d=this.element,f=this.widget()),a.each(e,function(e,h){function i(){return c||g.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof h?g[h]:h).apply(g,arguments):b}"string"!=typeof h&&(i.guid=h.guid=h.guid||i.guid||a.guid++);var j=e.match(/^(\w+)\s*(.*)$/),k=j[1]+g.eventNamespace,l=j[2];l?f.delegate(l,k,i):d.bind(k,i)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),function(a){var b=!1;a(document).mouseup(function(){b=!1}),a.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var d=this,e=1===c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(c)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=this._mouseStart(c)!==!1,!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)):!0}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||9>document.documentMode)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(a){a.widget("ui.draggable",a.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(b),this.handle?(a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"original"!==this.options.helper||a.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",b)!==!1&&c._clear()}):this._trigger("stop",b)!==!1&&this._clear(),!1):!1},_mouseUp:function(b){return a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return this.options.handle?!!a(b.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d[0]===this.element[0]||/(fixed|absolute)/.test(d.css("position"))||d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;return e.containment?"window"===e.containment?void(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===e.containment?void(this.containment=[0,0,a(document).width()-this.helperProportions.width-this.margins.left,(a(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):e.containment.constructor===Array?void(this.containment=e.containment):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),d=c[0],void(d&&(b="hidden"!==c.css("overflow"),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c))):void(this.containment=null)},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:e.scrollTop(),left:e.scrollLeft()}),{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*d}},_generatePosition:function(b){var c,d,e,f,g=this.options,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=b.pageX,j=b.pageY;
return this.offset.scroll||(this.offset.scroll={top:h.scrollTop(),left:h.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(d=this.relative_container.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,b.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),b.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),b.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),b.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),"drag"===b&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("ui-draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"ui-sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("ui-draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"===d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("ui-draggable"),e=this;a.each(d.sortables,function(){var f=!1,g=this;this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(f=!0,a.each(d.sortables,function(){return this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this!==g&&this.instance._intersectsWith(this.instance.containerCache)&&a.contains(g.instance.element[0],this.instance.element[0])&&(f=!1),f})),f?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("ui-draggable").options;b.css("cursor")&&(c._cursor=b.css("cursor")),b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("ui-draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("ui-draggable");b.scrollParent[0]!==document&&"HTML"!==b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("ui-draggable"),d=c.options,e=!1;c.scrollParent[0]!==document&&"HTML"!==c.scrollParent[0].tagName?(d.axis&&"x"===d.axis||(c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-c.overflowOffset.top<d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed)),d.axis&&"y"===d.axis||(c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed))):(d.axis&&"x"===d.axis||(b.pageY-a(document).scrollTop()<d.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed))),d.axis&&"y"===d.axis||(b.pageX-a(document).scrollLeft()<d.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed)))),e!==!1&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}}),a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("ui-draggable"),c=b.options;b.snapElements=[],a(c.snap.constructor!==String?c.snap.items||":data(ui-draggable)":c.snap).each(function(){var c=a(this),d=c.offset();this!==b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:d.top,left:d.left})})},drag:function(b,c){var d,e,f,g,h,i,j,k,l,m,n=a(this).data("ui-draggable"),o=n.options,p=o.snapTolerance,q=c.offset.left,r=q+n.helperProportions.width,s=c.offset.top,t=s+n.helperProportions.height;for(l=n.snapElements.length-1;l>=0;l--)h=n.snapElements[l].left,i=h+n.snapElements[l].width,j=n.snapElements[l].top,k=j+n.snapElements[l].height,h-p>r||q>i+p||j-p>t||s>k+p||!a.contains(n.snapElements[l].item.ownerDocument,n.snapElements[l].item)?(n.snapElements[l].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=!1):("inner"!==o.snapMode&&(d=p>=Math.abs(j-t),e=p>=Math.abs(k-s),f=p>=Math.abs(h-r),g=p>=Math.abs(i-q),d&&(c.position.top=n._convertPositionTo("relative",{top:j-n.helperProportions.height,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i}).left-n.margins.left)),m=d||e||f||g,"outer"!==o.snapMode&&(d=p>=Math.abs(j-s),e=p>=Math.abs(k-t),f=p>=Math.abs(h-q),g=p>=Math.abs(i-r),d&&(c.position.top=n._convertPositionTo("relative",{top:j,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k-n.helperProportions.height,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[l].snapping&&(d||e||f||g||m)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=d||e||f||g||m)}}),a.ui.plugin.add("draggable","stack",{start:function(){var b,c=this.data("ui-draggable").options,d=a.makeArray(a(c.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});d.length&&(b=parseInt(a(d[0]).css("zIndex"),10)||0,a(d).each(function(c){a(this).css("zIndex",b+c)}),this.css("zIndex",b+d.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})}(jQuery),function(a){function b(a,b,c){return a>b&&b+c>a}a.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var b=this.options,c=b.accept;this.isover=!1,this.isout=!0,this.accept=a.isFunction(c)?c:function(a){return a.is(c)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[],a.ui.ddmanager.droppables[b.scope].push(this),b.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var b=0,c=a.ui.ddmanager.droppables[this.options.scope];c.length>b;b++)c[b]===this&&c.splice(b,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(b,c){"accept"===b&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current,e=!1;return d&&(d.currentItem||d.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"ui-droppable");return b.options.greedy&&!b.options.disabled&&b.options.scope===d.options.scope&&b.accept.call(b.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(b,{offset:b.element.offset()}),b.options.tolerance)?(e=!0,!1):void 0}),e?!1:this.accept.call(this.element[0],d.currentItem||d.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),this.element):!1):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.ui.intersect=function(a,c,d){if(!c.offset)return!1;var e,f,g=(a.positionAbs||a.position.absolute).left,h=g+a.helperProportions.width,i=(a.positionAbs||a.position.absolute).top,j=i+a.helperProportions.height,k=c.offset.left,l=k+c.proportions.width,m=c.offset.top,n=m+c.proportions.height;switch(d){case"fit":return g>=k&&l>=h&&i>=m&&n>=j;case"intersect":return g+a.helperProportions.width/2>k&&l>h-a.helperProportions.width/2&&i+a.helperProportions.height/2>m&&n>j-a.helperProportions.height/2;case"pointer":return e=(a.positionAbs||a.position.absolute).left+(a.clickOffset||a.offset.click).left,f=(a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,b(f,m,c.proportions.height)&&b(e,k,c.proportions.width);case"touch":return(i>=m&&n>=i||j>=m&&n>=j||m>i&&j>n)&&(g>=k&&l>=g||h>=k&&l>=h||k>g&&h>l);default:return!1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var d,e,f=a.ui.ddmanager.droppables[b.options.scope]||[],g=c?c.type:null,h=(b.currentItem||b.element).find(":data(ui-droppable)").addBack();a:for(d=0;f.length>d;d++)if(!(f[d].options.disabled||b&&!f[d].accept.call(f[d].element[0],b.currentItem||b.element))){for(e=0;h.length>e;e++)if(h[e]===f[d].element[0]){f[d].proportions.height=0;continue a}f[d].visible="none"!==f[d].element.css("display"),f[d].visible&&("mousedown"===g&&f[d]._activate.call(f[d],c),f[d].offset=f[d].element.offset(),f[d].proportions={width:f[d].element[0].offsetWidth,height:f[d].element[0].offsetHeight})}},drop:function(b,c){var d=!1;return a.each((a.ui.ddmanager.droppables[b.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,c)))}),d},dragStart:function(b,c){b.element.parentsUntil("body").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var d,e,f,g=a.ui.intersect(b,this,this.options.tolerance),h=!g&&this.isover?"isout":g&&!this.isover?"isover":null;h&&(this.options.greedy&&(e=this.options.scope,f=this.element.parents(":data(ui-droppable)").filter(function(){return a.data(this,"ui-droppable").options.scope===e}),f.length&&(d=a.data(f[0],"ui-droppable"),d.greedyChild="isover"===h)),d&&"isover"===h&&(d.isover=!1,d.isout=!0,d._out.call(d,c)),this[h]=!0,this["isout"===h?"isover":"isout"]=!1,this["isover"===h?"_over":"_out"].call(this,c),d&&"isout"===h&&(d.isout=!1,d.isover=!0,d._over.call(d,c)))}})},dragStop:function(b,c){b.element.parentsUntil("body").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}}}(jQuery);var peerConnectionsListElem=null,ssrcInfoManager=null,peerConnectionUpdateTable=null,statsTable=null,dumpCreator=null,SsrcInfoManager=function(){"use strict";function a(){this.streamInfoContainer_={},this.ATTRIBUTE_SEPARATOR_=/[\r,\n]/,this.FIELD_SEPARATOR_REGEX_=/ .*:/,this.SSRC_ATTRIBUTE_PREFIX_="a=ssrc:",this.SSRC_INFO_BLOCK_CLASS_="ssrc-info-block"}return a.prototype={addSsrcStreamInfo:function(a){for(var b=a.split(this.ATTRIBUTE_SEPARATOR_),c=0;c<b.length;++c)if(0==b[c].indexOf(this.SSRC_ATTRIBUTE_PREFIX_)){var d=b[c].search(this.FIELD_SEPARATOR_REGEX_);if(-1!=d){var e=b[c].substring(this.SSRC_ATTRIBUTE_PREFIX_.length,d);this.streamInfoContainer_[e]||(this.streamInfoContainer_[e]={});for(var f,g,h=b[c].substring(d+1);h.length>0;)d=h.search(this.FIELD_SEPARATOR_REGEX_),-1==d&&(d=h.length),f=h.substring(0,h.indexOf(":")),g=h.substring(h.indexOf(":")+1,d),this.streamInfoContainer_[e][f]=g,h=h.substring(d+1)}}},getStreamInfo:function(a){return this.streamInfoContainer_[a]},populateSsrcInfo:function(a,b){if(this.streamInfoContainer_[b]){a.className=this.SSRC_INFO_BLOCK_CLASS_;var c;for(var d in this.streamInfoContainer_[b])c=document.createElement("div"),a.appendChild(c),c.textContent=d+":"+this.streamInfoContainer_[b][d]}}},a}(),TimelineDataSeries=function(){"use strict";function a(){this.dataPoints_=[],this.color_="red",this.isVisible_=!0,this.cacheStartTime_=null,this.cacheStepSize_=0,this.cacheValues_=[]}function b(a,b){this.time=a,this.value=b}return a.prototype={addPoint:function(a,c){var d=new Date(a);this.dataPoints_.push(new b(d,c))},isVisible:function(){return this.isVisible_},show:function(a){this.isVisible_=a},getColor:function(){return this.color_},setColor:function(a){this.color_=a},getAvg:function(){for(var a=0,b=0;b<this.dataPoints_.length;b++)a+=this.dataPoints_[b].value;return a/this.dataPoints_.length},getValues:function(a,b,c){return this.cacheStartTime_==a&&this.cacheStepSize_==b&&this.cacheValues_.length==c?this.cacheValues_:(this.cacheValues_=this.getValuesInternal_(a,b,c),this.cacheStartTime_=a,this.cacheStepSize_=b,this.cacheValues_)},getValuesInternal_:function(a,b,c){for(var d=[],e=0,f=0,g=a,h=0;c>h;++h){for(;e<this.dataPoints_.length&&this.dataPoints_[e].time<g;)f=this.dataPoints_[e].value,++e;d[h]=f,g+=b}return d}},a}(),TimelineGraphView=function(){"use strict";function a(a,b){this.scrollbar_={position_:0,range_:0},this.graphDiv_=$('[id="'+a+'"]')[0],this.canvas_=$('[id="'+b+'"]')[0],this.startTime_=0,this.endTime_=1,this.graph_=null,this.updateScrollbarRange_(!0)}var b=2e3,c=6,d=4,e=3,f=25,g=10,h="#CCC",i="#000",j="#FFF";a.prototype={getLength_:function(){var a=this.endTime_-this.startTime_;return Math.floor(a/b)},graphScrolledToRightEdge_:function(){return this.scrollbar_.position_==this.scrollbar_.range_},updateScrollbarRange_:function(a){var b=this.getLength_()-this.canvas_.width;0>b&&(b=0),this.scrollbar_.position_>b&&(a=!0),this.scrollbar_.range_=b,a&&(this.scrollbar_.position_=b,this.repaint())},setDateRange:function(a,b){this.startTime_=a.getTime(),this.endTime_=b.getTime(),this.endTime_<=this.startTime_&&(this.startTime_=this.endTime_-1),this.updateScrollbarRange_(!0)},updateEndDate:function(){this.endTime_=(new Date).getTime(),this.updateScrollbarRange_(this.graphScrolledToRightEdge_())},getStartDate:function(){return new Date(this.startTime_)},setDataSeries:function(a){this.graph_=new k;for(var b=0;b<a.length;++b)this.graph_.addDataSeries(a[b]);this.repaint()},addDataSeries:function(a){this.graph_||(this.graph_=new k),this.graph_.addDataSeries(a),this.repaint()},repaint:function(){this.repaintTimerRunning_=!1;var a=this.canvas_.width,c=this.canvas_.height,e=this.canvas_.getContext("2d");e.fillStyle=j,e.fillRect(0,0,a,c);var f=e.font.match(/([0-9]+)px/)[1],g=parseInt(f);if(!(0==f.length||0>=g||4*g>c||50>a)){e.save(),e.translate(.5,.5);var i=this.scrollbar_.position_;0==this.scrollbar_.range_&&(i=this.getLength_()-this.canvas_.width);var k=this.startTime_+i*b,l=c;c-=g+d,this.drawTimeLabels(e,a,c,l,k),e.strokeStyle=h,e.strokeRect(0,0,a-1,c-1),this.graph_&&(this.graph_.layout(a,c,g,k,b),this.graph_.drawTicks(e),this.graph_.drawLines(e),this.graph_.drawLabels(e)),e.restore()}},drawTimeLabels:function(a,c,d,e,g){for(var j=new Date(g).toLocaleTimeString(),k=a.measureText(j).width+f,l=[1e3,5e3,3e4,6e4,3e5,18e5,36e5,18e6],m=null,n=0;n<l.length;++n)if(l[n]/b>=k){m=l[n];break}if(m){var o=Math.ceil(g/m)*m;for(a.textBaseline="bottom",a.textAlign="center",a.fillStyle=i,a.strokeStyle=h;;){var p=Math.round((o-g)/b);if(p>=c)break;var q=new Date(o).toLocaleTimeString();a.fillText(q,p,e),a.beginPath(),a.lineTo(p,0),a.lineTo(p,d),a.stroke(),o+=m}}},getDataSeriesCount:function(){return this.graph_?this.graph_.dataSeries_.length:0},hasDataSeries:function(a){return this.graph_?this.graph_.hasDataSeries(a):!1}};var k=function(){function a(){this.dataSeries_=[],this.width_=0,this.height_=0,this.fontHeight_=0,this.startTime_=0,this.scale_=0,this.max_=0,this.labels_=[]}return a.prototype={addDataSeries:function(a){this.dataSeries_.push(a)},hasDataSeries:function(a){for(var b=0;b<this.dataSeries_.length;++b)if(this.dataSeries_[b]==a)return!0;return!1},getValues:function(a){return a.isVisible()?a.getValues(this.startTime_,this.scale_,this.width_):null},layout:function(a,b,c,d,e){this.width_=a,this.height_=b,this.fontHeight_=c,this.startTime_=d,this.scale_=e;for(var f=0,g=0;g<this.dataSeries_.length;++g){var h=this.getValues(this.dataSeries_[g]);if(h)for(var i=0;i<h.length;++i)h[i]>f&&(f=h[i])}this.layoutLabels_(f)},layoutLabels_:function(a){if(1024>a)return void this.layoutLabelsBasic_(a,0);var b=["","m","M","G","T","P"],c=1;for(a/=1024;b[c+1]&&a>=1024;)a/=1024,++c;this.layoutLabelsBasic_(a,1);for(var d=0;d<this.labels_.length;++d)this.labels_[d]+=" "+b[c];this.max_*=Math.pow(1024,c)},layoutLabelsBasic_:function(a,b){if(this.labels_=[],0==a)return void(this.max_=a);var e=2*this.fontHeight_+d,f=1+this.height_/e;2>f?f=2:f>c&&(f=c);for(var g=Math.pow(10,-b),h=b;;){if(Math.ceil(a/g)+1<=f)break;if(Math.ceil(a/(2*g))+1<=f){g*=2;break}if(Math.ceil(a/(5*g))+1<=f){g*=5;break}g*=10,h>0&&--h}this.max_=Math.ceil(a/g)*g;for(var i=this.max_;i>=0;i-=g)this.labels_.push(i.toFixed(h))},drawTicks:function(a){var b,c;b=this.width_-1,c=this.width_-1-g,a.fillStyle=h,a.beginPath();for(var d=1;d<this.labels_.length-1;++d){var e=Math.round(this.height_*d/(this.labels_.length-1));a.moveTo(b,e),a.lineTo(c,e)}a.stroke()},drawLines:function(a){var b=0,c=this.height_-1;this.max_&&(b=c/this.max_);for(var d=this.dataSeries_.length-1;d>=0;--d){var e=this.getValues(this.dataSeries_[d]);if(e){a.strokeStyle=this.dataSeries_[d].getColor(),a.beginPath();for(var f=0;f<e.length;++f)a.lineTo(f,c-Math.round(e[f]*b));a.stroke()}}},drawLabels:function(a){if(0!=this.labels_.length){var b=this.width_-e;a.fillStyle=i,a.textAlign="right",a.textBaseline="top",a.fillText(this.labels_[0],b,0),a.textBaseline="bottom";for(var c=(this.height_-1)/(this.labels_.length-1),d=1;d<this.labels_.length;++d)a.fillText(this.labels_[d],b,c*d)}}},a}();return a}(),STATS_GRAPH_CONTAINER_HEADING_CLASS="stats-graph-container-heading",bweCompoundGraphConfig={googAvailableSendBandwidth:{color:"red"},googTargetEncBitrateCorrected:{color:"purple"},googActualEncBitrate:{color:"orange"},googRetransmitBitrate:{color:"blue"},googTransmitBitrate:{color:"green"}},totalToPerSecond=function(a){var b=a.dataPoints_.length;if(b>=2){var c=a.dataPoints_[b-1],d=a.dataPoints_[b-2];return Math.round(1e3*(c.value-d.value)/(c.time-d.time))}return 0},totalBytesToBitsPerSecond=function(a){return 8*totalToPerSecond(a)},totalKiloBytesToBitsPerSecond=function(a){return totalBytesToBitsPerSecond(a)/1e3},packetsLostPercentage=function(a,b,c,d){var e=getLastValue(b,c,d,"packetsLost"),f=getLastValue(b,c,d,"packetsReceived");return null!=e&&null!=f?Math.round(100*e/(f+e)*100)/100:null},dataConversionConfig={packetsSent:{convertedName:"packetsSentPerSecond",convertFunction:totalToPerSecond},bytesSent:{convertedName:"kiloBitsSentPerSecond",convertFunction:totalKiloBytesToBitsPerSecond},packetsReceived:{convertedName:"packetsReceivedPerSecond",convertFunction:totalToPerSecond},bytesReceived:{convertedName:"kiloBitsReceivedPerSecond",convertFunction:totalKiloBytesToBitsPerSecond},packetsLost:{convertedName:"packetsLostPer",convertFunction:packetsLostPercentage},googTargetEncBitrate:{convertedName:"googTargetEncBitrateCorrected",convertFunction:function(a){var b=a.dataPoints_.length,c=a.dataPoints_[b-1];return c.value<5e3?1e3*c.value:c.value}}},graphViews={},dataSeries={},StatsTable=function(){"use strict";function a(a){this.ssrcInfoManager_=a}return a.prototype={addStatsReport:function(a,b,c,d){var e=this.ensureStatsTable_(a,d);d.stats&&this.addStatsToTable_(a,b,c,e,d.stats.timestamp,d.stats.values)},ensureStatsTableContainer_:function(a){var b=a.id+"-table-container",c=$('[id="'+b+'"]')[0];return c||(c=document.createElement("div"),c.id=b,c.className="stats-table-container",a.appendChild(c)),c},ensureStatsTable_:function(a,b){var c=a.id+"-table-"+b.type+"-"+b.id,d=$(document.getElementById(c))[0];if(!d){var e=this.ensureStatsTableContainer_(a);d=document.createElement("table"),e.appendChild(d),d.id=c,d.border=1,d.innerHTML="<tr><th colspan=2></th></tr>",d.rows[0].cells[0].textContent="Statistics "+b.type+"-"+b.id,"ssrc"==b.type&&(d.insertRow(1),d.rows[1].innerHTML="<td colspan=2></td>",this.ssrcInfoManager_.populateSsrcInfo(d.rows[1].cells[0],b.id))}return d},addStatsToTable_:function(a,b,c,d,e,f){Date(e);$(".stats-var").each(function(){var d=$(this).data("var"),e=$(this).data("type");if(matchesType(d,e,f)){var g=getLastValue(a,b,c,d);null!=g&&($(this).html(g),$(this).attr("data-avg",getAvgValue(a,b,c,d)))}})},updateStatsTableRow_:function(a,b,c){var d=a.id+"-"+b,e=$('[id="'+d+'"]')[0];e||(e=document.createElement("tr"),e.id=d,a.firstChild.appendChild(e),e.innerHTML="<td>"+b+"</td><td></td>"),e.cells[1].textContent=c}},a}(),PeerConnectionUpdateEntry=function(a,b,c,d){this.pid=a,this.lid=b,this.type=c,this.value=d},PeerConnectionUpdateTable=function(){"use strict";function a(){this.UPDATE_LOG_ID_SUFFIX_="-update-log",this.UPDATE_LOG_CONTAINER_CLASS_="update-log-container",this.UPDATE_LOG_TABLE_CLASS_="update-log-table"}return a.prototype={addPeerConnectionUpdate:function(a,b){var c=this.ensureUpdateContainer_(a),d=document.createElement("tr");if(c.firstChild.appendChild(d),d.innerHTML="<td>"+(new Date).toLocaleString()+"</td>",0==b.value.length)return void(d.innerHTML+="<td>"+b.type+"</td>");d.innerHTML+="<td><details><summary>"+b.type+"</summary></details></td>";var e=document.createElement("pre"),f=d.cells[1].childNodes[0];f.appendChild(e),e.textContent=b.value},ensureUpdateContainer_:function(a){var b=a.id+this.UPDATE_LOG_ID_SUFFIX_,c=$('[id="'+b+'"]')[0];if(!c){var d=document.createElement("div");d.className=this.UPDATE_LOG_CONTAINER_CLASS_,a.appendChild(d),c=document.createElement("table"),c.className=this.UPDATE_LOG_TABLE_CLASS_,c.id=b,c.border=1,d.appendChild(c),c.innerHTML='<tr><th>Time</th><th class="update-log-header-event">Event</th></tr>'}return c}},a}(),DumpCreator=function(){function a(a){this.recording_=!1,this.StatusStrings_={NOT_STARTED:"not started.",RECORDING:"recording..."},this.status_=this.StatusStrings_.NOT_STARTED,this.root_=document.createElement("details"),this.root_.className="peer-connection-dump-root",a.appendChild(this.root_);var b=document.createElement("summary");this.root_.appendChild(b),b.textContent="Create Dump";var c=document.createElement("pre");this.root_.appendChild(c),c.innerHTML="<button></button> Status: <span></span>",c.getElementsByTagName("button")[0].addEventListener("click",this.onToggled_.bind(this)),this.updateDisplay_()}return a.prototype={onToggled_:function(){this.recording_?(this.recording_=!1,this.status_=this.StatusStrings_.NOT_STARTED,chrome.send("stopRtpRecording")):(this.recording_=!0,this.status_=this.StatusStrings_.RECORDING,chrome.send("startRtpRecording")),this.updateDisplay_()},updateDisplay_:function(){this.root_.getElementsByTagName("button")[0].textContent=this.recording_?"Stop Recording RTP Packets":"Start Recording RTP Packets",this.root_.getElementsByTagName("span")[0].textContent=this.status_},onUpdate:function(a){this.recording_&&(this.status_=JSON.stringify(a),this.updateDisplay_())}},a}();document.addEventListener("DOMContentLoaded",initialize),function(b){var c=b.detect=function(){var b=function(){},c={browser_parsers:[{regex:"^(Opera)/(\\d+)\\.(\\d+) \\(Nintendo Wii",family_replacement:"Wii",manufacturer:"Nintendo"},{regex:"(SeaMonkey|Camino)/(\\d+)\\.(\\d+)\\.?([ab]?\\d+[a-z]*)",family_replacement:"Camino",other:!0},{regex:"(Pale[Mm]oon)/(\\d+)\\.(\\d+)\\.?(\\d+)?",family_replacement:"Pale Moon (Firefox Variant)",other:!0},{regex:"(Fennec)/(\\d+)\\.(\\d+)\\.?([ab]?\\d+[a-z]*)",family_replacement:"Firefox Mobile"},{regex:"(Fennec)/(\\d+)\\.(\\d+)(pre)",family_replacment:"Firefox Mobile"},{regex:"(Fennec)/(\\d+)\\.(\\d+)",family_replacement:"Firefox Mobile"},{regex:"Mobile.*(Firefox)/(\\d+)\\.(\\d+)",family_replacement:"Firefox Mobile"},{regex:"(Namoroka|Shiretoko|Minefield)/(\\d+)\\.(\\d+)\\.(\\d+(?:pre)?)",family_replacement:"Firefox ($1)"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(a\\d+[a-z]*)",family_replacement:"Firefox Alpha"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(b\\d+[a-z]*)",family_replacement:"Firefox Beta"},{regex:"(Firefox)-(?:\\d+\\.\\d+)?/(\\d+)\\.(\\d+)(a\\d+[a-z]*)",family_replacement:"Firefox Alpha"},{regex:"(Firefox)-(?:\\d+\\.\\d+)?/(\\d+)\\.(\\d+)(b\\d+[a-z]*)",family_replacement:"Firefox Beta"},{regex:"(Namoroka|Shiretoko|Minefield)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)?",family_replacement:"Firefox ($1)"},{regex:"(Firefox).*Tablet browser (\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"MicroB",tablet:!0},{regex:"(MozillaDeveloperPreview)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)?"},{regex:"(Flock)/(\\d+)\\.(\\d+)(b\\d+?)",family_replacement:"Flock",other:!0},{regex:"(RockMelt)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Rockmelt",other:!0},{regex:"(Navigator)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Netscape"},{regex:"(Navigator)/(\\d+)\\.(\\d+)([ab]\\d+)",family_replacement:"Netscape"},{regex:"(Netscape6)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Netscape"},{regex:"(MyIBrow)/(\\d+)\\.(\\d+)",family_replacement:"My Internet Browser",other:!0},{regex:"(Opera Tablet).*Version/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",family_replacement:"Opera Tablet",tablet:!0},{regex:"(Opera)/.+Opera Mobi.+Version/(\\d+)\\.(\\d+)",family_replacement:"Opera Mobile"},{regex:"Opera Mobi",family_replacement:"Opera Mobile"},{regex:"(Opera Mini)/(\\d+)\\.(\\d+)",family_replacement:"Opera Mini"},{regex:"(Opera Mini)/att/(\\d+)\\.(\\d+)",family_replacement:"Opera Mini"},{regex:"(Opera)/9.80.*Version/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",family_replacement:"Opera"},{regex:"(webOSBrowser)/(\\d+)\\.(\\d+)",family_replacement:"webOS"},{regex:"(webOS)/(\\d+)\\.(\\d+)",family_replacement:"webOS"},{regex:"(wOSBrowser).+TouchPad/(\\d+)\\.(\\d+)",family_replacement:"webOS TouchPad"},{regex:"(luakit)",family_replacement:"LuaKit",other:!0},{regex:"(Lightning)/(\\d+)\\.(\\d+)([ab]?\\d+[a-z]*)",family_replacement:"Lightning",other:!0},{regex:"(Firefox)/(\\d+)\\.(\\d+)\\.(\\d+(?:pre)?) \\(Swiftfox\\)",family_replacement:"Swiftfox",other:!0},{regex:"(Firefox)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)? \\(Swiftfox\\)",family_replacement:"Swiftfox",other:!0},{regex:"rekonq",family_replacement:"Rekonq",other:!0},{regex:"(conkeror|Conkeror)/(\\d+)\\.(\\d+)\\.?(\\d+)?",family_replacement:"Conkeror",other:!0},{regex:"(konqueror)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Konqueror",other:!0},{regex:"(WeTab)-Browser",family_replacement:"WeTab",other:!0},{regex:"(Comodo_Dragon)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Comodo Dragon",other:!0},{regex:"(YottaaMonitor)",family_replacement:"Yottaa Monitor",other:!0},{regex:"(Kindle)/(\\d+)\\.(\\d+)",family_replacement:"Kindle"},{regex:"(Symphony) (\\d+).(\\d+)",family_replacement:"Symphony",other:!0},{regex:"Minimo",family_replacement:"Minimo",other:!0},{regex:"(CrMo)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Mobile"},{regex:"(CriOS)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Mobile iOS"},{regex:"(Chrome)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+) Mobile",family_replacement:"Chrome Mobile"},{regex:"(chromeframe)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Frame"},{regex:"(UC Browser)(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"UC Browser",other:!0},{regex:"(SLP Browser)/(\\d+)\\.(\\d+)",family_replacement:"Tizen Browser",other:!0},{regex:"(Epiphany)/(\\d+)\\.(\\d+).(\\d+)",family_replacement:"Epiphany",other:!0},{regex:"(SE 2\\.X) MetaSr (\\d+)\\.(\\d+)",family_replacement:"Sogou Explorer",other:!0},{regex:"(Pingdom.com_bot_version_)(\\d+)\\.(\\d+)",family_replacement:"PingdomBot",other:!0},{regex:"(facebookexternalhit)/(\\d+)\\.(\\d+)",family_replacement:"FacebookBot"},{regex:"(Twitterbot)/(\\d+)\\.(\\d+)",family_replacement:"TwitterBot"},{regex:"(AdobeAIR|Chromium|FireWeb|Jasmine|ANTGalio|Midori|Fresco|Lobo|PaleMoon|Maxthon|Lynx|OmniWeb|Dillo|Camino|Demeter|Fluid|Fennec|Shiira|Sunrise|Chrome|Flock|Netscape|Lunascape|WebPilot|NetFront|Netfront|Konqueror|SeaMonkey|Kazehakase|Vienna|Iceape|Iceweasel|IceWeasel|Iron|K-Meleon|Sleipnir|Galeon|GranParadiso|Opera Mini|iCab|NetNewsWire|ThunderBrowse|Iron|Iris|UP\\.Browser|Bunjaloo|Google Earth|Raven for Mac)/(\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(Bolt|Jasmine|IceCat|Skyfire|Midori|Maxthon|Lynx|Arora|IBrowse|Dillo|Camino|Shiira|Fennec|Phoenix|Chrome|Flock|Netscape|Lunascape|Epiphany|WebPilot|Opera Mini|Opera|NetFront|Netfront|Konqueror|Googlebot|SeaMonkey|Kazehakase|Vienna|Iceape|Iceweasel|IceWeasel|Iron|K-Meleon|Sleipnir|Galeon|GranParadiso|iCab|NetNewsWire|Iron|Space Bison|Stainless|Orca|Dolfin|BOLT|Minimo|Tizen Browser|Polaris)/(\\d+)\\.(\\d+)"},{regex:"(iRider|Crazy Browser|SkipStone|iCab|Lunascape|Sleipnir|Maemo Browser) (\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(iCab|Lunascape|Opera|Android|Jasmine|Polaris|BREW) (\\d+)\\.(\\d+)\\.?(\\d+)?"},{regex:"(Android) Donut",v2_replacement:"2",v1_replacement:"1"},{regex:"(Android) Eclair",v2_replacement:"1",v1_replacement:"2"},{regex:"(Android) Froyo",v2_replacement:"2",v1_replacement:"2"},{regex:"(Android) Gingerbread",v2_replacement:"3",v1_replacement:"2"},{regex:"(Android) Honeycomb",v1_replacement:"3"},{regex:"(IEMobile)[ /](\\d+)\\.(\\d+)",family_replacement:"IE Mobile"},{regex:"(MSIE) (\\d+)\\.(\\d+).*XBLWP7",family_replacement:"IE Large Screen"},{regex:"(Firefox)/(\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(pre|[ab]\\d+[a-z]*)?"},{regex:"(Obigo)InternetBrowser",other:!0},{regex:"(Obigo)\\-Browser",other:!0},{regex:"(Obigo|OBIGO)[^\\d]*(\\d+)(?:.(\\d+))?",other:!0},{regex:"(MAXTHON|Maxthon) (\\d+)\\.(\\d+)",family_replacement:"Maxthon",other:!0},{regex:"(Maxthon|MyIE2|Uzbl|Shiira)",v1_replacement:"0",other:!0},{regex:"(PLAYSTATION) (\\d+)",family_replacement:"PlayStation",manufacturer:"Sony"},{regex:"(PlayStation Portable)[^\\d]+(\\d+).(\\d+)",manufacturer:"Sony"},{regex:"(BrowseX) \\((\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(POLARIS)/(\\d+)\\.(\\d+)",family_replacement:"Polaris",other:!0},{regex:"(Embider)/(\\d+)\\.(\\d+)",family_replacement:"Polaris",other:!0},{regex:"(BonEcho)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Bon Echo",other:!0},{regex:"(iPod).+Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPod).*Version/(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPod)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPhone).*Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPhone).*Version/(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPhone)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPad).*Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",tablet:!0,manufacturer:"Apple"},{regex:"(iPad).*Version/(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",tablet:!0,manufacturer:"Apple"},{regex:"(iPad)",family_replacement:"Mobile Safari",tablet:!0,manufacturer:"Apple"},{regex:"(AvantGo) (\\d+).(\\d+)",other:!0},{regex:"(Avant)",v1_replacement:"1",other:!0},{regex:"^(Nokia)",family_replacement:"Nokia Services (WAP) Browser",manufacturer:"Nokia"},{regex:"(NokiaBrowser)/(\\d+)\\.(\\d+).(\\d+)\\.(\\d+)",manufacturer:"Nokia"},{regex:"(NokiaBrowser)/(\\d+)\\.(\\d+).(\\d+)",manufacturer:"Nokia"},{regex:"(NokiaBrowser)/(\\d+)\\.(\\d+)",manufacturer:"Nokia"},{regex:"(BrowserNG)/(\\d+)\\.(\\d+).(\\d+)",family_replacement:"NokiaBrowser",manufacturer:"Nokia"},{regex:"(Series60)/5\\.0",v2_replacement:"0",v1_replacement:"7",family_replacement:"NokiaBrowser",manufacturer:"Nokia"},{regex:"(Series60)/(\\d+)\\.(\\d+)",family_replacement:"Nokia OSS Browser",manufacturer:"Nokia"},{regex:"(S40OviBrowser)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Nokia Series 40 Ovi Browser",manufacturer:"Nokia"},{regex:"(Nokia)[EN]?(\\d+)",manufacturer:"Nokia"},{regex:"(BB10);",family_replacement:"Blackberry WebKit",manufacturer:"RIM"},{regex:"(PlayBook).+RIM Tablet OS (\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Blackberry WebKit",tablet:!0,manufacturer:"Nokia"},{regex:"(Black[bB]erry).+Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Blackberry WebKit",manufacturer:"RIM"},{regex:"(Black[bB]erry)\\s?(\\d+)",family_replacement:"Blackberry",manufacturer:"RIM"},{regex:"(OmniWeb)/v(\\d+)\\.(\\d+)",other:!0},{regex:"(Blazer)/(\\d+)\\.(\\d+)",family_replacement:"Palm Blazer",manufacturer:"Palm"},{regex:"(Pre)/(\\d+)\\.(\\d+)",family_replacement:"Palm Pre",manufacturer:"Palm"},{regex:"(Links) \\((\\d+)\\.(\\d+)",other:!0},{regex:"(QtWeb) Internet Browser/(\\d+)\\.(\\d+)",other:!0},{regex:"(Silk)/(\\d+)\\.(\\d+)(?:\\.([0-9\\-]+))?",other:!0,tablet:!0},{regex:"(AppleWebKit)/(\\d+)\\.?(\\d+)?\\+ .* Version/\\d+\\.\\d+.\\d+ Safari/",family_replacement:"WebKit Nightly"},{regex:"(Version)/(\\d+)\\.(\\d+)(?:\\.(\\d+))?.*Safari/",family_replacement:"Safari"},{regex:"(Safari)/\\d+"},{regex:"(OLPC)/Update(\\d+)\\.(\\d+)",other:!0},{regex:"(OLPC)/Update()\\.(\\d+)",v1_replacement:"0",other:!0},{regex:"(SEMC\\-Browser)/(\\d+)\\.(\\d+)",other:!0},{regex:"(Teleca)",family_replacement:"Teleca Browser",other:!0},{regex:"(MSIE) (\\d+)\\.(\\d+)",family_replacement:"IE"}],os_parsers:[{regex:"(Android) (\\d+)\\.(\\d+)(?:[.\\-]([a-z0-9]+))?"},{regex:"(Android)\\-(\\d+)\\.(\\d+)(?:[.\\-]([a-z0-9]+))?"},{regex:"(Android) Donut",os_v2_replacement:"2",os_v1_replacement:"1"},{regex:"(Android) Eclair",os_v2_replacement:"1",os_v1_replacement:"2"},{regex:"(Android) Froyo",os_v2_replacement:"2",os_v1_replacement:"2"},{regex:"(Android) Gingerbread",os_v2_replacement:"3",os_v1_replacement:"2"},{regex:"(Android) Honeycomb",os_v1_replacement:"3"},{regex:"(Windows Phone 6\\.5)"},{regex:"(Windows (?:NT 5\\.2|NT 5\\.1))",os_replacement:"Windows XP"},{regex:"(XBLWP7)",os_replacement:"Windows Phone OS"},{regex:"(Windows NT 6\\.1)",os_replacement:"Windows 7"},{regex:"(Windows NT 6\\.0)",os_replacement:"Windows Vista"},{regex:"(Windows 98|Windows XP|Windows ME|Windows 95|Windows CE|Windows 7|Windows NT 4\\.0|Windows Vista|Windows 2000)"},{regex:"(Windows NT 6\\.2)",os_replacement:"Windows 8"},{regex:"(Windows Phone 8)",os_replacement:"Windows Phone 8"},{regex:"(Windows NT 5\\.0)",os_replacement:"Windows 2000"},{regex:"(Windows Phone OS) (\\d+)\\.(\\d+)"},{regex:"(Windows ?Mobile)",os_replacement:"Windows Mobile"},{regex:"(WinNT4.0)",os_replacement:"Windows NT 4.0"},{regex:"(Win98)",os_replacement:"Windows 98"},{regex:"(Tizen)/(\\d+)\\.(\\d+)",other:!0},{regex:"(Mac OS X) (\\d+)[_.](\\d+)(?:[_.](\\d+))?",manufacturer:"Apple"},{regex:"(?:PPC|Intel) (Mac OS X)",manufacturer:"Apple"},{regex:"(CPU OS|iPhone OS) (\\d+)_(\\d+)(?:_(\\d+))?",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(iPhone|iPad|iPod); Opera",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(iPad); Opera",tablet:!0,manufacturer:"Apple"},{regex:"(iPhone|iPad|iPod).*Mac OS X.*Version/(\\d+)\\.(\\d+)",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(CrOS) [a-z0-9_]+ (\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"Chrome OS"},{regex:"(Debian)-(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",other:!0},{regex:"(Linux Mint)(?:/(\\d+))?",other:!0},{regex:"(Mandriva)(?: Linux)?/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",other:!0},{regex:"(Symbian[Oo][Ss])/(\\d+)\\.(\\d+)",os_replacement:"Symbian OS"},{regex:"(Symbian/3).+NokiaBrowser/7\\.3",os_replacement:"Symbian^3 Anna"},{regex:"(Symbian/3).+NokiaBrowser/7\\.4",os_replacement:"Symbian^3 Belle"},{regex:"(Symbian/3)",os_replacement:"Symbian^3"},{regex:"(Series 60|SymbOS|S60)",os_replacement:"Symbian OS"},{regex:"(MeeGo)",other:!0},{regex:"Symbian [Oo][Ss]",os_replacement:"Symbian OS"},{regex:"(BB10);.+Version/(\\d+).(\\d+).(\\d+)",os_replacement:"BlackBerry OS",manufacturer:"RIM"},{regex:"(Black[Bb]erry)[0-9a-z]+/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"BlackBerry OS",manufacturer:"RIM"},{regex:"(Black[Bb]erry).+Version/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"BlackBerry OS",manufacturer:"RIM"},{regex:"(RIM Tablet OS) (\\d+)\\.(\\d+)\\.(\\d+)",os_replacement:"BlackBerry Tablet OS",tablet:!0,manufacturer:"RIM"},{regex:"(Play[Bb]ook)",os_replacement:"BlackBerry Tablet OS",tablet:!0,manufacturer:"RIM"},{regex:"(Black[Bb]erry)",os_replacement:"Blackberry OS",manufacturer:"RIM"},{regex:"(webOS|hpwOS)/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"webOS"},{regex:"(SUSE|Fedora|Red Hat|PCLinuxOS)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(SUSE|Fedora|Red Hat|Puppy|PCLinuxOS|CentOS)/(\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(Ubuntu|Kindle|Bada|Lubuntu|BackTrack|Red Hat|Slackware)/(\\d+)\\.(\\d+)"},{regex:"(Windows|OpenBSD|FreeBSD|NetBSD|Ubuntu|Kubuntu|Android|Arch Linux|CentOS|WeTab|Slackware)"},{regex:"(Linux|BSD)",other:!0}],mobile_os_families:["Windows Phone 6.5","Windows CE","Symbian OS"],device_parsers:[{regex:"HTC ([A-Z][a-z0-9]+) Build",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC ([A-Z][a-z0-9 ]+) \\d+\\.\\d+\\.\\d+\\.\\d+",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC_Touch_([A-Za-z0-9]+)",device_replacement:"HTC Touch ($1)",manufacturer:"HTC"},{regex:"USCCHTC(\\d+)",device_replacement:"HTC $1 (US Cellular)",manufacturer:"HTC"},{regex:"Sprint APA(9292)",device_replacement:"HTC $1 (Sprint)",manufacturer:"HTC"},{regex:"HTC ([A-Za-z0-9]+ [A-Z])",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC-([A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC_([A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC ([A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"(ADR[A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"(HTC)",manufacturer:"HTC"},{regex:"SonyEricsson([A-Za-z0-9]+)/",device_replacement:"Ericsson $1",other:!0,manufacturer:"Sony"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\; [A-Za-z]{2}\\-[A-Za-z]{2}\\; WOWMobile (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\.[\\d]+; [A-Za-z]{2}\\-[A-Za-z]{2}\\; (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\-update1\\; [A-Za-z]{2}\\-[A-Za-z]{2}\\; (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\; [A-Za-z]{2}\\-[A-Za-z]{2}\\; (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\.[\\d]+; (.+) Build"},{regex:"NokiaN([0-9]+)",device_replacement:"Nokia N$1",manufacturer:"Nokia"},{regex:"Nokia([A-Za-z0-9\\v-]+)",device_replacement:"Nokia $1",manufacturer:"Nokia"},{regex:"NOKIA ([A-Za-z0-9\\-]+)",device_replacement:"Nokia $1",manufacturer:"Nokia"},{regex:"Nokia ([A-Za-z0-9\\-]+)",device_replacement:"Nokia $1",manufacturer:"Nokia"},{regex:"Lumia ([A-Za-z0-9\\-]+)",device_replacement:"Lumia $1",manufacturer:"Nokia"},{regex:"Symbian",device_replacement:"Nokia",manufacturer:"Nokia"},{regex:"BB10; ([A-Za-z0-9- ]+)\\)",device_replacement:"BlackBerry $1",manufacturer:"RIM"},{regex:"(PlayBook).+RIM Tablet OS",device_replacement:"Blackberry Playbook",tablet:!0,manufacturer:"RIM"},{regex:"(Black[Bb]erry [0-9]+);",manufacturer:"RIM"},{regex:"Black[Bb]erry([0-9]+)",device_replacement:"BlackBerry $1",manufacturer:"RIM"},{regex:"(Pre)/(\\d+)\\.(\\d+)",device_replacement:"Palm Pre",manufacturer:"Palm"},{regex:"(Pixi)/(\\d+)\\.(\\d+)",device_replacement:"Palm Pixi",manufacturer:"Palm"},{regex:"(Touchpad)/(\\d+)\\.(\\d+)",device_replacement:"HP Touchpad",manufacturer:"HP"},{regex:"HPiPAQ([A-Za-z0-9]+)/(\\d+).(\\d+)",device_replacement:"HP iPAQ $1",manufacturer:"HP"},{regex:"Palm([A-Za-z0-9]+)",device_replacement:"Palm $1",manufacturer:"Palm"},{regex:"Treo([A-Za-z0-9]+)",device_replacement:"Palm Treo $1",manufacturer:"Palm"},{regex:"webOS.*(P160UNA)/(\\d+).(\\d+)",device_replacement:"HP Veer",manufacturer:"HP"},{regex:"(Kindle Fire)",manufacturer:"Amazon"},{regex:"(Kindle)",manufacturer:"Amazon"},{regex:"(Silk)/(\\d+)\\.(\\d+)(?:\\.([0-9\\-]+))?",device_replacement:"Kindle Fire",tablet:!0,manufacturer:"Amazon"},{regex:"(iPad) Simulator;",manufacturer:"Apple"},{regex:"(iPad);",manufacturer:"Apple"},{regex:"(iPod);",manufacturer:"Apple"},{regex:"(iPhone) Simulator;",manufacturer:"Apple"},{regex:"(iPhone);",manufacturer:"Apple"},{regex:"Nexus\\ ([A-Za-z0-9\\-]+)",device_replacement:"Nexus $1"},{regex:"acer_([A-Za-z0-9]+)_",device_replacement:"Acer $1",manufacturer:"Acer"},{regex:"acer_([A-Za-z0-9]+)_",device_replacement:"Acer $1",manufacturer:"Acer"},{regex:"Amoi\\-([A-Za-z0-9]+)",device_replacement:"Amoi $1",other:!0,manufacturer:"Amoi"},{regex:"AMOI\\-([A-Za-z0-9]+)",device_replacement:"Amoi $1",other:!0,manufacturer:"Amoi"},{regex:"Asus\\-([A-Za-z0-9]+)",device_replacement:"Asus $1",manufacturer:"Asus"},{regex:"ASUS\\-([A-Za-z0-9]+)",device_replacement:"Asus $1",manufacturer:"Asus"},{regex:"BIRD\\-([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"BIRD\\.([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"BIRD ([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"Dell ([A-Za-z0-9]+)",device_replacement:"Dell $1",manufacturer:"Dell"},{regex:"DoCoMo/2\\.0 ([A-Za-z0-9]+)",device_replacement:"DoCoMo $1",other:!0},{regex:"([A-Za-z0-9]+)\\_W\\;FOMA",device_replacement:"DoCoMo $1",other:!0},{regex:"([A-Za-z0-9]+)\\;FOMA",device_replacement:"DoCoMo $1",other:!0},{regex:"vodafone([A-Za-z0-9]+)",device_replacement:"Huawei Vodafone $1",other:!0},{regex:"i\\-mate ([A-Za-z0-9]+)",device_replacement:"i-mate $1",other:!0},{regex:"Kyocera\\-([A-Za-z0-9]+)",device_replacement:"Kyocera $1",other:!0},{regex:"KWC\\-([A-Za-z0-9]+)",device_replacement:"Kyocera $1",other:!0},{regex:"Lenovo\\-([A-Za-z0-9]+)",device_replacement:"Lenovo $1",manufacturer:"Lenovo"},{regex:"Lenovo\\_([A-Za-z0-9]+)",device_replacement:"Lenovo $1",manufacturer:"Levovo"},{regex:"LG/([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG-LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE-LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE VX([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG ([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE LG\\-AX([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG\\-([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE\\-([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"(KIN)\\.One (\\d+)\\.(\\d+)",device_replacement:"Microsoft $1"},{regex:"(KIN)\\.Two (\\d+)\\.(\\d+)",device_replacement:"Microsoft $1"},{regex:"(Motorola)\\-([A-Za-z0-9]+)",manufacturer:"Motorola"},{regex:"MOTO\\-([A-Za-z0-9]+)",device_replacement:"Motorola $1",manufacturer:"Motorola"},{regex:"MOT\\-([A-Za-z0-9]+)",device_replacement:"Motorola $1",manufacturer:"Motorola"},{regex:"Philips([A-Za-z0-9]+)",device_replacement:"Philips $1",manufacturer:"Philips"},{regex:"Philips ([A-Za-z0-9]+)",device_replacement:"Philips $1",manufacturer:"Philips"},{regex:"SAMSUNG-([A-Za-z0-9\\-]+)",device_replacement:"Samsung $1",manufacturer:"Samsung"},{regex:"SAMSUNG\\; ([A-Za-z0-9\\-]+)",device_replacement:"Samsung $1",manufacturer:"Samsung"},{regex:"Softbank/1\\.0/([A-Za-z0-9]+)",device_replacement:"Softbank $1",other:!0},{regex:"Softbank/2\\.0/([A-Za-z0-9]+)",device_replacement:"Softbank $1",other:!0},{regex:"(hiptop|avantgo|plucker|xiino|blazer|elaine|up.browser|up.link|mmp|smartphone|midp|wap|vodafone|o2|pocket|mobile|pda)",device_replacement:"Generic Smartphone"},{regex:"^(1207|3gso|4thp|501i|502i|503i|504i|505i|506i|6310|6590|770s|802s|a wa|acer|acs\\-|airn|alav|asus|attw|au\\-m|aur |aus |abac|acoo|aiko|alco|alca|amoi|anex|anny|anyw|aptu|arch|argo|bell|bird|bw\\-n|bw\\-u|beck|benq|bilb|blac|c55/|cdm\\-|chtm|capi|comp|cond|craw|dall|dbte|dc\\-s|dica|ds\\-d|ds12|dait|devi|dmob|doco|dopo|el49|erk0|esl8|ez40|ez60|ez70|ezos|ezze|elai|emul|eric|ezwa|fake|fly\\-|fly\\_|g\\-mo|g1 u|g560|gf\\-5|grun|gene|go.w|good|grad|hcit|hd\\-m|hd\\-p|hd\\-t|hei\\-|hp i|hpip|hs\\-c|htc |htc\\-|htca|htcg)",device_replacement:"Generic Feature Phone"},{regex:"^(htcp|htcs|htct|htc\\_|haie|hita|huaw|hutc|i\\-20|i\\-go|i\\-ma|i230|iac|iac\\-|iac/|ig01|im1k|inno|iris|jata|java|kddi|kgt|kgt/|kpt |kwc\\-|klon|lexi|lg g|lg\\-a|lg\\-b|lg\\-c|lg\\-d|lg\\-f|lg\\-g|lg\\-k|lg\\-l|lg\\-m|lg\\-o|lg\\-p|lg\\-s|lg\\-t|lg\\-u|lg\\-w|lg/k|lg/l|lg/u|lg50|lg54|lge\\-|lge/|lynx|leno|m1\\-w|m3ga|m50/|maui|mc01|mc21|mcca|medi|meri|mio8|mioa|mo01|mo02|mode|modo|mot |mot\\-|mt50|mtp1|mtv |mate|maxo|merc|mits|mobi|motv|mozz|n100|n101|n102|n202|n203|n300|n302|n500|n502|n505|n700|n701|n710|nec\\-|nem\\-|newg|neon)",device_replacement:"Generic Feature Phone"},{regex:"^(netf|noki|nzph|o2 x|o2\\-x|opwv|owg1|opti|oran|ot\\-s|p800|pand|pg\\-1|pg\\-2|pg\\-3|pg\\-6|pg\\-8|pg\\-c|pg13|phil|pn\\-2|pt\\-g|palm|pana|pire|pock|pose|psio|qa\\-a|qc\\-2|qc\\-3|qc\\-5|qc\\-7|qc07|qc12|qc21|qc32|qc60|qci\\-|qwap|qtek|r380|r600|raks|rim9|rove|s55/|sage|sams|sc01|sch\\-|scp\\-|sdk/|se47|sec\\-|sec0|sec1|semc|sgh\\-|shar|sie\\-|sk\\-0|sl45|slid|smb3|smt5|sp01|sph\\-|spv |spv\\-|sy01|samm|sany|sava|scoo|send|siem|smar|smit|soft|sony|t\\-mo|t218|t250|t600|t610|t618|tcl\\-|tdg\\-|telm|tim\\-|ts70|tsm\\-|tsm3|tsm5|tx\\-9|tagt)",device_replacement:"Generic Feature Phone"},{regex:"^(talk|teli|topl|tosh|up.b|upg1|utst|v400|v750|veri|vk\\-v|vk40|vk50|vk52|vk53|vm40|vx98|virg|vite|voda|vulc|w3c |w3c\\-|wapj|wapp|wapu|wapm|wig |wapi|wapr|wapv|wapy|wapa|waps|wapt|winc|winw|wonu|x700|xda2|xdag|yas\\-|your|zte\\-|zeto|aste|audi|avan|blaz|brew|brvw|bumb|ccwa|cell|cldc|cmd\\-|dang|eml2|fetc|hipt|http|ibro|idea|ikom|ipaq|jbro|jemu|jigs|keji|kyoc|kyok|libw|m\\-cr|midp|mmef|moto|mwbp|mywa|newt|nok6|o2im|pant|pdxg|play|pluc|port|prox|rozo|sama|seri|smal|symb|treo|upsi|vx52|vx53|vx60|vx61|vx70|vx80|vx81|vx83|vx85|wap\\-|webc|whit|wmlb|xda\\-|xda\\_)",device_replacement:"Generic Feature Phone"},{regex:"(bot|borg|google(^tv)|yahoo|slurp|msnbot|msrbot|openbot|archiver|netresearch|lycos|scooter|altavista|teoma|gigabot|baiduspider|blitzbot|oegp|charlotte|furlbot|http%20client|polybot|htdig|ichiro|mogimogi|larbin|pompos|scrubby|searchsight|seekbot|semanticdiscovery|silk|snappy|speedy|spider|voila|vortex|voyager|zao|zeal|fast\\-webcrawler|converacrawler|dataparksearch|findlinks)",device_replacement:"Spider"}],mobile_browser_families:["Firefox Mobile","Opera Mobile","Opera Mini","Mobile Safari","webOS","IE Mobile","Playstation Portable","Nokia","Blackberry","Palm","Silk","Android","Maemo","Obigo","Netfront","AvantGo","Teleca","SEMC-Browser","Bolt","Iris","UP.Browser","Symphony","Minimo","Bunjaloo","Jasmine","Dolfin","Polaris","BREW","Chrome Mobile","Chrome Mobile iOS","UC Browser","Tizen Browser"]};
b.parsers=["device_parsers","browser_parsers","os_parsers","mobile_os_families","mobile_browser_families"],b.types=["browser","os","device"],b.regexes=c||function(){var a={};return b.parsers.map(function(b){a[b]=[]}),a}(),b.families=function(){var a={};return b.types.map(function(b){a[b]=[]}),a}();var d=Array.prototype,e=(Object.prototype,Function.prototype,d.forEach),f=(d.indexOf,function(a,b){for(var c={},d=0;d<b.length&&!(c=b[d](a));d++);return c}),g=function(a,b){h(a,function(a){h(b,function(b){delete a[b]})})},h=forEach=function(a,b,c){if(null!=a)if(e&&a.forEach===e)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,f=a.length;f>d;d++)if(b.call(c,a[d],d,a)==={})return}else for(var g in a)if(_.has(a,g)&&b.call(c,a[g],g,a)==={})return},i=function(a){return!(!a||"undefined"==typeof a||null==a)},j=function(a){var b="";return a=a||{},i(a)&&i(a.major)&&(b+=a.major,i(a.minor)&&(b+="."+a.minor,i(a.patch)&&(b+="."+a.patch))),b},k=function(a){a=a||{};var b=j(a);return b&&(b=" "+b),a&&i(a.family)?a.family+b:""};return b.parse=function(c){{var d=function(a){return b.regexes[a+"_parsers"].map(function(b){function c(a){var c=a.match(d);if(!c)return null;var g={};return g.family=(e?e.replace("$1",c[1]):c[1])||"other",g.major=parseInt(f?f:c[2])||null,g.minor=c[3]?parseInt(c[3]):null,g.patch=c[4]?parseInt(c[4]):null,g.tablet=b.tablet,g.man=b.manufacturer||null,g}var d=new RegExp(b.regex),e=b[("browser"===a?"family":a)+"_replacement"],f=b.major_version_replacement;return c})},e=function(){},h=d("browser"),l=d("os"),m=d("device");a=new e}a.browser=f(c,h),i(a.browser)?(a.browser.name=k(a.browser),a.browser.version=j(a.browser)):a.browser={},a.os=f(c,l),i(a.os)?(a.os.name=k(a.os),a.os.version=j(a.os)):a.os={},a.device=f(c,m),i(a.device)?(a.device.name=k(a.device),a.device.version=j(a.device)):a.device={tablet:!1};{var n={};b.regexes.mobile_browser_families.map(function(a){n[a]=!0}),b.regexes.mobile_os_families.map(function(a){n[a]=!0})}return a.device.type="Spider"===a.browser.family?"Spider":a.browser.tablet||a.os.tablet||a.device.tablet?"Tablet":n.hasOwnProperty(a.browser.family)?"Mobile":"Desktop",a.device.manufacturer=a.browser.man||a.os.man||a.device.man||null,g([a.browser,a.os,a.device],["tablet","man"]),a},b}();"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=c),exports.detect=c):b.detect=c,"function"==typeof define&&define.amd&&define(function(){return c})}(window),function(a,b){"function"==typeof define&&define.amd?define(b):"undefined"!=typeof module&&module.exports?module.exports=b():a.Salsa20=b()}(this,function(){function a(a,b){this.rounds=20,this.sigmaWords=[1634760805,857760878,2036477234,1797285236],this.keyWords=[],this.nonceWords=[0,0],this.counterWords=[0,0],this.block=[],this.blockUsed=64,this.setKey(a),this.setNonce(b)}return a.prototype.setKey=function(a){for(var b=0,c=0;8>b;b++,c+=4)this.keyWords[b]=255&a[c]|(255&a[c+1])<<8|(255&a[c+2])<<16|(255&a[c+3])<<24;this._reset()},a.prototype.setNonce=function(a){this.nonceWords[0]=255&a[0]|(255&a[1])<<8|(255&a[2])<<16|(255&a[3])<<24,this.nonceWords[1]=255&a[4]|(255&a[5])<<8|(255&a[6])<<16|(255&a[7])<<24,this._reset()},a.prototype.getBytes=function(a){for(var b=new Array(a),c=0;a>c;c++)64==this.blockUsed&&(this._generateBlock(),this._incrementCounter(),this.blockUsed=0),b[c]=this.block[this.blockUsed],this.blockUsed++;return b},a.prototype.getHexString=function(a){for(var b=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],c=[],d=this.getBytes(a),e=0;e<d.length;e++)c.push(b[d[e]>>4&15]),c.push(b[15&d[e]]);return c.join("")},a.prototype._reset=function(){this.counterWords[0]=0,this.counterWords[1]=0,this.blockUsed=64},a.prototype._incrementCounter=function(){this.counterWords[0]=this.counterWords[0]+1&4294967295,0==this.counterWords[0]&&(this.counterWords[1]=this.counterWords[1]+1&4294967295)},a.prototype._generateBlock=function(){for(var a,b=this.sigmaWords[0],c=this.keyWords[0],d=this.keyWords[1],e=this.keyWords[2],f=this.keyWords[3],g=this.sigmaWords[1],h=this.nonceWords[0],i=this.nonceWords[1],j=this.counterWords[0],k=this.counterWords[1],l=this.sigmaWords[2],m=this.keyWords[4],n=this.keyWords[5],o=this.keyWords[6],p=this.keyWords[7],q=this.sigmaWords[3],r=b,s=c,t=d,u=e,v=f,w=g,x=h,y=i,z=j,A=k,B=l,C=m,D=n,E=o,F=p,G=q,H=0;H<this.rounds;H+=2)a=r+D,v^=a<<7|a>>>25,a=v+r,z^=a<<9|a>>>23,a=z+v,D^=a<<13|a>>>19,a=D+z,r^=a<<18|a>>>14,a=w+s,A^=a<<7|a>>>25,a=A+w,E^=a<<9|a>>>23,a=E+A,s^=a<<13|a>>>19,a=s+E,w^=a<<18|a>>>14,a=B+x,F^=a<<7|a>>>25,a=F+B,t^=a<<9|a>>>23,a=t+F,x^=a<<13|a>>>19,a=x+t,B^=a<<18|a>>>14,a=G+C,u^=a<<7|a>>>25,a=u+G,y^=a<<9|a>>>23,a=y+u,C^=a<<13|a>>>19,a=C+y,G^=a<<18|a>>>14,a=r+u,s^=a<<7|a>>>25,a=s+r,t^=a<<9|a>>>23,a=t+s,u^=a<<13|a>>>19,a=u+t,r^=a<<18|a>>>14,a=w+v,x^=a<<7|a>>>25,a=x+w,y^=a<<9|a>>>23,a=y+x,v^=a<<13|a>>>19,a=v+y,w^=a<<18|a>>>14,a=B+A,C^=a<<7|a>>>25,a=C+B,z^=a<<9|a>>>23,a=z+C,A^=a<<13|a>>>19,a=A+z,B^=a<<18|a>>>14,a=G+F,D^=a<<7|a>>>25,a=D+G,E^=a<<9|a>>>23,a=E+D,F^=a<<13|a>>>19,a=F+E,G^=a<<18|a>>>14;r+=b,s+=c,t+=d,u+=e,v+=f,w+=g,x+=h,y+=i,z+=j,A+=k,B+=l,C+=m,D+=n,E+=o,F+=p,G+=q,this.block[0]=r>>>0&255,this.block[1]=r>>>8&255,this.block[2]=r>>>16&255,this.block[3]=r>>>24&255,this.block[4]=s>>>0&255,this.block[5]=s>>>8&255,this.block[6]=s>>>16&255,this.block[7]=s>>>24&255,this.block[8]=t>>>0&255,this.block[9]=t>>>8&255,this.block[10]=t>>>16&255,this.block[11]=t>>>24&255,this.block[12]=u>>>0&255,this.block[13]=u>>>8&255,this.block[14]=u>>>16&255,this.block[15]=u>>>24&255,this.block[16]=v>>>0&255,this.block[17]=v>>>8&255,this.block[18]=v>>>16&255,this.block[19]=v>>>24&255,this.block[20]=w>>>0&255,this.block[21]=w>>>8&255,this.block[22]=w>>>16&255,this.block[23]=w>>>24&255,this.block[24]=x>>>0&255,this.block[25]=x>>>8&255,this.block[26]=x>>>16&255,this.block[27]=x>>>24&255,this.block[28]=y>>>0&255,this.block[29]=y>>>8&255,this.block[30]=y>>>16&255,this.block[31]=y>>>24&255,this.block[32]=z>>>0&255,this.block[33]=z>>>8&255,this.block[34]=z>>>16&255,this.block[35]=z>>>24&255,this.block[36]=A>>>0&255,this.block[37]=A>>>8&255,this.block[38]=A>>>16&255,this.block[39]=A>>>24&255,this.block[40]=B>>>0&255,this.block[41]=B>>>8&255,this.block[42]=B>>>16&255,this.block[43]=B>>>24&255,this.block[44]=C>>>0&255,this.block[45]=C>>>8&255,this.block[46]=C>>>16&255,this.block[47]=C>>>24&255,this.block[48]=D>>>0&255,this.block[49]=D>>>8&255,this.block[50]=D>>>16&255,this.block[51]=D>>>24&255,this.block[52]=E>>>0&255,this.block[53]=E>>>8&255,this.block[54]=E>>>16&255,this.block[55]=E>>>24&255,this.block[56]=F>>>0&255,this.block[57]=F>>>8&255,this.block[58]=F>>>16&255,this.block[59]=F>>>24&255,this.block[60]=G>>>0&255,this.block[61]=G>>>8&255,this.block[62]=G>>>16&255,this.block[63]=G>>>24&255},a}),function(a,b){var c,d;"function"==typeof define&&define.amd?define(["salsa20"],b.bind(a,a.crypto)):"undefined"!=typeof module&&module.exports?(c=require("./salsa20.js"),d=require("crypto"),module.exports=b(d,c)):a.BigInt=b(a.crypto,a.Salsa20)}(this,function(a,b){function c(a){var b,c,d,e;for(c=new Array(a),b=0;a>b;b++)c[b]=0;for(c[0]=2,d=0;c[d]<a;){for(b=c[d]*c[d];a>b;b+=c[d])c[b]=1;for(d++,c[d]=c[d-1]+1;c[d]<a&&c[c[d]];c[d]++);}for(e=new Array(d),b=0;d>b;b++)e[b]=c[b];return e}function d(a,b){return ub.length!=a.length&&(ub=I(a),vb=I(a),wb=I(a)),K(wb,b),e(a,wb)}function e(a,b){var c,d,e,f;if(ub.length!=a.length&&(ub=I(a),vb=I(a),wb=I(a)),J(wb,b),J(vb,a),J(ub,a),L(vb,-1),L(ub,-1),G(vb))return 0;for(e=0;0==vb[e];e++);for(c=1,d=2;vb[e]%d==0;d*=2,c++);if(f=e*eb+c-1,f&&M(vb,f),ab(wb,vb,a),!E(wb,1)&&!F(wb,ub)){for(d=1;f-1>=d&&!F(wb,ub);){if($(wb,a),E(wb,1))return 0;d++}if(!F(wb,ub))return 0}return 1}function f(a){var b,c,d;for(b=a.length-1;0==a[b]&&b>0;b--);for(c=0,d=a[b];d;d>>=1,c++);return c+=eb*b}function g(a,b){var c=C(0,(a.length>b?a.length:b)*eb,0);return J(c,a),c}function h(a){var b=C(0,a,0);return q(b,a),_(b,1)}function i(a,b){var c=I(a);return Y(c,b),_(c,1)}function j(a,b){var c=g(a,a.length+1);return L(c,b),_(c,1)}function k(a,b){var c=g(a,a.length+b.length);return X(c,b),_(c,1)}function l(a,b,c){var d=g(a,c.length);return ab(d,_(b,2),_(c,2),0),_(d,1)}function m(a,b){var c=g(a,a.length>b.length?a.length+1:b.length+1);return V(c,b),_(c,1)}function n(a,b){var c=g(a,a.length>b.length?a.length+1:b.length+1);return W(c,b),_(c,1)}function o(a,b){var c,d=g(a,b.length);return c=u(d,b),c?_(d,1):null}function p(a,b,c){var d=g(a,c.length);return Z(d,b,c),_(d,1)}function q(a,b){var e,g,h,i,j,k,l,m,n,o,p,r,u;if(0==Db.length&&(Db=c(3e4)),0==Eb.length)for(Eb=new Array(512),k=0;512>k;k++)Eb[k]=Math.pow(2,k/511-1);if(e=.1,h=20,u=20,Gb.length!=a.length&&(Gb=I(a),Hb=I(a),Kb=I(a),Mb=I(a),Pb=I(a),Qb=I(a),Rb=I(a),Ob=I(a),Nb=I(a),Fb=I(a),Ib=I(a),Jb=I(a),Lb=I(a),Sb=I(a)),u>=b){for(i=(1<<(b+2>>1))-1,K(a,0),j=1;j;)for(j=0,a[0]=1|1<<b-1|ib(b),k=1;k<Db.length&&(Db[k]&i)==Db[k];k++)if(0==a[0]%Db[k]){j=1;break}return void A(a)}if(m=e*b*b,b>2*h)for(l=1;h>=b-b*l;)l=Eb[ib(9)];else l=.5;for(r=Math.floor(l*b)+1,q(Jb,r),K(Gb,0),Gb[Math.floor((b-2)/eb)]|=1<<(b-2)%eb,z(Gb,Jb,Fb,Ib),o=f(Fb);;){for(;s(Hb,o,0),!y(Fb,Hb););for(L(Hb,1),W(Hb,Fb),J(Nb,Jb),X(Nb,Hb),P(Nb,2),L(Nb,1),J(Mb,Hb),P(Mb,2),n=0,k=0;k<Db.length&&Db[k]<m;k++)if(0==B(Nb,Db[k])&&!E(Nb,Db[k])){n=1;break}if(n||d(Nb,2)||(n=1),!n){for(L(Nb,-3),k=Nb.length-1;0==Nb[k]&&k>0;k--);for(p=0,g=Nb[k];g;g>>=1,p++);for(p+=eb*k;s(Lb,p,0),!y(Nb,Lb););if(L(Nb,3),L(Lb,2),J(Ob,Lb),J(Kb,Nb),L(Kb,-1),ab(Ob,Kb,Nb),L(Ob,-1),G(Ob)&&(J(Ob,Lb),ab(Ob,Mb,Nb),L(Ob,-1),J(Sb,Nb),J(Pb,Ob),t(Pb,Nb),E(Pb,1)))return void J(a,Sb)}}}function r(a,b){var c,d;return c=Math.floor((a-1)/eb)+2,d=C(0,0,c),s(d,a,b),d}function s(a,b,c){var d,e;for(d=0;d<a.length;d++)a[d]=0;for(e=Math.floor((b-1)/eb)+1,d=0;e>d;d++)a[d]=ib(eb);a[e-1]&=(2<<(b-1)%eb)-1,1==c&&(a[e-1]|=1<<(b-1)%eb)}function t(a,b){var c,d,e,f,g,h,i,j,k,l;for(sb.length!=a.length&&(sb=I(a)),k=1;k;){for(k=0,c=1;c<b.length;c++)if(b[c]){k=1;break}if(!k)break;for(c=a.length;!a[c]&&c>=0;c--);for(d=a[c],e=b[c],f=1,g=0,h=0,i=1;e+h&&e+i&&(j=Math.floor((d+f)/(e+h)),l=Math.floor((d+g)/(e+i)),j==l);)kb=f-j*h,f=h,h=kb,kb=g-j*i,g=i,i=kb,kb=d-j*e,d=e,e=kb;g?(J(sb,a),R(a,b,f,g),R(b,sb,i,h)):(Y(a,b),J(sb,a),J(a,b),J(b,sb))}if(0!=b[0])for(kb=B(a,b[0]),K(a,b[0]),b[0]=kb;b[0];)a[0]%=b[0],kb=a[0],a[0]=b[0],b[0]=kb}function u(a,b){var c=1+2*Math.max(a.length,b.length);if(!(1&a[0]||1&b[0]))return K(a,0),0;for(yb.length!=c&&(yb=new Array(c),xb=new Array(c),zb=new Array(c),Ab=new Array(c),Bb=new Array(c),Cb=new Array(c)),J(yb,a),J(xb,b),K(zb,1),K(Ab,0),K(Bb,0),K(Cb,1);;){for(;!(1&yb[0]);)N(yb),1&zb[0]||1&Ab[0]?(W(zb,b),N(zb),V(Ab,a),N(Ab)):(N(zb),N(Ab));for(;!(1&xb[0]);)N(xb),1&Bb[0]||1&Cb[0]?(W(Bb,b),N(Bb),V(Cb,a),N(Cb)):(N(Bb),N(Cb));if(y(xb,yb)?(V(xb,yb),V(Bb,zb),V(Cb,Ab)):(V(yb,xb),V(zb,Bb),V(Ab,Cb)),E(yb,0)){for(;w(Bb);)W(Bb,b);return J(a,Bb),E(xb,1)?1:(K(a,0),0)}}}function v(a,b){for(var c=1,d=0;;){if(1==a)return c;if(0==a)return 0;if(d-=c*Math.floor(b/a),b%=a,1==b)return d;if(0==b)return 0;c-=d*Math.floor(a/b),a%=b}}function w(a){return a[a.length-1]>>eb-1&1}function x(a,b,c){var d,e=a.length,f=b.length,g=f>e+c?e+c:f;for(d=f-1-c;e>d&&d>=0;d++)if(a[d]>0)return 1;for(d=e-1+c;f>d;d++)if(b[d]>0)return 0;for(d=g-1;d>=c;d--){if(a[d-c]>b[d])return 1;if(a[d-c]<b[d])return 0}return 0}function y(a,b){var c,d=a.length<b.length?a.length:b.length;for(c=a.length;c<b.length;c++)if(b[c])return 0;for(c=b.length;c<a.length;c++)if(a[c])return 1;for(c=d-1;c>=0;c--){if(a[c]>b[c])return 1;if(a[c]<b[c])return 0}return 0}function z(a,b,c,d){var e,f,g,h,i,j,k,l;for(J(d,a),f=b.length;0==b[f-1];f--);for(l=b[f-1],k=0;l;k++)l>>=1;for(k=eb-k,O(b,k),O(d,k),e=d.length;0==d[e-1]&&e>f;e--);for(K(c,0);!x(b,d,e-f);)U(d,b,e-f),c[e-f]++;for(g=e-1;g>=f;g--){for(c[g-f]=d[g]==b[f-1]?fb:Math.floor((d[g]*gb+d[g-1])/b[f-1]);i=(f>1?b[f-2]:0)*c[g-f],j=i>>eb,i&=fb,h=j+c[g-f]*b[f-1],j=h>>eb,h&=fb,j==d[g]?h==d[g-1]?i>(g>1?d[g-2]:0):h>d[g-1]:j>d[g];)c[g-f]--;S(d,b,-c[g-f],g-f),w(d)&&(T(d,b,g-f),c[g-f]--)}M(b,k),M(d,k)}function A(a){var b,c,d,e;for(c=a.length,d=0,b=0;c>b;b++)d+=a[b],e=0,0>d&&(e=-(d>>eb),d+=e*gb),a[b]=d&fb,d=(d>>eb)-e}function B(a,b){var c,d=0;for(c=a.length-1;c>=0;c--)d=(d*gb+a[c])%b;return d}function C(a,b,c){var d,e;return d=Math.ceil(b/eb)+1,d=c>d?c:d,e=new Array(d),K(e,a),e}function D(a,b,c){var d,e,f,g,h,i=a.length;if(-1==b){for(f=new Array(0);;){for(g=new Array(f.length+1),e=0;e<f.length;e++)g[e+1]=f[e];if(g[0]=parseInt(a,10),f=g,d=a.indexOf(",",0),1>d)break;if(a=a.substring(d+1),0==a.length)break}return f.length<c?(g=new Array(c),J(g,f),g):f}for(var j=b,k=0,l=1==b?i:0;j>1;)1&j&&(k=1),l+=i,j>>=1;for(l+=k*i,f=C(0,l,0),e=0;i>e&&(d=hb.indexOf(a.substring(e,e+1),0),36>=b&&d>=36&&(d-=26),!(d>=b||0>d));e++)P(f,b),L(f,d);for(i=f.length;i>0&&!f[i-1];i--);for(i=c>i+1?c:i+1,g=new Array(i),h=i<f.length?i:f.length,e=0;h>e;e++)g[e]=f[e];for(;i>e;e++)g[e]=0;return g}function E(a,b){var c;if(a[0]!=b)return 0;for(c=1;c<a.length;c++)if(a[c])return 0;return 1}function F(a,b){var c,d=a.length<b.length?a.length:b.length;for(c=0;d>c;c++)if(a[c]!=b[c])return 0;if(a.length>b.length){for(;c<a.length;c++)if(a[c])return 0}else for(;c<b.length;c++)if(b[c])return 0;return 1}function G(a){var b;for(b=0;b<a.length;b++)if(a[b])return 0;return 1}function H(a,b){var c,d,e="";if(qb.length!=a.length?qb=I(a):J(qb,a),-1==b){for(c=a.length-1;c>0;c--)e+=a[c]+",";e+=a[0]}else for(;!G(qb);)d=Q(qb,b),e=hb.substring(d,d+1)+e;return 0==e.length&&(e="0"),e}function I(a){var b;return b=new Array(a.length),J(b,a),b}function J(a,b){var c,d=a.length<b.length?a.length:b.length;for(c=0;d>c;c++)a[c]=b[c];for(c=d;c<a.length;c++)a[c]=0}function K(a,b){var c,d;for(d=b,c=0;c<a.length;c++)a[c]=d&fb,d>>=eb}function L(a,b){var c,d,e,f;for(a[0]+=b,d=a.length,e=0,c=0;d>c;c++)if(e+=a[c],f=0,0>e&&(f=-(e>>eb),e+=f*gb),a[c]=e&fb,e=(e>>eb)-f,!e)return}function M(a,b){var c,d=Math.floor(b/eb);if(d){for(c=0;c<a.length-d;c++)a[c]=a[c+d];for(;c<a.length;c++)a[c]=0;b%=eb}for(c=0;c<a.length-1;c++)a[c]=fb&(a[c+1]<<eb-b|a[c]>>b);a[c]>>=b}function N(a){var b;for(b=0;b<a.length-1;b++)a[b]=fb&(a[b+1]<<eb-1|a[b]>>1);a[b]=a[b]>>1|a[b]&gb>>1}function O(a,b){var c,d=Math.floor(b/eb);if(d){for(c=a.length;c>=d;c--)a[c]=a[c-d];for(;c>=0;c--)a[c]=0;b%=eb}if(b){for(c=a.length-1;c>0;c--)a[c]=fb&(a[c]<<b|a[c-1]>>eb-b);a[c]=fb&a[c]<<b}}function P(a,b){var c,d,e,f;if(b)for(d=a.length,e=0,c=0;d>c;c++)e+=a[c]*b,f=0,0>e&&(f=-(e>>eb),e+=f*gb),a[c]=e&fb,e=(e>>eb)-f}function Q(a,b){var c,d,e=0;for(c=a.length-1;c>=0;c--)d=e*gb+a[c],a[c]=Math.floor(d/b),e=d%b;return e}function R(a,b,c,d){var e,f,g,h;for(g=a.length<b.length?a.length:b.length,h=a.length,f=0,e=0;g>e;e++)f+=c*a[e]+d*b[e],a[e]=f&fb,f>>=eb;for(e=g;h>e;e++)f+=c*a[e],a[e]=f&fb,f>>=eb}function S(a,b,c,d){var e,f,g,h;for(g=a.length<d+b.length?a.length:d+b.length,h=a.length,f=0,e=d;g>e;e++)f+=a[e]+c*b[e-d],a[e]=f&fb,f>>=eb;for(e=g;f&&h>e;e++)f+=a[e],a[e]=f&fb,f>>=eb}function T(a,b,c){var d,e,f,g;for(f=a.length<c+b.length?a.length:c+b.length,g=a.length,e=0,d=c;f>d;d++)e+=a[d]+b[d-c],a[d]=e&fb,e>>=eb;for(d=f;e&&g>d;d++)e+=a[d],a[d]=e&fb,e>>=eb}function U(a,b,c){var d,e,f,g;for(f=a.length<c+b.length?a.length:c+b.length,g=a.length,e=0,d=c;f>d;d++)e+=a[d]-b[d-c],a[d]=e&fb,e>>=eb;for(d=f;e&&g>d;d++)e+=a[d],a[d]=e&fb,e>>=eb}function V(a,b){var c,d,e;for(e=a.length<b.length?a.length:b.length,d=0,c=0;e>c;c++)d+=a[c]-b[c],a[c]=d&fb,d>>=eb;for(c=e;d&&c<a.length;c++)d+=a[c],a[c]=d&fb,d>>=eb}function W(a,b){var c,d,e;for(e=a.length<b.length?a.length:b.length,d=0,c=0;e>c;c++)d+=a[c]+b[c],a[c]=d&fb,d>>=eb;for(c=e;d&&c<a.length;c++)d+=a[c],a[c]=d&fb,d>>=eb}function X(a,b){var c;for(lb.length!=2*a.length&&(lb=new Array(2*a.length)),K(lb,0),c=0;c<b.length;c++)b[c]&&S(lb,a,b[c],c);J(a,lb)}function Y(a,b){ob.length!=a.length?ob=I(a):J(ob,a),pb.length!=a.length&&(pb=I(a)),z(ob,b,pb,a)}function Z(a,b,c){var d;for(mb.length!=2*a.length&&(mb=new Array(2*a.length)),K(mb,0),d=0;d<b.length;d++)b[d]&&S(mb,a,b[d],d);Y(mb,c),J(a,mb)}function $(a,b){var c,d,e,f,g;for(f=a.length;f>0&&!a[f-1];f--);for(g=f>b.length?2*f:2*b.length,mb.length!=g&&(mb=new Array(g)),K(mb,0),c=0;f>c;c++){for(e=mb[2*c]+a[c]*a[c],mb[2*c]=e&fb,e>>=eb,d=c+1;f>d;d++)e=mb[c+d]+2*a[c]*a[d]+e,mb[c+d]=e&fb,e>>=eb;mb[c+f]=e}Y(mb,b),J(a,mb)}function _(a,b){var c,d;for(c=a.length;c>0&&!a[c-1];c--);return d=new Array(c+b),J(d,a),d}function ab(a,b,c){var d,e,f,g;if(rb.length!=c.length&&(rb=I(c)),0!=(1&c[0])){for(K(rb,0),f=c.length;f>0&&!c[f-1];f--);for(g=gb-v(B(c,gb),gb),rb[f]=1,Z(a,rb,c),nb.length!=a.length?nb=I(a):J(nb,a),d=b.length-1;d>0&!b[d];d--);if(0==b[d])return void K(a,1);for(e=1<<eb-1;e&&!(b[d]&e);e>>=1);for(;;){if(!(e>>=1)){if(d--,0>d)return void bb(a,jb,c,g);e=1<<eb-1}bb(a,a,c,g),e&b[d]&&bb(a,nb,c,g)}}else for(J(rb,a),K(a,1);!E(b,0);)1&b[0]&&Z(a,rb,c),Q(b,2),$(rb,c)}function bb(a,b,c,d){var e,f,g,h,i,j,k=c.length,l=b.length;for(tb.length!=k&&(tb=new Array(k)),K(tb,0);k>0&&0==c[k-1];k--);for(;l>0&&0==b[l-1];l--);for(j=tb.length-1,e=0;k>e;e++){for(i=tb[0]+a[e]*b[0],h=(i&fb)*d&fb,g=i+h*c[0]>>eb,i=a[e],f=1;l-4>f;)g+=tb[f]+h*c[f]+i*b[f],tb[f-1]=g&fb,g>>=eb,f++,g+=tb[f]+h*c[f]+i*b[f],tb[f-1]=g&fb,g>>=eb,f++,g+=tb[f]+h*c[f]+i*b[f],tb[f-1]=g&fb,g>>=eb,f++,g+=tb[f]+h*c[f]+i*b[f],tb[f-1]=g&fb,g>>=eb,f++,g+=tb[f]+h*c[f]+i*b[f],tb[f-1]=g&fb,g>>=eb,f++;for(;l>f;)g+=tb[f]+h*c[f]+i*b[f],tb[f-1]=g&fb,g>>=eb,f++;for(;k-4>f;)g+=tb[f]+h*c[f],tb[f-1]=g&fb,g>>=eb,f++,g+=tb[f]+h*c[f],tb[f-1]=g&fb,g>>=eb,f++,g+=tb[f]+h*c[f],tb[f-1]=g&fb,g>>=eb,f++,g+=tb[f]+h*c[f],tb[f-1]=g&fb,g>>=eb,f++,g+=tb[f]+h*c[f],tb[f-1]=g&fb,g>>=eb,f++;for(;k>f;)g+=tb[f]+h*c[f],tb[f-1]=g&fb,g>>=eb,f++;for(;j>f;)g+=tb[f],tb[f-1]=g&fb,g>>=eb,f++;tb[f-1]=g&fb}y(c,tb)||V(tb,c),J(a,tb)}function cb(a){function c(){for(var a=e.getBytes(g),b=0,c=0;g>b;b++)c=c*f+a[b];return c}function d(){return e.getBytes(1)[0]}var e=new b([a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15],a[16],a[17],a[18],a[19],a[20],a[21],a[22],a[23],a[24],a[25],a[26],a[27],a[28],a[29],a[30],a[31]],[a[32],a[33],a[34],a[35],a[36],a[37],a[38],a[39]]),f=256,g=6,h=Math.pow(2,52),i=2*h;return ib=function(a){if(a>31)throw new Error("Too many bits.");var b=0,c=0,e=Math.floor(a/8),f=(1<<a%8)-1;for(f&&(c=d()&f);e>b;b++)c=256*c+d();return c},function(){for(var a=c(),b=Math.pow(f,g),e=0;h>a;)a=(a+e)*f,b*=f,e=d();for(;a>=i;)a/=2,b/=2,e>>>=1;return(a+e)/b}}function db(){var b;if("undefined"!=typeof a&&"function"==typeof a.randomBytes)try{b=a.randomBytes(40)}catch(c){throw c}else{if("undefined"==typeof a||"function"!=typeof a.getRandomValues)throw new Error("Keys should not be generated without CSPRNG.");b=new Uint8Array(40),a.getRandomValues(b)}return Array.prototype.slice.call(b,0)}var eb=0,fb=0,gb=fb+1,hb="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_=!@#$%^&*()[]{}|;:,.<>/?`~ \\'\"+-";for(eb=0;1<<eb+1>1<<eb;eb++);eb>>=1,fb=(1<<eb)-1,gb=fb+1;var ib,jb=C(1,1,1),kb=new Array(0),lb=kb,mb=kb,nb=kb,ob=kb,pb=kb,qb=kb,rb=kb,sb=kb,tb=kb,ub=kb,vb=kb,wb=kb,xb=kb,yb=kb,zb=kb,Ab=kb,Bb=kb,Cb=kb,Db=kb,Eb=kb,Fb=kb,Gb=kb,Hb=kb,Ib=kb,Jb=kb,Kb=kb,Lb=kb,Mb=kb,Nb=kb,Ob=kb,Pb=kb,Qb=kb,Rb=kb,Sb=kb,Tb={str2bigInt:D,bigInt2str:H,int2bigInt:C,multMod:p,powMod:l,inverseMod:o,randBigInt:r,randBigInt_:s,equals:F,equalsInt:E,sub:m,mod:i,mod_:Y,modInt:B,mult:k,divInt_:Q,rightShift_:M,leftShift_:O,dup:I,greater:y,add:n,addInt:j,addInt_:L,isZero:G,bitSize:f,randTruePrime:h,millerRabin:e,divide_:z,trim:_,expand:g,bpe:eb,primes:Db,findPrimes:c,getSeed:db};return function Ub(){Math.random=cb(db()),"function"==typeof setTimeout&&"undefined"!=typeof document&&setTimeout(Ub,3e5)}(),Tb});var CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=d.Base=function(){function a(){}return{extend:function(b){a.prototype=this;var c=new a;return b&&c.mixIn(b),c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=d.WordArray=e.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes,e=a.sigBytes;if(this.clamp(),d%4)for(var f=0;e>f;f++){var g=c[f>>>2]>>>24-f%4*8&255;b[d+f>>>2]|=g<<24-(d+f)%4*8}else if(c.length>65535)for(var f=0;e>f;f+=4)b[d+f>>>2]=c[f>>>2];else b.push.apply(b,c);return this.sigBytes+=e,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-c%4*8,b.length=a.ceil(c/4)},clone:function(){var a=e.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new f.init(c,b)}}),g=c.enc={},h=g.Hex={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;c>e;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push((f>>>4).toString(16)),d.push((15&f).toString(16))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new f.init(c,b/2)}},i=g.Latin1={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;c>e;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push(String.fromCharCode(f))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new f.init(c,b)}},j=g.Utf8={stringify:function(a){try{return decodeURIComponent(escape(i.stringify(a)))}catch(b){throw new Error("Malformed UTF-8 data")}},parse:function(a){return i.parse(unescape(encodeURIComponent(a)))}},k=d.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=j.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,g=this.blockSize,h=4*g,i=e/h;i=b?a.ceil(i):a.max((0|i)-this._minBufferSize,0);var j=i*g,k=a.min(4*j,e);if(j){for(var l=0;j>l;l+=g)this._doProcessBlock(d,l);var m=d.splice(0,j);c.sigBytes-=k}return new f.init(m,k)},clone:function(){var a=e.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0}),l=(d.Hasher=k.extend({cfg:e.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){k.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){a&&this._append(a);var b=this._doFinalize();return b},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new l.HMAC.init(a,c).finalize(b)}}}),c.algo={});return c}(Math);!function(){{var a=CryptoJS,b=a.lib,c=b.WordArray,d=a.enc;d.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp();for(var e=[],f=0;c>f;f+=3)for(var g=b[f>>>2]>>>24-f%4*8&255,h=b[f+1>>>2]>>>24-(f+1)%4*8&255,i=b[f+2>>>2]>>>24-(f+2)%4*8&255,j=g<<16|h<<8|i,k=0;4>k&&c>f+.75*k;k++)e.push(d.charAt(j>>>6*(3-k)&63));var l=d.charAt(64);if(l)for(;e.length%4;)e.push(l);return e.join("")},parse:function(a){var b=a.length,d=this._map,e=d.charAt(64);if(e){var f=a.indexOf(e);-1!=f&&(b=f)}for(var g=[],h=0,i=0;b>i;i++)if(i%4){var j=d.indexOf(a.charAt(i-1))<<i%4*2,k=d.indexOf(a.charAt(i))>>>6-i%4*2;g[h>>>2]|=(j|k)<<24-h%4*8,h++}return c.create(g,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}}(),function(a){function b(a,b,c,d,e,f,g){var h=a+(b&c|~b&d)+e+g;return(h<<f|h>>>32-f)+b}function c(a,b,c,d,e,f,g){var h=a+(b&d|c&~d)+e+g;return(h<<f|h>>>32-f)+b}function d(a,b,c,d,e,f,g){var h=a+(b^c^d)+e+g;return(h<<f|h>>>32-f)+b}function e(a,b,c,d,e,f,g){var h=a+(c^(b|~d))+e+g;return(h<<f|h>>>32-f)+b}var f=CryptoJS,g=f.lib,h=g.WordArray,i=g.Hasher,j=f.algo,k=[];!function(){for(var b=0;64>b;b++)k[b]=4294967296*a.abs(a.sin(b+1))|0}();var l=j.MD5=i.extend({_doReset:function(){this._hash=new h.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,f){for(var g=0;16>g;g++){var h=f+g,i=a[h];a[h]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var j=this._hash.words,l=a[f+0],m=a[f+1],n=a[f+2],o=a[f+3],p=a[f+4],q=a[f+5],r=a[f+6],s=a[f+7],t=a[f+8],u=a[f+9],v=a[f+10],w=a[f+11],x=a[f+12],y=a[f+13],z=a[f+14],A=a[f+15],B=j[0],C=j[1],D=j[2],E=j[3];B=b(B,C,D,E,l,7,k[0]),E=b(E,B,C,D,m,12,k[1]),D=b(D,E,B,C,n,17,k[2]),C=b(C,D,E,B,o,22,k[3]),B=b(B,C,D,E,p,7,k[4]),E=b(E,B,C,D,q,12,k[5]),D=b(D,E,B,C,r,17,k[6]),C=b(C,D,E,B,s,22,k[7]),B=b(B,C,D,E,t,7,k[8]),E=b(E,B,C,D,u,12,k[9]),D=b(D,E,B,C,v,17,k[10]),C=b(C,D,E,B,w,22,k[11]),B=b(B,C,D,E,x,7,k[12]),E=b(E,B,C,D,y,12,k[13]),D=b(D,E,B,C,z,17,k[14]),C=b(C,D,E,B,A,22,k[15]),B=c(B,C,D,E,m,5,k[16]),E=c(E,B,C,D,r,9,k[17]),D=c(D,E,B,C,w,14,k[18]),C=c(C,D,E,B,l,20,k[19]),B=c(B,C,D,E,q,5,k[20]),E=c(E,B,C,D,v,9,k[21]),D=c(D,E,B,C,A,14,k[22]),C=c(C,D,E,B,p,20,k[23]),B=c(B,C,D,E,u,5,k[24]),E=c(E,B,C,D,z,9,k[25]),D=c(D,E,B,C,o,14,k[26]),C=c(C,D,E,B,t,20,k[27]),B=c(B,C,D,E,y,5,k[28]),E=c(E,B,C,D,n,9,k[29]),D=c(D,E,B,C,s,14,k[30]),C=c(C,D,E,B,x,20,k[31]),B=d(B,C,D,E,q,4,k[32]),E=d(E,B,C,D,t,11,k[33]),D=d(D,E,B,C,w,16,k[34]),C=d(C,D,E,B,z,23,k[35]),B=d(B,C,D,E,m,4,k[36]),E=d(E,B,C,D,p,11,k[37]),D=d(D,E,B,C,s,16,k[38]),C=d(C,D,E,B,v,23,k[39]),B=d(B,C,D,E,y,4,k[40]),E=d(E,B,C,D,l,11,k[41]),D=d(D,E,B,C,o,16,k[42]),C=d(C,D,E,B,r,23,k[43]),B=d(B,C,D,E,u,4,k[44]),E=d(E,B,C,D,x,11,k[45]),D=d(D,E,B,C,A,16,k[46]),C=d(C,D,E,B,n,23,k[47]),B=e(B,C,D,E,l,6,k[48]),E=e(E,B,C,D,s,10,k[49]),D=e(D,E,B,C,z,15,k[50]),C=e(C,D,E,B,q,21,k[51]),B=e(B,C,D,E,x,6,k[52]),E=e(E,B,C,D,o,10,k[53]),D=e(D,E,B,C,v,15,k[54]),C=e(C,D,E,B,m,21,k[55]),B=e(B,C,D,E,t,6,k[56]),E=e(E,B,C,D,A,10,k[57]),D=e(D,E,B,C,r,15,k[58]),C=e(C,D,E,B,y,21,k[59]),B=e(B,C,D,E,p,6,k[60]),E=e(E,B,C,D,w,10,k[61]),D=e(D,E,B,C,n,15,k[62]),C=e(C,D,E,B,u,21,k[63]),j[0]=j[0]+B|0,j[1]=j[1]+C|0,j[2]=j[2]+D|0,j[3]=j[3]+E|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/4294967296),g=d;c[(e+64>>>9<<4)+15]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c[(e+64>>>9<<4)+14]=16711935&(g<<8|g>>>24)|4278255360&(g<<24|g>>>8),b.sigBytes=4*(c.length+1),this._process();for(var h=this._hash,i=h.words,j=0;4>j;j++){var k=i[j];i[j]=16711935&(k<<8|k>>>24)|4278255360&(k<<24|k>>>8)}return h},clone:function(){var a=i.clone.call(this);return a._hash=this._hash.clone(),a}});f.MD5=i._createHelper(l),f.HmacMD5=i._createHmacHelper(l)}(Math),function(){var a=CryptoJS,b=a.lib,c=b.Base,d=b.WordArray,e=a.algo,f=e.MD5,g=e.EvpKDF=c.extend({cfg:c.extend({keySize:4,hasher:f,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,e=c.hasher.create(),f=d.create(),g=f.words,h=c.keySize,i=c.iterations;g.length<h;){j&&e.update(j);var j=e.update(a).finalize(b);e.reset();for(var k=1;i>k;k++)j=e.finalize(j),e.reset();f.concat(j)}return f.sigBytes=4*h,f}});a.EvpKDF=function(a,b,c){return g.create(c).compute(a,b)}}(),CryptoJS.lib.Cipher||function(a){var b=CryptoJS,c=b.lib,d=c.Base,e=c.WordArray,f=c.BufferedBlockAlgorithm,g=b.enc,h=(g.Utf8,g.Base64),i=b.algo,j=i.EvpKDF,k=c.Cipher=f.extend({cfg:d.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){f.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){a&&this._append(a);var b=this._doFinalize();return b},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function a(a){return"string"==typeof a?w:t}return function(b){return{encrypt:function(c,d,e){return a(d).encrypt(b,c,d,e)},decrypt:function(c,d,e){return a(d).decrypt(b,c,d,e)}}}}()}),l=(c.StreamCipher=k.extend({_doFinalize:function(){var a=this._process(!0);return a},blockSize:1}),b.mode={}),m=c.BlockCipherMode=d.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}}),n=l.CBC=function(){function b(b,c,d){var e=this._iv;if(e){var f=e;this._iv=a}else var f=this._prevBlock;for(var g=0;d>g;g++)b[c+g]^=f[g]}var c=m.extend();return c.Encryptor=c.extend({processBlock:function(a,c){var d=this._cipher,e=d.blockSize;b.call(this,a,c,e),d.encryptBlock(a,c),this._prevBlock=a.slice(c,c+e)}}),c.Decryptor=c.extend({processBlock:function(a,c){var d=this._cipher,e=d.blockSize,f=a.slice(c,c+e);d.decryptBlock(a,c),b.call(this,a,c,e),this._prevBlock=f}}),c}(),o=b.pad={},p=o.Pkcs7={pad:function(a,b){for(var c=4*b,d=c-a.sigBytes%c,f=d<<24|d<<16|d<<8|d,g=[],h=0;d>h;h+=4)g.push(f);var i=e.create(g,d);a.concat(i)},unpad:function(a){var b=255&a.words[a.sigBytes-1>>>2];a.sigBytes-=b}},q=(c.BlockCipher=k.extend({cfg:k.cfg.extend({mode:n,padding:p}),reset:function(){k.reset.call(this);var a=this.cfg,b=a.iv,c=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var d=c.createEncryptor;else{var d=c.createDecryptor;this._minBufferSize=1}this._mode=d.call(c,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else{var b=this._process(!0);a.unpad(b)}return b},blockSize:4}),c.CipherParams=d.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}})),r=b.format={},s=r.OpenSSL={stringify:function(a){var b=a.ciphertext,c=a.salt;if(c)var d=e.create([1398893684,1701076831]).concat(c).concat(b);else var d=b;return d.toString(h)},parse:function(a){var b=h.parse(a),c=b.words;if(1398893684==c[0]&&1701076831==c[1]){var d=e.create(c.slice(2,4));c.splice(0,4),b.sigBytes-=16}return q.create({ciphertext:b,salt:d})}},t=c.SerializableCipher=d.extend({cfg:d.extend({format:s}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d),f=e.finalize(b),g=e.cfg;return q.create({ciphertext:f,key:c,iv:g.iv,algorithm:a,mode:g.mode,padding:g.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){d=this.cfg.extend(d),b=this._parse(b,d.format);var e=a.createDecryptor(c,d).finalize(b.ciphertext);return e},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),u=b.kdf={},v=u.OpenSSL={execute:function(a,b,c,d){d||(d=e.random(8));var f=j.create({keySize:b+c}).compute(a,d),g=e.create(f.words.slice(b),4*c);return f.sigBytes=4*b,q.create({key:f,iv:g,salt:d})}},w=c.PasswordBasedCipher=t.extend({cfg:t.cfg.extend({kdf:v}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=d.kdf.execute(c,a.keySize,a.ivSize);d.iv=e.iv;var f=t.encrypt.call(this,a,b,e.key,d);return f.mixIn(e),f},decrypt:function(a,b,c,d){d=this.cfg.extend(d),b=this._parse(b,d.format);var e=d.kdf.execute(c,a.keySize,a.ivSize,b.salt);d.iv=e.iv;var f=t.decrypt.call(this,a,b,e.key,d);return f}})}(),function(){var a=CryptoJS,b=a.lib,c=b.BlockCipher,d=a.algo,e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[];!function(){for(var a=[],b=0;256>b;b++)a[b]=128>b?b<<1:b<<1^283;for(var c=0,d=0,b=0;256>b;b++){var o=d^d<<1^d<<2^d<<3^d<<4;o=o>>>8^255&o^99,e[c]=o,f[o]=c;var p=a[c],q=a[p],r=a[q],s=257*a[o]^16843008*o;g[c]=s<<24|s>>>8,h[c]=s<<16|s>>>16,i[c]=s<<8|s>>>24,j[c]=s;var s=16843009*r^65537*q^257*p^16843008*c;k[o]=s<<24|s>>>8,l[o]=s<<16|s>>>16,m[o]=s<<8|s>>>24,n[o]=s,c?(c=p^a[a[a[r^p]]],d^=a[a[d]]):c=d=1}}();var o=[0,1,2,4,8,16,32,64,128,27,54],p=d.AES=c.extend({_doReset:function(){for(var a=this._key,b=a.words,c=a.sigBytes/4,d=this._nRounds=c+6,f=4*(d+1),g=this._keySchedule=[],h=0;f>h;h++)if(c>h)g[h]=b[h];else{var i=g[h-1];h%c?c>6&&h%c==4&&(i=e[i>>>24]<<24|e[i>>>16&255]<<16|e[i>>>8&255]<<8|e[255&i]):(i=i<<8|i>>>24,i=e[i>>>24]<<24|e[i>>>16&255]<<16|e[i>>>8&255]<<8|e[255&i],i^=o[h/c|0]<<24),g[h]=g[h-c]^i}for(var j=this._invKeySchedule=[],p=0;f>p;p++){var h=f-p;if(p%4)var i=g[h];else var i=g[h-4];j[p]=4>p||4>=h?i:k[e[i>>>24]]^l[e[i>>>16&255]]^m[e[i>>>8&255]]^n[e[255&i]]
}},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,g,h,i,j,e)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this._doCryptBlock(a,b,this._invKeySchedule,k,l,m,n,f);var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c},_doCryptBlock:function(a,b,c,d,e,f,g,h){for(var i=this._nRounds,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[2],m=a[b+3]^c[3],n=4,o=1;i>o;o++){var p=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],q=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],r=d[l>>>24]^e[m>>>16&255]^f[j>>>8&255]^g[255&k]^c[n++],s=d[m>>>24]^e[j>>>16&255]^f[k>>>8&255]^g[255&l]^c[n++];j=p,k=q,l=r,m=s}var p=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],q=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],r=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],s=(h[m>>>24]<<24|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++];a[b]=p,a[b+1]=q,a[b+2]=r,a[b+3]=s},keySize:8});a.AES=c._createHelper(p)}(),function(){var a=CryptoJS,b=a.lib,c=b.WordArray,d=b.Hasher,e=a.algo,f=[],g=e.SHA1=d.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],g=c[2],h=c[3],i=c[4],j=0;80>j;j++){if(16>j)f[j]=0|a[b+j];else{var k=f[j-3]^f[j-8]^f[j-14]^f[j-16];f[j]=k<<1|k>>>31}var l=(d<<5|d>>>27)+i+f[j];l+=20>j?(e&g|~e&h)+1518500249:40>j?(e^g^h)+1859775393:60>j?(e&g|e&h|g&h)-1894007588:(e^g^h)-899497514,i=h,h=g,g=e<<30|e>>>2,e=d,d=l}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+g|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296),b[(d+64>>>9<<4)+15]=c,a.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var a=d.clone.call(this);return a._hash=this._hash.clone(),a}});a.SHA1=d._createHelper(g),a.HmacSHA1=d._createHmacHelper(g)}(),function(a){var b=CryptoJS,c=b.lib,d=c.WordArray,e=c.Hasher,f=b.algo,g=[],h=[];!function(){function b(b){for(var c=a.sqrt(b),d=2;c>=d;d++)if(!(b%d))return!1;return!0}function c(a){return 4294967296*(a-(0|a))|0}for(var d=2,e=0;64>e;)b(d)&&(8>e&&(g[e]=c(a.pow(d,.5))),h[e]=c(a.pow(d,1/3)),e++),d++}();var i=[],j=f.SHA256=e.extend({_doReset:function(){this._hash=new d.init(g.slice(0))},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],g=c[3],j=c[4],k=c[5],l=c[6],m=c[7],n=0;64>n;n++){if(16>n)i[n]=0|a[b+n];else{var o=i[n-15],p=(o<<25|o>>>7)^(o<<14|o>>>18)^o>>>3,q=i[n-2],r=(q<<15|q>>>17)^(q<<13|q>>>19)^q>>>10;i[n]=p+i[n-7]+r+i[n-16]}var s=j&k^~j&l,t=d&e^d&f^e&f,u=(d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22),v=(j<<26|j>>>6)^(j<<21|j>>>11)^(j<<7|j>>>25),w=m+v+s+h[n]+i[n],x=u+t;m=l,l=k,k=j,j=g+w|0,g=f,f=e,e=d,d=w+x|0}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+g|0,c[4]=c[4]+j|0,c[5]=c[5]+k|0,c[6]=c[6]+l|0,c[7]=c[7]+m|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;return c[e>>>5]|=128<<24-e%32,c[(e+64>>>9<<4)+14]=a.floor(d/4294967296),c[(e+64>>>9<<4)+15]=d,b.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var a=e.clone.call(this);return a._hash=this._hash.clone(),a}});b.SHA256=e._createHelper(j),b.HmacSHA256=e._createHmacHelper(j)}(Math),function(){{var a=CryptoJS,b=a.lib,c=b.Base,d=a.enc,e=d.Utf8,f=a.algo;f.HMAC=c.extend({init:function(a,b){a=this._hasher=new a.init,"string"==typeof b&&(b=e.parse(b));var c=a.blockSize,d=4*c;b.sigBytes>d&&(b=a.finalize(b)),b.clamp();for(var f=this._oKey=b.clone(),g=this._iKey=b.clone(),h=f.words,i=g.words,j=0;c>j;j++)h[j]^=1549556828,i[j]^=909522486;f.sigBytes=g.sigBytes=d,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var b=this._hasher,c=b.finalize(a);b.reset();var d=b.finalize(this._oKey.clone().concat(c));return d}})}}(),CryptoJS.pad.NoPadding={pad:function(){},unpad:function(){}},CryptoJS.mode.CTR=function(){var a=CryptoJS.lib.BlockCipherMode.extend(),b=a.Encryptor=a.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=this._iv,f=this._counter;e&&(f=this._counter=e.slice(0),this._iv=void 0);var g=f.slice(0);c.encryptBlock(g,0),f[d-1]=f[d-1]+1|0;for(var h=0;d>h;h++)a[b+h]^=g[h]}});return a.Decryptor=b,a}(),function(){"use strict";function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype;d.getListeners=function(a){var b,c,d=this._getEvents();if("object"==typeof a){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&-1===b(e[d],c)&&e[d].push(f?c:{listener:c,once:!1});return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=b(f[e],c),-1!==d&&f[e].splice(d,1));return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if("object"===c)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},d._getEvents=function(){return this._events||(this._events={})},"function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof module&&module.exports?module.exports=a:this.EventEmitter=a}.call(this),function(a,b){"function"==typeof define&&define.amd?define(["bigint","crypto","eventemitter"],function(a,c,d){var e={BigInt:a,CryptoJS:c,EventEmitter:d,OTR:{},DSA:{}};return b.call(e)}):(a.OTR={},a.DSA={},b.call(a))}(this,function(){return function(){"use strict";var a=this,b={N:"FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA237327FFFFFFFFFFFFFFFF",G:"2",MSGSTATE_PLAINTEXT:0,MSGSTATE_ENCRYPTED:1,MSGSTATE_FINISHED:2,AUTHSTATE_NONE:0,AUTHSTATE_AWAITING_DHKEY:1,AUTHSTATE_AWAITING_REVEALSIG:2,AUTHSTATE_AWAITING_SIG:3,WHITESPACE_TAG:" 	  				 	 	 	  ",WHITESPACE_TAG_V2:"  		  	 ",WHITESPACE_TAG_V3:"  		  		",OTR_TAG:"?OTR",OTR_VERSION_1:"\x00",OTR_VERSION_2:"\x00",OTR_VERSION_3:"\x00",SMPSTATE_EXPECT0:0,SMPSTATE_EXPECT1:1,SMPSTATE_EXPECT2:2,SMPSTATE_EXPECT3:3,SMPSTATE_EXPECT4:4,STATUS_SEND_QUERY:0,STATUS_AKE_INIT:1,STATUS_AKE_SUCCESS:2,STATUS_END_OTR:3};"undefined"!=typeof module&&module.exports?module.exports=b:a.OTR.CONST=b}.call(this),function(){"use strict";var a,b,c=this,d={};"undefined"!=typeof module&&module.exports?(module.exports=d={},a=require("../vendor/crypto.js"),b=require("../vendor/bigint.js")):(c.OTR&&(c.OTR.HLP=d),c.DSA&&(c.DSA.HLP=d),a=c.CryptoJS,b=c.BigInt);var e={BYTE:1,SHORT:2,INT:4,CTR:8,MAC:20,SIG:40},f="?OTR",g=".";d.debug=function(a){this.debug&&"function"!=typeof this.debug&&"undefined"!=typeof console&&console.log(a)},d.extend=function(a,b){function c(){this.constructor=a}for(var d in b)Object.hasOwnProperty.call(b,d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype},d.compare=function(a,b){if(a.length!==b.length)return!1;for(var c=0,d=0;c<a.length;c++)d|=a[c].charCodeAt(0)^b[c].charCodeAt(0);return 0===d},d.divMod=function(a,c,d){return b.multMod(a,b.inverseMod(c,d),d)},d.subMod=function(a,c,d){return a=b.mod(a,d),c=b.mod(c,d),b.greater(c,a)&&(a=b.add(a,d)),b.sub(a,c)},d.randomExponent=function(){return b.randBigInt(1536)},d.smpHash=function(b,c,f){var g=a.algo.SHA256.create();g.update(a.enc.Latin1.parse(d.packBytes(b,e.BYTE))),g.update(a.enc.Latin1.parse(d.packMPI(c))),f&&g.update(a.enc.Latin1.parse(d.packMPI(f)));var h=g.finalize();return d.bits2bigInt(h.toString(a.enc.Latin1))},d.makeMac=function(b,c){var e=a.enc.Latin1.parse(c),f=a.HmacSHA256(a.enc.Latin1.parse(b),e);return d.mask(f.toString(a.enc.Latin1),0,160)},d.make1Mac=function(b,c){var d=a.enc.Latin1.parse(c),e=a.HmacSHA1(a.enc.Latin1.parse(b),d);return e.toString(a.enc.Latin1)},d.encryptAes=function(b,c,d){var e={mode:a.mode.CTR,iv:a.enc.Latin1.parse(d),padding:a.pad.NoPadding},f=a.AES.encrypt(b,a.enc.Latin1.parse(c),e),g=a.enc.Base64.parse(f.toString());return a.enc.Latin1.stringify(g)},d.decryptAes=function(b,c,d){b=a.enc.Latin1.parse(b);var e={mode:a.mode.CTR,iv:a.enc.Latin1.parse(d),padding:a.pad.NoPadding};return a.AES.decrypt(a.enc.Base64.stringify(b),a.enc.Latin1.parse(c),e)},d.multPowMod=function(a,c,d,e,f){return b.multMod(b.powMod(a,c,f),b.powMod(d,e,f),f)},d.ZKP=function(a,c,e,f){return b.equals(c,d.smpHash(a,e,f))},d.GTOE=function(a,c){return b.equals(a,c)||b.greater(a,c)},d.between=function(a,c,d){return b.greater(a,c)&&b.greater(d,a)},d.checkGroup=function(a,c){var e=b.str2bigInt("2",10),f=b.sub(c,e);return d.GTOE(a,e)&&d.GTOE(f,a)};var h={XOR:function(a,b){return a^b},OR:function(a,b){return a|b},AND:function(a,b){return a&b}};d.bigBitWise=function(a,c,d){for(var e=c.length>d.length,f=e?d:c,g=e?c:d,i=g.length,j=b.expand(f,i),k=0;i>k;k++)j[k]=h[a](j[k],g[k]);return j},d.h1=function(b,c){var d=a.algo.SHA1.create();return d.update(a.enc.Latin1.parse(b)),d.update(a.enc.Latin1.parse(c)),d.finalize().toString(a.enc.Latin1)},d.h2=function(b,c){var d=a.algo.SHA256.create();return d.update(a.enc.Latin1.parse(b)),d.update(a.enc.Latin1.parse(c)),d.finalize().toString(a.enc.Latin1)},d.mask=function(a,b,c){return a.substr(b/8,c/8)},d.twotothe=function(a){for(var c=[1<<a%b.bpe,0],d=0,e=Math.floor(a/b.bpe);e>d;d++)c.unshift(0);return c},d.packBytes=function(a,b){a=a.toString(16);for(var c,d="";b>0;b--)c=a.length?a.substr(-2,2):"0",a=a.substr(0,a.length-2),d=l(parseInt(c,16))+d;return d},d.packINT=function(a){return d.packBytes(a,e.INT)},d.packCtr=function(a){return d.padCtr(d.packBytes(a,e.CTR))},d.padCtr=function(a){return a+"\x00\x00\x00\x00\x00\x00\x00\x00"},d.unpackCtr=function(a){return a=d.toByteArray(a.substring(0,8)),d.unpack(a)},d.unpack=function(a){a.reverse();for(var b=0,c=0,d=a.length;d>c;c++)b+=Math.pow(256,c)*a[c];return b},d.packData=function(a){return d.packINT(a.length)+a},d.bigInt2bits=function(a,c){c||(c=0),a=b.dup(a);for(var d="";!b.isZero(a);)d=k[255&a[0]]+d,b.rightShift_(a,8);for(;d.length<c;)d="\x00"+d;return d},d.bits2bigInt=function(a){return a=d.toByteArray(a),d.retMPI(a)},d.packMPI=function(a){return d.packData(d.bigInt2bits(b.trim(a,0)))},d.packSHORT=function(a){return d.packBytes(a,e.SHORT)},d.unpackSHORT=function(a){return a=d.toByteArray(a),d.unpack(a)},d.packTLV=function(a,b){return d.packSHORT(a)+d.packSHORT(b.length)+b},d.readLen=function(a){return a=d.toByteArray(a.substring(0,4)),d.unpack(a)},d.readData=function(a){var b=d.unpack(a.splice(0,4));return[b,a]},d.retMPI=function(a){var c=b.str2bigInt("0",10,a.length);return a.forEach(function(a,d){d&&b.leftShift_(c,8),c[0]|=a}),c},d.readMPI=function(a){return a=d.toByteArray(a),a=d.readData(a),d.retMPI(a[1])},d.packMPIs=function(a){return a.reduce(function(a,b){return a+d.packMPI(b)},"")},d.unpackMPIs=function(a,b){for(var c=0,e=[];a>c;c++)e.push("MPI");return d.splitype(e,b).map(function(a){return d.readMPI(a)})},d.wrapMsg=function(b,c,e,h,i){b=a.enc.Base64.stringify(a.enc.Latin1.parse(b)),b=f+":"+b+g;var j;if(e&&(j="|",j+=d.readLen(h).toString(16),j+="|",j+=d.readLen(i).toString(16)),!c)return[null,b];var k=Math.ceil(b.length/c);if(k>65535)return["Too many fragments"];if(1==k)return[null,b];var l,m,n,o,p,q=[];for(l=1;k>=l;l++)m=(l-1)*c,n=l*c,o=b.slice(m,n),p=f,e&&(p+=j),p+=","+l+",",p+=k+",",p+=o+",",q.push(p);return[null,q]},d.splitype=function n(a,b){var c=[];return a.forEach(function(a){var f;switch(a){case"PUBKEY":f=n(["SHORT","MPI","MPI","MPI","MPI"],b).join("");break;case"DATA":case"MPI":f=b.substring(0,d.readLen(b)+4);break;default:f=b.substring(0,e[a])}c.push(f),b=b.substring(f.length)}),c};for(var i,j={},k={},l=String.fromCharCode,m=0;256>m;++m)i=l(m),j[i]=m,k[m]=i;for(m=128;256>m;++m)j[l(63232+m)]=m;d.toByteArray=function(a){var b,c,d=[],e=j,f=a.split(""),g=-1;for(c=f.length,b=c%8;b--;)++g,d[g]=e[f[g]];for(b=c>>3;b--;)d.push(e[f[++g]],e[f[++g]],e[f[++g]],e[f[++g]],e[f[++g]],e[f[++g]],e[f[++g]],e[f[++g]]);return d}}.call(this),function(){"use strict";function a(){var a=(new Date).getTime();return function(b){if(p&&"undefined"!=typeof console){var c=(new Date).getTime();console.log(b+": "+(c-a)),a=c}}}function b(a,c){var d=i.randBigInt(i.bitSize(c));return j.between(d,a,c)?d:b(a,c)}function c(a,b){var c,d=3e4,e=i.bitSize(a),f=i.primes;for(0===f.length&&(f=i.findPrimes(d)),q.length!=a.length&&(q=i.dup(a)),c=0;c<f.length&&f[c]<=d;c++)if(0===i.modInt(a,f[c])&&!i.equalsInt(a,f[c]))return 0;for(c=0;b>c;c++){for(i.randBigInt_(q,e,0);!i.greater(a,q);)i.randBigInt_(q,e,0);if(!i.millerRabin(a,q))return 0}return 1}function d(b){for(var d,e,f,g,h=a(),k=r[b].repeat,l=r[b].N,o=j.twotothe(b-1),p=4*b,q=!1;;)if(d=i.randBigInt(l,1),d[0]|=1,c(d,k)){for(h("q"),g=0;p>g;g++)if(e=i.randBigInt(b,1),e[0]|=1,f=i.mod(e,d),f=i.sub(f,m),e=i.sub(e,f),!i.greater(o,e)&&c(e,k)){h("p"),s[b]={p:e,q:d},q=!0;break}if(q)break}for(var t,u=i.dup(n),v=i.sub(e,m),w=i.multMod(v,i.inverseMod(d,e),e);;){t=i.powMod(u,w,e);{if(!i.equals(t,m))return s[b].g=t,void h("g");u=i.add(u,m)}}throw new Error("Unreachable!")}function e(a,c){if(!(this instanceof e))return new e(a,c);if(c=c||{},a){var f=this;return["p","q","g","y","x"].forEach(function(b){f[b]=a[b]}),void(this.type=a.type||o)}var g=parseInt(c.bit_length?c.bit_length:1024,10);if(!r[g])throw new Error("Unsupported bit length.");s[g]||d(g),this.p=s[g].p,this.q=s[g].q,this.g=s[g].g,this.type=o,this.x=b(l,this.q),this.y=i.powMod(this.g,this.x,this.p),c.nocache&&(s[g]=null)}function f(a){var b,c;if(b=a.indexOf("("),c=a.lastIndexOf(")"),0>b||0>c)throw new Error("Malformed S-Expression");a=a.substring(b+1,c);var d=a.search(/\s/),e={type:a.substring(0,d),val:[]};if(a=a.substring(d+1,c),b=a.indexOf("("),0>b)e.val.push(a);else for(var g,h,i,j;b>-1;){for(g=b+1,h=a.length,i=1,j=0;h>g&&i>j;g++)"("===a[g]&&i++,")"===a[g]&&j++;e.val.push(f(a.substring(b,++g))),a=a.substring(++g),b=a.indexOf("(")}return e}function g(a){if(!a.type)throw new Error("Parse error.");var b,c;return"privkeys"===a.type?(b=[],a.val.forEach(function(a){b.push(g(a))}),b):(b={},a.val.forEach(function(a){c=a.val[0],"string"==typeof c?0===c.indexOf("#")&&(c=c.substring(1,c.lastIndexOf("#")),c=i.str2bigInt(c,16)):c=g(a),b[a.type]=c}),b)}var h,i,j,k=this;"undefined"!=typeof module&&module.exports?(module.exports=e,h=require("../vendor/crypto.js"),i=require("../vendor/bigint.js"),j=require("./helpers.js")):(Object.keys(k.DSA).forEach(function(a){e[a]=k.DSA[a]}),k.DSA=e,h=k.CryptoJS,i=k.BigInt,j=e.HLP);var l=i.str2bigInt("0",10),m=i.str2bigInt("1",10),n=i.str2bigInt("2",10),o="\x00\x00",p=!1,q=[],r={1024:{N:160,repeat:40},2048:{N:224,repeat:56}},s={};e.prototype={constructor:e,packPublic:function(){var a=this.type;return a+=j.packMPI(this.p),a+=j.packMPI(this.q),a+=j.packMPI(this.g),a+=j.packMPI(this.y)},packPrivate:function(){var a=this.packPublic()+j.packMPI(this.x);return a=h.enc.Latin1.parse(a),a.toString(h.enc.Base64)},generateNonce:function(a){var b=j.bigInt2bits(i.trim(this.x,0)),c=j.bigInt2bits(i.randBigInt(256)),d=h.algo.SHA256.create();d.update(h.enc.Latin1.parse(b)),d.update(a),d.update(h.enc.Latin1.parse(c));var e=d.finalize();return e=j.bits2bigInt(e.toString(h.enc.Latin1)),i.rightShift_(e,256-i.bitSize(this.q)),j.between(e,l,this.q)?e:this.generateNonce(a)},sign:function(a){a=h.enc.Latin1.parse(a);for(var b,c=i.str2bigInt(a.toString(h.enc.Hex),16),d=l,e=l;i.isZero(e)||i.isZero(d);)b=this.generateNonce(a),d=i.mod(i.powMod(this.g,b,this.p),this.q),i.isZero(d)||(e=i.inverseMod(b,this.q),e=i.mult(e,i.add(c,i.mult(this.x,d))),e=i.mod(e,this.q));return[d,e]},fingerprint:function(){var a=this.packPublic();return this.type===o&&(a=a.substring(2)),a=h.enc.Latin1.parse(a),h.SHA1(a).toString(h.enc.Hex)}},e.parsePublic=function(a,b){var c=["SHORT","MPI","MPI","MPI","MPI"];b&&c.push("MPI"),a=j.splitype(c,a);var d={type:a[0],p:j.readMPI(a[1]),q:j.readMPI(a[2]),g:j.readMPI(a[3]),y:j.readMPI(a[4])};return b&&(d.x=j.readMPI(a[5])),new e(d)},e.parsePrivate=function(a,b){return b?g(f(a))[0]["private-key"].dsa:(a=h.enc.Base64.parse(a),a=a.toString(h.enc.Latin1),e.parsePublic(a,!0))},e.verify=function(a,b,c,d){if(!j.between(c,l,a.q)||!j.between(d,l,a.q))return!1;var e=h.enc.Latin1.parse(b);e=i.str2bigInt(e.toString(h.enc.Hex),16);var f=i.inverseMod(d,a.q),g=i.multMod(e,f,a.q),k=i.multMod(c,f,a.q);g=i.powMod(a.g,g,a.p),k=i.powMod(a.y,k,a.p);var m=i.mod(i.multMod(g,k,a.p),a.q);return i.equals(m,c)}}.call(this),function(){"use strict";var a,b,c,d=this,e={};"undefined"!=typeof module&&module.exports?(module.exports=e,a=require("../vendor/crypto.js"),b=require("./const.js"),c=require("./helpers.js")):(d.OTR.Parse=e,a=d.CryptoJS,b=d.OTR.CONST,c=d.OTR.HLP);var f={};f[b.WHITESPACE_TAG_V2]=b.OTR_VERSION_2,f[b.WHITESPACE_TAG_V3]=b.OTR_VERSION_3,e.parseMsg=function(d,e){var g=[],h=e.indexOf(b.OTR_TAG);if(!~h){if(this.initFragment(d),k=e.indexOf(b.WHITESPACE_TAG),~k){e=e.split(""),e.splice(k,16);for(var i,j=e.length;j>k;)i=e.slice(k,k+8).join(""),Object.hasOwnProperty.call(f,i)?(e.splice(k,8),g.push(f[i])):k+=8;e=e.join("")}return{msg:e,ver:g}}var k=h+b.OTR_TAG.length,l=e[k];if(","===l||"|"===l)return this.msgFragment(d,e.substring(k+1),"|"===l);if(this.initFragment(d),~["?","v"].indexOf(l)){"?"===e[k]&&(g.push(b.OTR_VERSION_1),k+=1);var m={2:b.OTR_VERSION_2,3:b.OTR_VERSION_3},n=e.substring(k+1),o=n.indexOf("?");return o>=1&&(n=n.substring(0,o).split(""),"v"===e[k]&&n.forEach(function(a){Object.hasOwnProperty.call(m,a)&&g.push(m[a])})),{cls:"query",ver:g}}if(":"===l){k+=1;var p=e.substring(k,k+4);if(p.length<4)return{msg:e};p=a.enc.Base64.parse(p).toString(a.enc.Latin1);var q=p.substring(0,2),r=p.substring(2);if(!d["ALLOW_V"+c.unpackSHORT(q)])return{msg:e};k+=4;var s=e.substring(k).indexOf(".");if(!~s)return{msg:e};e=a.enc.Base64.parse(e.substring(k,k+s)),e=a.enc.Latin1.stringify(e);var t;q===b.OTR_VERSION_3&&(t=e.substring(0,8),e=e.substring(8));var u;return~["","\n","",""].indexOf(r)?u="ake":""===r&&(u="data"),{version:q,type:r,msg:e,cls:u,instance_tags:t}}return" Error:"===e.substring(k,k+7)?(d.ERROR_START_AKE&&d.sendQueryMsg(),{msg:e.substring(k+7),cls:"error"}):{msg:e}},e.initFragment=function(a){a.fragment={s:"",j:0,k:0}},e.msgFragment=function(a,b,d){if(b=b.split(","),d){var e=b.shift().split("|"),f=c.packINT(parseInt(e[0],16)),g=c.packINT(parseInt(e[1],16));if(a.checkInstanceTags(f+g))return}if(!(b.length<4||isNaN(parseInt(b[0],10))||isNaN(parseInt(b[1],10)))){var h=parseInt(b[0],10),i=parseInt(b[1],10);return b=b[2],h>i||0===i||0===h?void this.initFragment(a):(1===h?(this.initFragment(a),a.fragment={k:1,n:i,s:b}):i===a.fragment.n&&h===a.fragment.k+1?(a.fragment.s+=b,a.fragment.k+=1):this.initFragment(a),i===h?(b=a.fragment.s,this.initFragment(a),this.parseMsg(a,b)):void 0)}}}.call(this),function(){"use strict";function a(a,b,d,e,g){var h=c.enc.Latin1.parse(g),i=c.algo.HMAC.create(c.algo.SHA256,h);return i.update(c.enc.Latin1.parse(f.packMPI(a))),i.update(c.enc.Latin1.parse(f.packMPI(b))),i.update(c.enc.Latin1.parse(d)),i.update(c.enc.Latin1.parse(e)),i.finalize().toString(c.enc.Latin1)}function b(a){if(!(this instanceof b))return new b(a);this.otr=a,this.our_dh=a.our_old_dh,this.our_keyid=a.our_keyid-1,this.their_y=null,this.their_keyid=null,this.their_priv_pk=null,this.ssid=null,this.transmittedRS=!1,this.r=null,this.priv=a.priv;var c=this;["sendMsg"].forEach(function(a){c[a]=c[a].bind(c)})}var c,d,e,f,g,h=this;"undefined"!=typeof module&&module.exports?(module.exports=b,c=require("../vendor/crypto.js"),d=require("../vendor/bigint.js"),e=require("./const.js"),f=require("./helpers.js"),g=require("./dsa.js")):(h.OTR.AKE=b,c=h.CryptoJS,d=h.BigInt,e=h.OTR.CONST,f=h.OTR.HLP,g=h.DSA);var i=d.str2bigInt(e.N,16);b.prototype={constructor:b,createKeys:function(a){var b=d.powMod(a,this.our_dh.privateKey,i),c=f.packMPI(b);this.ssid=f.mask(f.h2("\x00",c),0,64);var e=f.h2("",c);this.c=f.mask(e,0,128),this.c_prime=f.mask(e,128,128),this.m1=f.h2("",c),this.m2=f.h2("",c),this.m1_prime=f.h2("",c),this.m2_prime=f.h2("",c)},verifySignMac:function(b,d,e,h,i,j,k,l){var m=f.makeMac(d,e);if(!f.compare(b,m))return["MACs do not match."];var n=f.decryptAes(d.substring(4),h,l);n=f.splitype(["PUBKEY","INT","SIG"],n.toString(c.enc.Latin1));var o=a(i,j,n[0],n[1],k),p=g.parsePublic(n[0]),q=f.bits2bigInt(n[2].substring(0,20)),r=f.bits2bigInt(n[2].substring(20));return g.verify(p,o,q,r)?[null,f.readLen(n[1]),p]:["Cannot verify signature of m."]},makeM:function(b,d,e,g){var h=this.priv.packPublic(),i=f.packINT(this.our_keyid),j=a(this.our_dh.publicKey,b,h,i,d);j=this.priv.sign(j);var k=h+i;k+=f.bigInt2bits(j[0],20),k+=f.bigInt2bits(j[1],20),k=c.enc.Latin1.parse(k);var l=f.packData(f.encryptAes(k,e,f.packCtr(0))),m=f.makeMac(l,g);return l+m},akeSuccess:function(a){return f.debug.call(this.otr,"success"),d.equals(this.their_y,this.our_dh.publicKey)?this.otr.error("equal keys - we have a problem.",!0):(this.their_keyid!==this.otr.their_keyid&&this.their_keyid!==this.otr.their_keyid-1&&(this.otr.our_old_dh=this.our_dh,this.otr.their_y=this.their_y,this.otr.their_old_y=null,this.otr.their_keyid=this.their_keyid,this.otr.their_priv_pk=this.their_priv_pk,this.otr.sessKeys[0]=[new this.otr.DHSession(this.otr.our_dh,this.otr.their_y),null],this.otr.sessKeys[1]=[new this.otr.DHSession(this.otr.our_old_dh,this.otr.their_y),null]),this.otr.ssid=this.ssid,this.otr.transmittedRS=this.transmittedRS,this.otr_version=a,this.otr.authstate=e.AUTHSTATE_NONE,this.otr.msgstate=e.MSGSTATE_ENCRYPTED,this.r=null,this.myhashed=null,this.dhcommit=null,this.encrypted=null,this.hashed=null,this.otr.trigger("status",[e.STATUS_AKE_SUCCESS]),void this.otr.sendStored())},handleAKE:function(a){var b,g,h,j=a.version;switch(a.type){case"":if(f.debug.call(this.otr,"d-h key message"),a=f.splitype(["DATA","DATA"],a.msg),this.otr.authstate===e.AUTHSTATE_AWAITING_DHKEY){var k=f.readMPI(this.myhashed),l=f.readMPI(a[1]);if(d.greater(k,l)){h="",b=this.dhcommit;break}this.our_dh=this.otr.dh(),this.otr.authstate=e.AUTHSTATE_NONE,this.r=null,this.myhashed=null}else this.otr.authstate===e.AUTHSTATE_AWAITING_SIG&&(this.our_dh=this.otr.dh());this.otr.authstate=e.AUTHSTATE_AWAITING_REVEALSIG,this.encrypted=a[0].substring(4),this.hashed=a[1].substring(4),h="\n",b=f.packMPI(this.our_dh.publicKey);break;case"\n":if(f.debug.call(this.otr,"reveal signature message"),a=f.splitype(["MPI"],a.msg),this.otr.authstate!==e.AUTHSTATE_AWAITING_DHKEY){if(this.otr.authstate!==e.AUTHSTATE_AWAITING_SIG)return;if(!d.equals(this.their_y,f.readMPI(a[0])))return}if(this.otr.authstate=e.AUTHSTATE_AWAITING_SIG,this.their_y=f.readMPI(a[0]),!f.checkGroup(this.their_y,i))return this.otr.error("Illegal g^y.",!0);this.createKeys(this.their_y),h="",b=f.packMPI(this.r),b+=this.makeM(this.their_y,this.m1,this.c,this.m2),this.m1=null,this.m2=null,this.c=null;break;case"":if(f.debug.call(this.otr,"signature message"),this.otr.authstate!==e.AUTHSTATE_AWAITING_REVEALSIG)return;a=f.splitype(["DATA","DATA","MAC"],a.msg),this.r=f.readMPI(a[0]);var m=c.enc.Hex.parse(d.bigInt2str(this.r,16));m=c.enc.Latin1.stringify(m);var n=f.decryptAes(this.encrypted,m,f.packCtr(0));n=n.toString(c.enc.Latin1),this.their_y=f.readMPI(n);var o=c.SHA256(c.enc.Latin1.parse(n));return f.compare(this.hashed,o.toString(c.enc.Latin1))?f.checkGroup(this.their_y,i)?(this.createKeys(this.their_y),g=this.verifySignMac(a[2],a[1],this.m2,this.c,this.their_y,this.our_dh.publicKey,this.m1,f.packCtr(0)),g[0]?this.otr.error(g[0],!0):(this.their_keyid=g[1],this.their_priv_pk=g[2],b=this.makeM(this.their_y,this.m1_prime,this.c_prime,this.m2_prime),this.m1=null,this.m2=null,this.m1_prime=null,this.m2_prime=null,this.c=null,this.c_prime=null,this.sendMsg(j,"",b),void this.akeSuccess(j))):this.otr.error("Illegal g^x.",!0):this.otr.error("Hashed g^x does not match.",!0);case"":if(f.debug.call(this.otr,"data message"),this.otr.authstate!==e.AUTHSTATE_AWAITING_SIG)return;return a=f.splitype(["DATA","MAC"],a.msg),g=this.verifySignMac(a[1],a[0],this.m2_prime,this.c_prime,this.their_y,this.our_dh.publicKey,this.m1_prime,f.packCtr(0)),g[0]?this.otr.error(g[0],!0):(this.their_keyid=g[1],this.their_priv_pk=g[2],this.m1_prime=null,this.m2_prime=null,this.c_prime=null,this.transmittedRS=!0,void this.akeSuccess(j));default:return}this.sendMsg(j,h,b)},sendMsg:function(a,b,c){var d=a+b,g=a===e.OTR_VERSION_3;return g&&(f.debug.call(this.otr,"instance tags"),d+=this.otr.our_instance_tag,d+=this.otr.their_instance_tag),d+=c,d=f.wrapMsg(d,this.otr.fragment_size,g,this.otr.our_instance_tag,this.otr.their_instance_tag),d[0]?this.otr.error(d[0]):void this.otr._sendMsg(d[1],!0)},initiateAKE:function(a){f.debug.call(this.otr,"d-h commit message"),this.otr.trigger("status",[e.STATUS_AKE_INIT]),this.otr.authstate=e.AUTHSTATE_AWAITING_DHKEY;var b=f.packMPI(this.our_dh.publicKey);b=c.enc.Latin1.parse(b),this.r=d.randBigInt(128);var g=c.enc.Hex.parse(d.bigInt2str(this.r,16));g=c.enc.Latin1.stringify(g),this.myhashed=c.SHA256(b),this.myhashed=f.packData(this.myhashed.toString(c.enc.Latin1)),this.dhcommit=f.packData(f.encryptAes(b,g,f.packCtr(0))),this.dhcommit+=this.myhashed,this.sendMsg(a,"",this.dhcommit)}}}.call(this),function(){"use strict";function a(b){return this instanceof a?(this.version=1,this.our_fp=b.our_fp,this.their_fp=b.their_fp,this.ssid=b.ssid,this.debug=!!b.debug,void this.init()):new a(b)}var b,c,d,e,f,g=this;"undefined"!=typeof module&&module.exports?(module.exports=a,b=require("../vendor/crypto.js"),c=require("../vendor/bigint.js"),d=require("../vendor/eventemitter.js"),e=require("./const.js"),f=require("./helpers.js")):(g.OTR.SM=a,b=g.CryptoJS,c=g.BigInt,d=g.EventEmitter,e=g.OTR.CONST,f=g.OTR.HLP);var h=c.str2bigInt(e.G,10),i=c.str2bigInt(e.N,16),j=c.sub(i,c.str2bigInt("1",10));c.divInt_(j,2),f.extend(a,d),a.prototype.init=function(){this.smpstate=e.SMPSTATE_EXPECT1,this.secret=null},a.prototype.makeSecret=function(a,c){var d=b.algo.SHA256.create();d.update(b.enc.Latin1.parse(f.packBytes(this.version,1))),d.update(b.enc.Hex.parse(a?this.our_fp:this.their_fp)),d.update(b.enc.Hex.parse(a?this.their_fp:this.our_fp)),d.update(b.enc.Latin1.parse(this.ssid)),d.update(b.enc.Latin1.parse(c));var e=d.finalize();this.secret=f.bits2bigInt(e.toString(b.enc.Latin1))},a.prototype.makeG2s=function(){this.a2=f.randomExponent(),this.a3=f.randomExponent(),this.g2a=c.powMod(h,this.a2,i),this.g3a=c.powMod(h,this.a3,i),f.checkGroup(this.g2a,i)&&f.checkGroup(this.g3a,i)||this.makeG2s()},a.prototype.computeGs=function(a,b){this.g2=c.powMod(a,this.a2,i),this.g3=c.powMod(b,this.a3,i)},a.prototype.computePQ=function(a){this.p=c.powMod(this.g3,a,i),this.q=f.multPowMod(h,a,this.g2,this.secret,i)},a.prototype.computeR=function(){this.r=c.powMod(this.QoQ,this.a3,i)},a.prototype.computeRab=function(a){return c.powMod(a,this.a3,i)},a.prototype.computeC=function(a,b){return f.smpHash(a,c.powMod(h,b,i))},a.prototype.computeD=function(a,b,d){return f.subMod(a,c.multMod(b,d,j),j)},a.prototype.handleSM=function(a){var b,d,g,j,k,l,m,n,o,p,q,r,s,t,u={2:e.SMPSTATE_EXPECT1,3:e.SMPSTATE_EXPECT2,4:e.SMPSTATE_EXPECT3,5:e.SMPSTATE_EXPECT4,7:e.SMPSTATE_EXPECT1};if(6===a.type)return this.init(),void this.trigger("trust",[!1]);if(this.smpstate!==u[a.type])return this.abort();switch(this.smpstate){case e.SMPSTATE_EXPECT1:f.debug.call(this,"smp tlv 2");var v,w;return 7===a.type&&(v=a.msg.indexOf("\x00"),w=a.msg.substring(0,v),a.msg=a.msg.substring(v+1)),s=f.readLen(a.msg.substr(0,4)),6!==s?this.abort():(a=f.unpackMPIs(6,a.msg.substring(4)),f.checkGroup(a[0],i)&&f.checkGroup(a[3],i)&&f.ZKP(1,a[1],f.multPowMod(h,a[2],a[0],a[1],i))&&f.ZKP(2,a[4],f.multPowMod(h,a[5],a[3],a[4],i))?(this.g3ao=a[3],this.makeG2s(),d=f.randomExponent(),g=f.randomExponent(),this.c2=this.computeC(3,d),this.c3=this.computeC(4,g),this.d2=this.computeD(d,this.a2,this.c2),this.d3=this.computeD(g,this.a3,this.c3),this.computeGs(a[0],a[3]),this.smpstate=e.SMPSTATE_EXPECT0,void this.trigger("question",[w])):this.abort());case e.SMPSTATE_EXPECT2:if(f.debug.call(this,"smp tlv 3"),s=f.readLen(a.msg.substr(0,4)),11!==s)return this.abort();if(a=f.unpackMPIs(11,a.msg.substring(4)),!(f.checkGroup(a[0],i)&&f.checkGroup(a[3],i)&&f.checkGroup(a[6],i)&&f.checkGroup(a[7],i)))return this.abort();if(!f.ZKP(3,a[1],f.multPowMod(h,a[2],a[0],a[1],i)))return this.abort();if(!f.ZKP(4,a[4],f.multPowMod(h,a[5],a[3],a[4],i)))return this.abort();if(this.g3ao=a[3],this.computeGs(a[0],a[3]),k=f.multPowMod(this.g3,a[9],a[6],a[8],i),l=f.multPowMod(h,a[9],this.g2,a[10],i),l=c.multMod(l,c.powMod(a[7],a[8],i),i),!f.ZKP(5,a[8],k,l))return this.abort();var x=f.randomExponent();this.computePQ(x);var y=f.randomExponent(),z=f.randomExponent(),A=f.multPowMod(h,y,this.g2,z,i),B=f.smpHash(6,c.powMod(this.g3,y,i),A),C=this.computeD(y,x,B),D=this.computeD(z,this.secret,B);this.QoQ=f.divMod(this.q,a[7],i),this.PoP=f.divMod(this.p,a[6],i),this.computeR(),j=f.randomExponent(),p=c.powMod(this.QoQ,j,i),q=f.smpHash(7,c.powMod(h,j,i),p),r=this.computeD(j,this.a3,q),this.smpstate=e.SMPSTATE_EXPECT4,b=f.packINT(8)+f.packMPIs([this.p,this.q,B,C,D,this.r,q,r]),b=f.packTLV(4,b);break;case e.SMPSTATE_EXPECT3:if(f.debug.call(this,"smp tlv 4"),s=f.readLen(a.msg.substr(0,4)),8!==s)return this.abort();if(a=f.unpackMPIs(8,a.msg.substring(4)),!f.checkGroup(a[0],i)||!f.checkGroup(a[1],i)||!f.checkGroup(a[5],i))return this.abort();if(k=f.multPowMod(this.g3,a[3],a[0],a[2],i),l=f.multPowMod(h,a[3],this.g2,a[4],i),l=c.multMod(l,c.powMod(a[1],a[2],i),i),!f.ZKP(6,a[2],k,l))return this.abort();if(m=f.multPowMod(h,a[7],this.g3ao,a[6],i),this.QoQ=f.divMod(a[1],this.q,i),n=f.multPowMod(this.QoQ,a[7],a[5],a[6],i),!f.ZKP(7,a[6],m,n))return this.abort();this.computeR(),j=f.randomExponent(),p=c.powMod(this.QoQ,j,i),q=f.smpHash(8,c.powMod(h,j,i),p),r=this.computeD(j,this.a3,q),b=f.packINT(3)+f.packMPIs([this.r,q,r]),b=f.packTLV(5,b),o=this.computeRab(a[5]),t=!!c.equals(o,f.divMod(a[0],this.p,i)),this.trigger("trust",[t,"answered"]),this.init();break;case e.SMPSTATE_EXPECT4:return f.debug.call(this,"smp tlv 5"),s=f.readLen(a.msg.substr(0,4)),3!==s?this.abort():(a=f.unpackMPIs(3,a.msg.substring(4)),f.checkGroup(a[0],i)?(m=f.multPowMod(h,a[2],this.g3ao,a[1],i),n=f.multPowMod(this.QoQ,a[2],a[0],a[1],i),f.ZKP(8,a[1],m,n)?(o=this.computeRab(a[0]),t=!!c.equals(o,this.PoP),this.trigger("trust",[t,"asked"]),void this.init()):this.abort()):this.abort())
}this.sendMsg(b)},a.prototype.sendMsg=function(a){this.trigger("send",[this.ssid,"\x00"+a])},a.prototype.rcvSecret=function(a,b){f.debug.call(this,"receive secret");var c,d=!1;this.smpstate===e.SMPSTATE_EXPECT0?c=this.answer:(c=this.initiate,d=!0),this.makeSecret(d,a),c.call(this,b)},a.prototype.answer=function(){f.debug.call(this,"smp answer");var a=f.randomExponent();this.computePQ(a);var b=f.randomExponent(),d=f.randomExponent(),g=f.multPowMod(h,b,this.g2,d,i),j=f.smpHash(5,c.powMod(this.g3,b,i),g),k=this.computeD(b,a,j),l=this.computeD(d,this.secret,j);this.smpstate=e.SMPSTATE_EXPECT3;var m=f.packINT(11)+f.packMPIs([this.g2a,this.c2,this.d2,this.g3a,this.c3,this.d3,this.p,this.q,j,k,l]);this.sendMsg(f.packTLV(3,m))},a.prototype.initiate=function(a){f.debug.call(this,"smp initiate"),this.smpstate!==e.SMPSTATE_EXPECT1&&this.abort(),this.makeG2s();var b=f.randomExponent(),c=f.randomExponent();this.c2=this.computeC(1,b),this.c3=this.computeC(2,c),this.d2=this.computeD(b,this.a2,this.c2),this.d3=this.computeD(c,this.a3,this.c3),this.smpstate=e.SMPSTATE_EXPECT2;var d="",g=2;a&&(d+=a,d+="\x00",g=7),d+=f.packINT(6)+f.packMPIs([this.g2a,this.c2,this.d2,this.g3a,this.c3,this.d3]),this.sendMsg(f.packTLV(g,d))},a.prototype.abort=function(){this.init(),this.sendMsg(f.packTLV(6,"")),this.trigger("abort")}}.call(this),function(){"use strict";function a(b){if(!(this instanceof a))return new a(b);if(b=b||{},b.priv&&!(b.priv instanceof l))throw new Error("Requires long-lived DSA key.");if(this.priv=b.priv?b.priv:new l,this.fragment_size=b.fragment_size||0,this.fragment_size<0)throw new Error("Fragment size must be a positive integer.");if(this.send_interval=b.send_interval||0,this.send_interval<0)throw new Error("Send interval must be a positive integer.");this.outgoing=[],this.our_instance_tag=b.instance_tag||a.makeInstanceTag(),this.debug=!!b.debug,this.smw=b.smw,this.init();var c=this;["sendMsg","receiveMsg"].forEach(function(a){c[a]=c[a].bind(c)}),d.call(this)}var b,c,d,e,f,g,h,i,j,k,l,m=this;"undefined"!=typeof module&&module.exports?(module.exports=a,b=require("../vendor/crypto.js"),c=require("../vendor/bigint.js"),d=require("../vendor/eventemitter.js"),e=require("webworker-threads").Worker,f=require("path").join(__dirname,"/sm-webworker.js"),g=require("./const.js"),h=require("./helpers.js"),i=require("./parse.js"),j=require("./ake.js"),k=require("./sm.js"),l=require("./dsa.js"),a.CONST=g):(Object.keys(m.OTR).forEach(function(b){a[b]=m.OTR[b]}),m.OTR=a,b=m.CryptoJS,c=m.BigInt,d=m.EventEmitter,e=m.Worker,f="sm-webworker.js",g=a.CONST,h=a.HLP,i=a.Parse,j=a.AKE,k=a.SM,l=m.DSA);var n=c.str2bigInt(g.G,10),o=c.str2bigInt(g.N,16),p=Math.pow(2,53)-1,q=Math.pow(2,31)-1;h.extend(a,d),a.prototype.init=function(){this.msgstate=g.MSGSTATE_PLAINTEXT,this.authstate=g.AUTHSTATE_NONE,this.ALLOW_V2=!0,this.ALLOW_V3=!0,this.REQUIRE_ENCRYPTION=!1,this.SEND_WHITESPACE_TAG=!1,this.WHITESPACE_START_AKE=!1,this.ERROR_START_AKE=!1,i.initFragment(this),this.their_y=null,this.their_old_y=null,this.their_keyid=0,this.their_priv_pk=null,this.their_instance_tag="\x00\x00\x00\x00",this.our_dh=this.dh(),this.our_old_dh=this.dh(),this.our_keyid=2,this.sessKeys=[new Array(2),new Array(2)],this.storedMgs=[],this.oldMacKeys=[],this.sm=null,this._akeInit(),this.receivedPlaintext=!1},a.prototype._akeInit=function(){this.ake=new j(this),this.transmittedRS=!1,this.ssid=null},a.prototype._SMW=function(a,b){this.otr=a;var d={path:f,seed:c.getSeed};"object"==typeof a.smw&&Object.keys(a.smw).forEach(function(b){d[b]=a.smw[b]}),this.worker=new e(d.path);var g=this;this.worker.onmessage=function(a){var b=a.data;b&&g.trigger(b.method,b.args)},this.worker.postMessage({type:"seed",seed:d.seed(),imports:d.imports}),this.worker.postMessage({type:"init",reqs:b})},h.extend(a.prototype._SMW,d),["handleSM","rcvSecret","abort"].forEach(function(b){a.prototype._SMW.prototype[b]=function(){this.worker.postMessage({type:"method",method:b,args:Array.prototype.slice.call(arguments,0)})}}),a.prototype._smInit=function(){var a={ssid:this.ssid,our_fp:this.priv.fingerprint(),their_fp:this.their_priv_pk.fingerprint(),debug:this.debug};this.smw?(this.sm&&this.sm.worker.terminate(),this.sm=new this._SMW(this,a)):this.sm=new k(a);var b=this;["trust","abort","question"].forEach(function(a){b.sm.on(a,function(){b.trigger("smp",[a].concat(Array.prototype.slice.call(arguments)))})}),this.sm.on("send",function(a,c){b.ssid===a&&b._sendMsg(c)})},a.prototype.io=function(a){this.outgoing=this.outgoing.concat(a);var b=this;!function c(a){if(!a){if(!b.outgoing.length)return;var d=b.outgoing.shift();b.trigger("io",[d])}setTimeout(c,a?0:b.send_interval)}(!0)},a.prototype.dh=function(){var a={privateKey:c.randBigInt(320)};return a.publicKey=c.powMod(n,a.privateKey,o),a},a.prototype.DHSession=function r(a,d){if(!(this instanceof r))return new r(a,d);var e=c.powMod(d,a.privateKey,o),f=h.packMPI(e);this.id=h.mask(h.h2("\x00",f),0,64);var g=c.greater(a.publicKey,d),i=g?"":"",j=g?"":"";this.sendenc=h.mask(h.h1(i,f),0,128),this.sendmac=b.SHA1(b.enc.Latin1.parse(this.sendenc)),this.sendmac=this.sendmac.toString(b.enc.Latin1),this.sendmacused=!1,this.rcvenc=h.mask(h.h1(j,f),0,128),this.rcvmac=b.SHA1(b.enc.Latin1.parse(this.rcvenc)),this.rcvmac=this.rcvmac.toString(b.enc.Latin1),this.rcvmacused=!1,this.extra_symkey=h.h2("ÿ",f),this.send_counter=0,this.rcv_counter=0},a.prototype.rotateOurKeys=function(){var a=this;this.sessKeys[1].forEach(function(b){b&&b.sendmacused&&a.oldMacKeys.push(b.sendmac),b&&b.rcvmacused&&a.oldMacKeys.push(b.rcvmac)}),this.our_old_dh=this.our_dh,this.our_dh=this.dh(),this.our_keyid+=1,this.sessKeys[1][0]=this.sessKeys[0][0],this.sessKeys[1][1]=this.sessKeys[0][1],this.sessKeys[0]=[this.their_y?new this.DHSession(this.our_dh,this.their_y):null,this.their_old_y?new this.DHSession(this.our_dh,this.their_old_y):null]},a.prototype.rotateTheirKeys=function(a){this.their_keyid+=1;var b=this;this.sessKeys.forEach(function(a){a[1]&&a[1].sendmacused&&b.oldMacKeys.push(a[1].sendmac),a[1]&&a[1].rcvmacused&&b.oldMacKeys.push(a[1].rcvmac)}),this.their_old_y=this.their_y,this.sessKeys[0][1]=this.sessKeys[0][0],this.sessKeys[1][1]=this.sessKeys[1][0],this.their_y=a,this.sessKeys[0][0]=new this.DHSession(this.our_dh,this.their_y),this.sessKeys[1][0]=new this.DHSession(this.our_old_dh,this.their_y)},a.prototype.prepareMsg=function(a,c){if(this.msgstate!==g.MSGSTATE_ENCRYPTED||0===this.their_keyid)return this.error("Not ready to encrypt.");var d=this.sessKeys[1][0];if(d.send_counter>=p)return this.error("Should have rekeyed by now.");d.send_counter+=1;var e=h.packCtr(d.send_counter),f=this.ake.otr_version+"",i=this.ake.otr_version===g.OTR_VERSION_3;if(i&&(f+=this.our_instance_tag,f+=this.their_instance_tag),f+="\x00",f+=h.packINT(this.our_keyid-1),f+=h.packINT(this.their_keyid),f+=h.packMPI(this.our_dh.publicKey),f+=e.substring(0,8),Math.ceil(a.length/8)>=q)return this.error("Message is too long.");var j=h.encryptAes(b.enc.Latin1.parse(a),d.sendenc,e);return f+=h.packData(j),f+=h.make1Mac(f,d.sendmac),f+=h.packData(this.oldMacKeys.splice(0).join("")),d.sendmacused=!0,f=h.wrapMsg(f,this.fragment_size,i,this.our_instance_tag,this.their_instance_tag),f[0]?this.error(f[0]):(c&&this.trigger("file",["send",d.extra_symkey,c]),f[1])},a.prototype.handleDataMsg=function(a){var c=a.version+a.type;this.ake.otr_version===g.OTR_VERSION_3&&(c+=a.instance_tags);var d=["BYTE","INT","INT","MPI","CTR","DATA","MAC","DATA"];a=h.splitype(d,a.msg);var e=""===a[0];if(this.msgstate!==g.MSGSTATE_ENCRYPTED||8!==a.length)return void(e||this.error("Received an unreadable encrypted message.",!0));var f=this.our_keyid-h.readLen(a[2]),i=this.their_keyid-h.readLen(a[1]);if(0>f||f>1)return void(e||this.error("Not of our latest keys.",!0));if(0>i||i>1)return void(e||this.error("Not of your latest keys.",!0));var j=i?this.their_old_y:this.their_y;if(1===i&&!j)return void(e||this.error("Do not have that key."));var k=this.sessKeys[f][i],l=h.unpackCtr(a[4]);if(l<=k.rcv_counter)return void(e||this.error("Counter in message is not larger."));k.rcv_counter=l,c+=a.slice(0,6).join("");var m=h.make1Mac(c,k.rcvmac);if(!h.compare(a[6],m))return void(e||this.error("MACs do not match."));k.rcvmacused=!0;var n=h.decryptAes(a[5].substring(4),k.rcvenc,h.padCtr(a[4]));n=n.toString(b.enc.Latin1),f||this.rotateOurKeys(),i||this.rotateTheirKeys(h.readMPI(a[3]));var o=n.indexOf("\x00");return~o&&(this.handleTLVs(n.substring(o+1),k),n=n.substring(0,o)),n=b.enc.Latin1.parse(n),n.toString(b.enc.Utf8)},a.prototype.handleTLVs=function(a,c){for(var d,e,f;a.length&&(d=h.unpackSHORT(a.substr(0,2)),e=h.unpackSHORT(a.substr(2,2)),f=a.substr(4,e),!(f.length<e));){switch(d){case 1:this.msgstate=g.MSGSTATE_FINISHED,this.trigger("status",[g.STATUS_END_OTR]);break;case 2:case 3:case 4:case 5:case 6:case 7:if(this.msgstate!==g.MSGSTATE_ENCRYPTED)return void(this.sm&&this.sm.abort());this.sm||this._smInit(),this.sm.handleSM({msg:f,type:d});break;case 8:f=f.substring(4),f=b.enc.Latin1.parse(f),f=f.toString(b.enc.Utf8),this.trigger("file",["receive",c.extra_symkey,f])}a=a.substring(4+e)}},a.prototype.smpSecret=function(a,b){return this.msgstate!==g.MSGSTATE_ENCRYPTED?this.error("Must be encrypted for SMP."):"string"!=typeof a||a.length<1?this.error("Secret is required."):(this.sm||this._smInit(),void this.sm.rcvSecret(a,b))},a.prototype.sendQueryMsg=function(){var a={},b=g.OTR_TAG;this.ALLOW_V2&&(a[2]=!0),this.ALLOW_V3&&(a[3]=!0);var c=Object.keys(a);c.length&&(b+="v",c.forEach(function(a){"1"!==a&&(b+=a)}),b+="?"),this._sendMsg(b,!0),this.trigger("status",[g.STATUS_SEND_QUERY])},a.prototype.sendMsg=function(a){(this.REQUIRE_ENCRYPTION||this.msgstate!==g.MSGSTATE_PLAINTEXT)&&(a=b.enc.Utf8.parse(a),a=a.toString(b.enc.Latin1)),this._sendMsg(a)},a.prototype._sendMsg=function(a,b){if(!b)switch(this.msgstate){case g.MSGSTATE_PLAINTEXT:if(this.REQUIRE_ENCRYPTION)return this.storedMgs.push(a),void this.sendQueryMsg();this.SEND_WHITESPACE_TAG&&!this.receivedPlaintext&&(a+=g.WHITESPACE_TAG,this.ALLOW_V3&&(a+=g.WHITESPACE_TAG_V3),this.ALLOW_V2&&(a+=g.WHITESPACE_TAG_V2));break;case g.MSGSTATE_FINISHED:return this.storedMgs.push(a),void this.error("Message cannot be sent at this time.");default:a=this.prepareMsg(a)}a&&this.io(a)},a.prototype.receiveMsg=function(a){if(a=i.parseMsg(this,a)){switch(a.cls){case"error":return void this.error(a.msg);case"ake":if(a.version===g.OTR_VERSION_3&&this.checkInstanceTags(a.instance_tags))return;return void this.ake.handleAKE(a);case"data":if(a.version===g.OTR_VERSION_3&&this.checkInstanceTags(a.instance_tags))return;a.msg=this.handleDataMsg(a),a.encrypted=!0;break;case"query":this.msgstate===g.MSGSTATE_ENCRYPTED&&this._akeInit(),this.doAKE(a);break;default:(this.REQUIRE_ENCRYPTION||this.msgstate!==g.MSGSTATE_PLAINTEXT)&&this.error("Received an unencrypted message."),this.receivedPlaintext=!0,this.WHITESPACE_START_AKE&&a.ver.length>0&&this.doAKE(a)}a.msg&&this.trigger("ui",[a.msg,a.encrypted])}},a.prototype.checkInstanceTags=function(a){var b=h.readLen(a.substr(0,4)),c=h.readLen(a.substr(4,4));if(c&&c!==h.readLen(this.our_instance_tag))return!0;if(h.readLen(this.their_instance_tag)){if(h.readLen(this.their_instance_tag)!==b)return!0}else{if(100>b)return!0;this.their_instance_tag=h.packINT(b)}},a.prototype.doAKE=function(a){this.ALLOW_V3&&~a.ver.indexOf(g.OTR_VERSION_3)?this.ake.initiateAKE(g.OTR_VERSION_3):this.ALLOW_V2&&~a.ver.indexOf(g.OTR_VERSION_2)?this.ake.initiateAKE(g.OTR_VERSION_2):this.error("OTR conversation requested, but no compatible protocol version found.")},a.prototype.error=function(a,b){return b?(this.debug||(a="An OTR error has occurred."),a="?OTR Error:"+a,void this._sendMsg(a,!0)):void this.trigger("error",[a])},a.prototype.sendStored=function(){var a=this;this.storedMgs.splice(0).forEach(function(b){a._sendMsg(b)})},a.prototype.sendFile=function(a){if(this.msgstate!==g.MSGSTATE_ENCRYPTED)return this.error("Not ready to encrypt.");if(this.ake.otr_version!==g.OTR_VERSION_3)return this.error("Protocol v3 required.");if(!a)return this.error("Please specify a filename.");var c=b.enc.Utf8.parse(a);if(c=c.toString(b.enc.Latin1),c.length>=65532)return this.error("filename is too long.");var d="\x00";d+="\x00\b",d+=h.packSHORT(4+c.length),d+="\x00\x00\x00",d+=c,d=this.prepareMsg(d,a),d&&this._sendMsg(d,!0)},a.prototype.endOtr=function(){this.msgstate===g.MSGSTATE_ENCRYPTED&&(this.sendMsg("\x00\x00\x00\x00"),this.sm&&(this.smw&&this.sm.worker.terminate(),this.sm=null)),this.msgstate=g.MSGSTATE_PLAINTEXT,this.receivedPlaintext=!1,this.trigger("status",[g.STATUS_END_OTR])},a.makeInstanceTag=function(){var b=c.randBigInt(32);return c.greater(c.str2bigInt("100",16),b)?a.makeInstanceTag():h.packINT(parseInt(c.bigInt2str(b,10),10))}}.call(this),{OTR:this.OTR,DSA:this.DSA}});var Base64=function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b={encode:function(b){var c,d,e,f,g,h,i,j="",k=0;do c=b.charCodeAt(k++),d=b.charCodeAt(k++),e=b.charCodeAt(k++),f=c>>2,g=(3&c)<<4|d>>4,h=(15&d)<<2|e>>6,i=63&e,isNaN(d)?h=i=64:isNaN(e)&&(i=64),j=j+a.charAt(f)+a.charAt(g)+a.charAt(h)+a.charAt(i);while(k<b.length);return j},decode:function(b){var c,d,e,f,g,h,i,j="",k=0;b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");do f=a.indexOf(b.charAt(k++)),g=a.indexOf(b.charAt(k++)),h=a.indexOf(b.charAt(k++)),i=a.indexOf(b.charAt(k++)),c=f<<2|g>>4,d=(15&g)<<4|h>>2,e=(3&h)<<6|i,j+=String.fromCharCode(c),64!=h&&(j+=String.fromCharCode(d)),64!=i&&(j+=String.fromCharCode(e));while(k<b.length);return j}};return b}(),hexcase=0,b64pad="=",chrsz=8,MD5=function(){var a=0,b="",c=8,d=function(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c},e=function(a,b){return a<<b|a>>>32-b},f=function(a){for(var b=[],d=(1<<c)-1,e=0;e<a.length*c;e+=c)b[e>>5]|=(a.charCodeAt(e/c)&d)<<e%32;return b},g=function(a){for(var b="",d=(1<<c)-1,e=0;e<32*a.length;e+=c)b+=String.fromCharCode(a[e>>5]>>>e%32&d);return b},h=function(b){for(var c=a?"0123456789ABCDEF":"0123456789abcdef",d="",e=0;e<4*b.length;e++)d+=c.charAt(b[e>>2]>>e%4*8+4&15)+c.charAt(b[e>>2]>>e%4*8&15);return d},i=function(a){for(var c,d,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f="",g=0;g<4*a.length;g+=3)for(c=(a[g>>2]>>8*(g%4)&255)<<16|(a[g+1>>2]>>8*((g+1)%4)&255)<<8|a[g+2>>2]>>8*((g+2)%4)&255,d=0;4>d;d++)f+=8*g+6*d>32*a.length?b:e.charAt(c>>6*(3-d)&63);return f},j=function(a,b,c,f,g,h){return d(e(d(d(b,a),d(f,h)),g),c)},k=function(a,b,c,d,e,f,g){return j(b&c|~b&d,a,b,e,f,g)},l=function(a,b,c,d,e,f,g){return j(b&d|c&~d,a,b,e,f,g)},m=function(a,b,c,d,e,f,g){return j(b^c^d,a,b,e,f,g)},n=function(a,b,c,d,e,f,g){return j(c^(b|~d),a,b,e,f,g)},o=function(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c,e,f,g,h=1732584193,i=-271733879,j=-1732584194,o=271733878,p=0;p<a.length;p+=16)c=h,e=i,f=j,g=o,h=k(h,i,j,o,a[p+0],7,-680876936),o=k(o,h,i,j,a[p+1],12,-389564586),j=k(j,o,h,i,a[p+2],17,606105819),i=k(i,j,o,h,a[p+3],22,-1044525330),h=k(h,i,j,o,a[p+4],7,-176418897),o=k(o,h,i,j,a[p+5],12,1200080426),j=k(j,o,h,i,a[p+6],17,-1473231341),i=k(i,j,o,h,a[p+7],22,-45705983),h=k(h,i,j,o,a[p+8],7,1770035416),o=k(o,h,i,j,a[p+9],12,-1958414417),j=k(j,o,h,i,a[p+10],17,-42063),i=k(i,j,o,h,a[p+11],22,-1990404162),h=k(h,i,j,o,a[p+12],7,1804603682),o=k(o,h,i,j,a[p+13],12,-40341101),j=k(j,o,h,i,a[p+14],17,-1502002290),i=k(i,j,o,h,a[p+15],22,1236535329),h=l(h,i,j,o,a[p+1],5,-165796510),o=l(o,h,i,j,a[p+6],9,-1069501632),j=l(j,o,h,i,a[p+11],14,643717713),i=l(i,j,o,h,a[p+0],20,-373897302),h=l(h,i,j,o,a[p+5],5,-701558691),o=l(o,h,i,j,a[p+10],9,38016083),j=l(j,o,h,i,a[p+15],14,-660478335),i=l(i,j,o,h,a[p+4],20,-405537848),h=l(h,i,j,o,a[p+9],5,568446438),o=l(o,h,i,j,a[p+14],9,-1019803690),j=l(j,o,h,i,a[p+3],14,-187363961),i=l(i,j,o,h,a[p+8],20,1163531501),h=l(h,i,j,o,a[p+13],5,-1444681467),o=l(o,h,i,j,a[p+2],9,-51403784),j=l(j,o,h,i,a[p+7],14,1735328473),i=l(i,j,o,h,a[p+12],20,-1926607734),h=m(h,i,j,o,a[p+5],4,-378558),o=m(o,h,i,j,a[p+8],11,-2022574463),j=m(j,o,h,i,a[p+11],16,1839030562),i=m(i,j,o,h,a[p+14],23,-35309556),h=m(h,i,j,o,a[p+1],4,-1530992060),o=m(o,h,i,j,a[p+4],11,1272893353),j=m(j,o,h,i,a[p+7],16,-155497632),i=m(i,j,o,h,a[p+10],23,-1094730640),h=m(h,i,j,o,a[p+13],4,681279174),o=m(o,h,i,j,a[p+0],11,-358537222),j=m(j,o,h,i,a[p+3],16,-722521979),i=m(i,j,o,h,a[p+6],23,76029189),h=m(h,i,j,o,a[p+9],4,-640364487),o=m(o,h,i,j,a[p+12],11,-421815835),j=m(j,o,h,i,a[p+15],16,530742520),i=m(i,j,o,h,a[p+2],23,-995338651),h=n(h,i,j,o,a[p+0],6,-198630844),o=n(o,h,i,j,a[p+7],10,1126891415),j=n(j,o,h,i,a[p+14],15,-1416354905),i=n(i,j,o,h,a[p+5],21,-57434055),h=n(h,i,j,o,a[p+12],6,1700485571),o=n(o,h,i,j,a[p+3],10,-1894986606),j=n(j,o,h,i,a[p+10],15,-1051523),i=n(i,j,o,h,a[p+1],21,-2054922799),h=n(h,i,j,o,a[p+8],6,1873313359),o=n(o,h,i,j,a[p+15],10,-30611744),j=n(j,o,h,i,a[p+6],15,-1560198380),i=n(i,j,o,h,a[p+13],21,1309151649),h=n(h,i,j,o,a[p+4],6,-145523070),o=n(o,h,i,j,a[p+11],10,-1120210379),j=n(j,o,h,i,a[p+2],15,718787259),i=n(i,j,o,h,a[p+9],21,-343485551),h=d(h,c),i=d(i,e),j=d(j,f),o=d(o,g);return[h,i,j,o]},p=function(a,b){var d=f(a);d.length>16&&(d=o(d,a.length*c));for(var e=new Array(16),g=new Array(16),h=0;16>h;h++)e[h]=909522486^d[h],g[h]=1549556828^d[h];var i=o(e.concat(f(b)),512+b.length*c);return o(g.concat(i),640)},q={hexdigest:function(a){return h(o(f(a),a.length*c))},b64digest:function(a){return i(o(f(a),a.length*c))},hash:function(a){return g(o(f(a),a.length*c))},hmac_hexdigest:function(a,b){return h(p(a,b))},hmac_b64digest:function(a,b){return i(p(a,b))},hmac_hash:function(a,b){return g(p(a,b))},test:function(){return"900150983cd24fb0d6963f7d28e17f72"===MD5.hexdigest("abc")}};return q}();Function.prototype.bind||(Function.prototype.bind=function(a){var b=this,c=Array.prototype.slice,d=Array.prototype.concat,e=c.call(arguments,1);return function(){return b.apply(a?a:this,d.call(e,c.call(arguments,0)))}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1}),function(a){function b(a,b){return new f.Builder(a,b)}function c(a){return new f.Builder("message",a)}function d(a){return new f.Builder("iq",a)}function e(a){return new f.Builder("presence",a)}var f;f={VERSION:"5282ae2",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag:function(a){for(var b=0;b<f.XHTML.tags.length;b++)if(a==f.XHTML.tags[b])return!0;return!1},validAttribute:function(a,b){if("undefined"!=typeof f.XHTML.attributes[a]&&f.XHTML.attributes[a].length>0)for(var c=0;c<f.XHTML.attributes[a].length;c++)if(b==f.XHTML.attributes[a][c])return!0;return!1},validCSS:function(a){for(var b=0;b<f.XHTML.css.length;b++)if(a==f.XHTML.css[b])return!0;return!1}},addNamespace:function(a,b){f.NS[a]=b},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,forEachChild:function(a,b,c){var d,e;for(d=0;d<a.childNodes.length;d++)e=a.childNodes[d],e.nodeType!=f.ElementType.NORMAL||b&&!this.isTagEqual(e,b)||c(e)},isTagEqual:function(a,b){return a.tagName.toLowerCase()==b.toLowerCase()},_xmlGenerator:null,_makeGenerator:function(){var a;return void 0===document.implementation.createDocument||document.implementation.createDocument&&document.documentMode&&document.documentMode<10?(a=this._getIEXmlDom(),a.appendChild(a.createElement("strophe"))):a=document.implementation.createDocument("jabber:client","strophe",null),a},xmlGenerator:function(){return f._xmlGenerator||(f._xmlGenerator=f._makeGenerator()),f._xmlGenerator},_getIEXmlDom:function(){for(var a=null,b=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"],c=0;c<b.length&&null===a;c++)try{a=new ActiveXObject(b[c])}catch(d){a=null}return a},xmlElement:function(a){if(!a)return null;var b,c,d,e=f.xmlGenerator().createElement(a);for(b=1;b<arguments.length;b++)if(arguments[b])if("string"==typeof arguments[b]||"number"==typeof arguments[b])e.appendChild(f.xmlTextNode(arguments[b]));else if("object"==typeof arguments[b]&&"function"==typeof arguments[b].sort)for(c=0;c<arguments[b].length;c++)"object"==typeof arguments[b][c]&&"function"==typeof arguments[b][c].sort&&e.setAttribute(arguments[b][c][0],arguments[b][c][1]);else if("object"==typeof arguments[b])for(d in arguments[b])arguments[b].hasOwnProperty(d)&&e.setAttribute(d,arguments[b][d]);return e},xmlescape:function(a){return a=a.replace(/\&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/'/g,"&apos;"),a=a.replace(/"/g,"&quot;")},xmlTextNode:function(a){return f.xmlGenerator().createTextNode(a)},xmlHtmlNode:function(a){return window.DOMParser?(parser=new DOMParser,node=parser.parseFromString(a,"text/xml")):(node=new ActiveXObject("Microsoft.XMLDOM"),node.async="false",node.loadXML(a)),node},getText:function(a){if(!a)return null;var b="";0===a.childNodes.length&&a.nodeType==f.ElementType.TEXT&&(b+=a.nodeValue);for(var c=0;c<a.childNodes.length;c++)a.childNodes[c].nodeType==f.ElementType.TEXT&&(b+=a.childNodes[c].nodeValue);return f.xmlescape(b)},copyElement:function(a){var b,c;if(a.nodeType==f.ElementType.NORMAL){for(c=f.xmlElement(a.tagName),b=0;b<a.attributes.length;b++)c.setAttribute(a.attributes[b].nodeName.toLowerCase(),a.attributes[b].value);for(b=0;b<a.childNodes.length;b++)c.appendChild(f.copyElement(a.childNodes[b]))}else a.nodeType==f.ElementType.TEXT&&(c=f.xmlGenerator().createTextNode(a.nodeValue));return c},createHtml:function(a){var b,c,d,e,g,h,i,j,k,l,m;if(a.nodeType==f.ElementType.NORMAL)if(e=a.nodeName.toLowerCase(),f.XHTML.validTag(e))try{for(c=f.xmlElement(e),b=0;b<f.XHTML.attributes[e].length;b++)if(g=f.XHTML.attributes[e][b],h=a.getAttribute(g),"undefined"!=typeof h&&null!==h&&""!==h&&h!==!1&&0!==h)if("style"==g&&"object"==typeof h&&"undefined"!=typeof h.cssText&&(h=h.cssText),"style"==g){for(i=[],j=h.split(";"),d=0;d<j.length;d++)k=j[d].split(":"),l=k[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase(),f.XHTML.validCSS(l)&&(m=k[1].replace(/^\s*/,"").replace(/\s*$/,""),i.push(l+": "+m));i.length>0&&(h=i.join("; "),c.setAttribute(g,h))}else c.setAttribute(g,h);for(b=0;b<a.childNodes.length;b++)c.appendChild(f.createHtml(a.childNodes[b]))}catch(n){c=f.xmlTextNode("")}else for(c=f.xmlGenerator().createDocumentFragment(),b=0;b<a.childNodes.length;b++)c.appendChild(f.createHtml(a.childNodes[b]));else if(a.nodeType==f.ElementType.FRAGMENT)for(c=f.xmlGenerator().createDocumentFragment(),b=0;b<a.childNodes.length;b++)c.appendChild(f.createHtml(a.childNodes[b]));else a.nodeType==f.ElementType.TEXT&&(c=f.xmlTextNode(a.nodeValue));return c},escapeNode:function(a){return a.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},unescapeNode:function(a){return a.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},getNodeFromJid:function(a){return a.indexOf("@")<0?null:a.split("@")[0]},getDomainFromJid:function(a){var b=f.getBareJidFromJid(a);if(b.indexOf("@")<0)return b;var c=b.split("@");return c.splice(0,1),c.join("@")},getResourceFromJid:function(a){var b=a.split("/");return b.length<2?null:(b.splice(0,1),b.join("/"))},getBareJidFromJid:function(a){return a?a.split("/")[0]:null},log:function(){},debug:function(a){this.log(this.LogLevel.DEBUG,a)},info:function(a){this.log(this.LogLevel.INFO,a)},warn:function(a){this.log(this.LogLevel.WARN,a)},error:function(a){this.log(this.LogLevel.ERROR,a)},fatal:function(a){this.log(this.LogLevel.FATAL,a)},serialize:function(a){var b;if(!a)return null;"function"==typeof a.tree&&(a=a.tree());var c,d,e=a.nodeName;for(a.getAttribute("_realname")&&(e=a.getAttribute("_realname")),b="<"+e,c=0;c<a.attributes.length;c++)"_realname"!=a.attributes[c].nodeName&&(b+=" "+a.attributes[c].nodeName.toLowerCase()+"='"+a.attributes[c].value.replace(/&/g,"&amp;").replace(/\'/g,"&apos;").replace(/>/g,"&gt;").replace(/</g,"&lt;")+"'");if(a.childNodes.length>0){for(b+=">",c=0;c<a.childNodes.length;c++)switch(d=a.childNodes[c],d.nodeType){case f.ElementType.NORMAL:b+=f.serialize(d);break;case f.ElementType.TEXT:b+=f.xmlescape(d.nodeValue);break;case f.ElementType.CDATA:b+="<![CDATA["+d.nodeValue+"]]>"}b+="</"+e+">"}else b+="/>";return b},_requestId:0,_connectionPlugins:{},addConnectionPlugin:function(a,b){f._connectionPlugins[a]=b}},f.Builder=function(a,b){("presence"==a||"message"==a||"iq"==a)&&(b&&!b.xmlns?b.xmlns=f.NS.CLIENT:b||(b={xmlns:f.NS.CLIENT})),this.nodeTree=f.xmlElement(a,b),this.node=this.nodeTree},f.Builder.prototype={tree:function(){return this.nodeTree},toString:function(){return f.serialize(this.nodeTree)},up:function(){return this.node=this.node.parentNode,this},attrs:function(a){for(var b in a)a.hasOwnProperty(b)&&this.node.setAttribute(b,a[b]);return this},c:function(a,b,c){var d=f.xmlElement(a,b,c);return this.node.appendChild(d),c||(this.node=d),this},cnode:function(a){var b=f.xmlGenerator();try{var c=void 0!==b.importNode}catch(d){var c=!1}var e=c?b.importNode(a,!0):f.copyElement(a);return this.node.appendChild(e),this.node=e,this},t:function(a){var b=f.xmlTextNode(a);return this.node.appendChild(b),this},h:function(a){var b=document.createElement("body");b.innerHTML=a;for(var c=f.createHtml(b);c.childNodes.length>0;)this.node.appendChild(c.childNodes[0]);return this}},f.Handler=function(a,b,c,d,e,g,h){this.handler=a,this.ns=b,this.name=c,this.type=d,this.id=e,this.options=h||{matchBare:!1},this.options.matchBare||(this.options.matchBare=!1),this.from=this.options.matchBare?g?f.getBareJidFromJid(g):null:g,this.user=!0},f.Handler.prototype={isMatch:function(a){var b,c=null;if(c=this.options.matchBare?f.getBareJidFromJid(a.getAttribute("from")):a.getAttribute("from"),b=!1,this.ns){var d=this;f.forEachChild(a,null,function(a){a.getAttribute("xmlns")==d.ns&&(b=!0)}),b=b||a.getAttribute("xmlns")==this.ns}else b=!0;return!b||this.name&&!f.isTagEqual(a,this.name)||this.type&&a.getAttribute("type")!=this.type||this.id&&a.getAttribute("id")!=this.id||this.from&&c!=this.from?!1:!0},run:function(a){var b=null;try{b=this.handler(a)}catch(c){throw c.sourceURL?f.fatal("error: "+this.handler+" "+c.sourceURL+":"+c.line+" - "+c.name+": "+c.message):c.fileName?("undefined"!=typeof console&&(console.trace(),console.error(this.handler," - error - ",c,c.message)),f.fatal("error: "+this.handler+" "+c.fileName+":"+c.lineNumber+" - "+c.name+": "+c.message)):f.fatal("error: "+c.message+"\n"+c.stack),c}return b},toString:function(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}},f.TimedHandler=function(a,b){this.period=a,this.handler=b,this.lastCalled=(new Date).getTime(),this.user=!0},f.TimedHandler.prototype={run:function(){return this.lastCalled=(new Date).getTime(),this.handler()},reset:function(){this.lastCalled=(new Date).getTime()},toString:function(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}},f.Request=function(a,b,c,d){this.id=++f._requestId,this.xmlData=a,this.data=f.serialize(a),this.origFunc=b,this.func=b,this.rid=c,this.date=0/0,this.sends=d||0,this.abort=!1,this.dead=null,this.age=function(){if(!this.date)return 0;var a=new Date;return(a-this.date)/1e3},this.timeDead=function(){if(!this.dead)return 0;var a=new Date;return(a-this.dead)/1e3},this.xhr=this._newXHR()},f.Request.prototype={getResponse:function(){var a=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if(a=this.xhr.responseXML.documentElement,"parsererror"==a.tagName)throw f.error("invalid response received"),f.error("responseText: "+this.xhr.responseText),f.error("responseXML: "+f.serialize(this.xhr.responseXML)),"parsererror"}else this.xhr.responseText&&(f.error("invalid response received"),f.error("responseText: "+this.xhr.responseText),f.error("responseXML: "+f.serialize(this.xhr.responseXML)));return a},_newXHR:function(){var a=null;return window.XMLHttpRequest?(a=new XMLHttpRequest,a.overrideMimeType&&a.overrideMimeType("text/xml")):window.ActiveXObject&&(a=new ActiveXObject("Microsoft.XMLHTTP")),a.onreadystatechange=this.func.bind(null,this),a}},f.Connection=function(a){this.service=a,this.jid="",this.domain=null,this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.streamId=null,this.features=null,this._sasl_data=[],this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._authentication={},this._idleTimeout=null,this._disconnectTimeout=null,this.do_authentication=!0,this.authenticated=!1,this.disconnecting=!1,this.connected=!1,this.errors=0,this.paused=!1,this.hold=1,this.wait=60,this.window=5,this._data=[],this._requests=[],this._uniqueId=Math.round(1e4*Math.random()),this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout(this._onIdle.bind(this),100);for(var b in f._connectionPlugins)if(f._connectionPlugins.hasOwnProperty(b)){var c=f._connectionPlugins[b],d=function(){};d.prototype=c,this[b]=new d,this[b].init(this)}},f.Connection.prototype={reset:function(){this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.streamId=null,this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._authentication={},this.authenticated=!1,this.disconnecting=!1,this.connected=!1,this.errors=0,this._requests=[],this._uniqueId=Math.round(1e4*Math.random())},pause:function(){this.paused=!0},resume:function(){this.paused=!1},getUniqueId:function(a){return"string"==typeof a||"number"==typeof a?++this._uniqueId+":"+a:++this._uniqueId+""},connect:function(a,b,c,d,e,g){this.jid=a,this.pass=b,this.connect_callback=c,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.errors=0,this.wait=d||this.wait,this.hold=e||this.hold,this.domain=this.domain||f.getDomainFromJid(this.jid);var h=this._buildBody().attrs({to:this.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":f.NS.BOSH});g&&h.attrs({route:g}),this._changeConnectStatus(f.Status.CONNECTING,null);var i=this._connect_callback||this._connect_cb;this._connect_callback=null,this._requests.push(new f.Request(h.tree(),this._onRequestStateChange.bind(this,i.bind(this)),h.tree().getAttribute("rid"))),this._throttledRequestHandler()},attach:function(a,b,c,d,e,g,h){this.jid=a,this.sid=b,this.rid=c,this.connect_callback=d,this.domain=f.getDomainFromJid(this.jid),this.authenticated=!0,this.connected=!0,this.wait=e||this.wait,this.hold=g||this.hold,this.window=h||this.window,this._changeConnectStatus(f.Status.ATTACHED,null)
},xmlInput:function(){},xmlOutput:function(){},rawInput:function(){},rawOutput:function(){},send:function(a){if(null!==a){if("function"==typeof a.sort)for(var b=0;b<a.length;b++)this._queueData(a[b]);else this._queueData("function"==typeof a.tree?a.tree():a);this._throttledRequestHandler(),clearTimeout(this._idleTimeout),this._idleTimeout=setTimeout(this._onIdle.bind(this),100)}},flush:function(){clearTimeout(this._idleTimeout),this._onIdle()},sendIQ:function(a,b,c,d){var e=null,f=this;"function"==typeof a.tree&&(a=a.tree());var g=a.getAttribute("id");g||(g=this.getUniqueId("sendIQ"),a.setAttribute("id",g));var h=this.addHandler(function(a){e&&f.deleteTimedHandler(e);var d=a.getAttribute("type");if("result"==d)b&&b(a);else{if("error"!=d)throw{name:"StropheError",message:"Got bad IQ type of "+d};c&&c(a)}},null,"iq",null,g);return d&&(e=this.addTimedHandler(d,function(){return f.deleteHandler(h),c&&c(null),!1})),this.send(a),g},_queueData:function(a){if(null===a||!a.tagName||!a.childNodes)throw{name:"StropheError",message:"Cannot queue non-DOMElement."};this._data.push(a)},_sendRestart:function(){this._data.push("restart"),this._throttledRequestHandler(),clearTimeout(this._idleTimeout),this._idleTimeout=setTimeout(this._onIdle.bind(this),100)},addTimedHandler:function(a,b){var c=new f.TimedHandler(a,b);return this.addTimeds.push(c),c},deleteTimedHandler:function(a){this.removeTimeds.push(a)},addHandler:function(a,b,c,d,e,g,h){var i=new f.Handler(a,b,c,d,e,g,h);return this.addHandlers.push(i),i},deleteHandler:function(a){this.removeHandlers.push(a)},disconnect:function(a){this._changeConnectStatus(f.Status.DISCONNECTING,a),f.info("Disconnect was called because: "+a),this.connected&&(this._disconnectTimeout=this._addSysTimedHandler(3e3,this._onDisconnectTimeout.bind(this)),this._sendTerminate())},_changeConnectStatus:function(a,b){for(var c in f._connectionPlugins)if(f._connectionPlugins.hasOwnProperty(c)){var d=this[c];if(d.statusChanged)try{d.statusChanged(a,b)}catch(e){f.error(""+c+" plugin caused an exception changing status: "+e)}}if(this.connect_callback)try{this.connect_callback(a,b)}catch(g){f.error("User connection callback caused an exception: "+g)}},_buildBody:function(){var a=b("body",{rid:this.rid++,xmlns:f.NS.HTTPBIND});return null!==this.sid&&a.attrs({sid:this.sid}),a},_removeRequest:function(a){f.debug("removing request");var b;for(b=this._requests.length-1;b>=0;b--)a==this._requests[b]&&this._requests.splice(b,1);a.xhr.onreadystatechange=function(){},this._throttledRequestHandler()},_restartRequest:function(a){var b=this._requests[a];null===b.dead&&(b.dead=new Date),this._processRequest(a)},_processRequest:function(a){var b=this._requests[a],c=-1;try{4==b.xhr.readyState&&(c=b.xhr.status)}catch(d){f.error("caught an error in _requests["+a+"], reqStatus: "+c)}if("undefined"==typeof c&&(c=-1),b.sends>this.maxRetries)return void this._onDisconnectTimeout();var e=b.age(),g=!isNaN(e)&&e>Math.floor(f.TIMEOUT*this.wait),h=null!==b.dead&&b.timeDead()>Math.floor(f.SECONDARY_TIMEOUT*this.wait),i=4==b.xhr.readyState&&(1>c||c>=500);if((g||h||i)&&(h&&f.error("Request "+this._requests[a].id+" timed out (secondary), restarting"),b.abort=!0,b.xhr.abort(),b.xhr.onreadystatechange=function(){},this._requests[a]=new f.Request(b.xmlData,b.origFunc,b.rid,b.sends),b=this._requests[a]),0===b.xhr.readyState){f.debug("request id "+b.id+"."+b.sends+" posting");try{b.xhr.open("POST",this.service,!0)}catch(j){return f.error("XHR open failed."),this.connected||this._changeConnectStatus(f.Status.CONNFAIL,"bad-service"),void this.disconnect()}var k=function(){b.date=new Date,b.xhr.send(b.data)};if(b.sends>1){var l=1e3*Math.min(Math.floor(f.TIMEOUT*this.wait),Math.pow(b.sends,3));setTimeout(k,l)}else k();b.sends++,this.xmlOutput!==f.Connection.prototype.xmlOutput&&this.xmlOutput(b.xmlData),this.rawOutput!==f.Connection.prototype.rawOutput&&this.rawOutput(b.data)}else f.debug("_processRequest: "+(0===a?"first":"second")+" request has readyState of "+b.xhr.readyState)},_throttledRequestHandler:function(){f.debug(this._requests?"_throttledRequestHandler called with "+this._requests.length+" requests":"_throttledRequestHandler called with undefined requests"),this._requests&&0!==this._requests.length&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))},_onRequestStateChange:function(a,b){if(f.debug("request id "+b.id+"."+b.sends+" state changed to "+b.xhr.readyState),b.abort)return void(b.abort=!1);var c;if(4==b.xhr.readyState){c=0;try{c=b.xhr.status}catch(d){}if("undefined"==typeof c&&(c=0),this.disconnecting&&c>=400)return void this._hitError(c);var e=this._requests[0]==b,g=this._requests[1]==b;(c>0&&500>c||b.sends>5)&&(this._removeRequest(b),f.debug("request id "+b.id+" should now be removed")),200==c?((g||e&&this._requests.length>0&&this._requests[0].age()>Math.floor(f.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),f.debug("request id "+b.id+"."+b.sends+" got 200"),a(b),this.errors=0):(f.error("request id "+b.id+"."+b.sends+" error "+c+" happened"),(0===c||c>=400&&600>c||c>=12e3)&&(this._hitError(c),c>=400&&500>c&&(this._changeConnectStatus(f.Status.DISCONNECTING,null),this._doDisconnect()))),c>0&&500>c||b.sends>5||this._throttledRequestHandler()}},_hitError:function(a){this.errors++,f.warn("request errored, status: "+a+", number of errors: "+this.errors),this.errors>4&&this._onDisconnectTimeout()},_doDisconnect:function(){f.info("_doDisconnect was called"),this.authenticated=!1,this.disconnecting=!1,this.sid=null,this.streamId=null,this.rid=Math.floor(4294967295*Math.random()),this.connected&&(this._changeConnectStatus(f.Status.DISCONNECTED,null),this.connected=!1),this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[]},_dataRecv:function(a){try{var b=a.getResponse()}catch(c){if("parsererror"!=c)throw c;this.disconnect("strophe-parsererror")}if(null!==b){this.xmlInput!==f.Connection.prototype.xmlInput&&this.xmlInput(b),this.rawInput!==f.Connection.prototype.rawInput&&this.rawInput(f.serialize(b));for(var d,e;this.removeHandlers.length>0;)e=this.removeHandlers.pop(),d=this.handlers.indexOf(e),d>=0&&this.handlers.splice(d,1);for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&0===this._requests.length)return this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null,void this._doDisconnect();var g,h,i=b.getAttribute("type");if(null!==i&&"terminate"==i){if(this.disconnecting)return;return g=b.getAttribute("condition"),h=b.getElementsByTagName("conflict"),null!==g?("remote-stream-error"==g&&h.length>0&&(g="conflict"),this._changeConnectStatus(f.Status.CONNFAIL,g)):this._changeConnectStatus(f.Status.CONNFAIL,"unknown"),void this.disconnect()}var j=this;f.forEachChild(b,null,function(a){var b,c;for(c=j.handlers,j.handlers=[],b=0;b<c.length;b++){var d=c[b];try{!d.isMatch(a)||!j.authenticated&&d.user?j.handlers.push(d):d.run(a)&&j.handlers.push(d)}catch(e){}}})}},_sendTerminate:function(){f.info("_sendTerminate was called");var a=this._buildBody().attrs({type:"terminate"});this.authenticated&&a.c("presence",{xmlns:f.NS.CLIENT,type:"unavailable"}),this.disconnecting=!0;var b=new f.Request(a.tree(),this._onRequestStateChange.bind(this,this._dataRecv.bind(this)),a.tree().getAttribute("rid"));this._requests.push(b),this._throttledRequestHandler()},_connect_cb:function(a,b){f.info("_connect_cb was called"),this.connected=!0;var c=a.getResponse();if(c){this.xmlInput!==f.Connection.prototype.xmlInput&&this.xmlInput(c),this.rawInput!==f.Connection.prototype.rawInput&&this.rawInput(f.serialize(c));var d,e,g=c.getAttribute("type");if(null!==g&&"terminate"==g)return d=c.getAttribute("condition"),e=c.getElementsByTagName("conflict"),void(null!==d?("remote-stream-error"==d&&e.length>0&&(d="conflict"),this._changeConnectStatus(f.Status.CONNFAIL,d)):this._changeConnectStatus(f.Status.CONNFAIL,"unknown"));this.sid||(this.sid=c.getAttribute("sid")),this.stream_id||(this.stream_id=c.getAttribute("authid"));var h=c.getAttribute("requests");h&&(this.window=parseInt(h,10));var i=c.getAttribute("hold");i&&(this.hold=parseInt(i,10));var j=c.getAttribute("wait");j&&(this.wait=parseInt(j,10)),this._authentication.sasl_scram_sha1=!1,this._authentication.sasl_plain=!1,this._authentication.sasl_digest_md5=!1,this._authentication.sasl_anonymous=!1,this._authentication.legacy_auth=!1;var k=c.getElementsByTagName("stream:features").length>0;k||(k=c.getElementsByTagName("features").length>0);var l,m,n=c.getElementsByTagName("mechanism"),o=!1;if(k&&n.length>0){var p=0;for(l=0;l<n.length;l++)m=f.getText(n[l]),"SCRAM-SHA-1"==m?this._authentication.sasl_scram_sha1=!0:"DIGEST-MD5"==m?this._authentication.sasl_digest_md5=!0:"PLAIN"==m?this._authentication.sasl_plain=!0:"ANONYMOUS"==m?this._authentication.sasl_anonymous=!0:p++;this._authentication.legacy_auth=c.getElementsByTagName("auth").length>0,o=this._authentication.legacy_auth||p<n.length}if(!o){b=b||this._connect_cb;var q=this._buildBody();return this._requests.push(new f.Request(q.tree(),this._onRequestStateChange.bind(this,b.bind(this)),q.tree().getAttribute("rid"))),void this._throttledRequestHandler()}this.do_authentication!==!1&&this.authenticate()}},authenticate:function(){if(null===f.getNodeFromJid(this.jid)&&this._authentication.sasl_anonymous)this._changeConnectStatus(f.Status.AUTHENTICATING,null),this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this.send(b("auth",{xmlns:f.NS.SASL,mechanism:"ANONYMOUS"}).tree());else if(null===f.getNodeFromJid(this.jid))this._changeConnectStatus(f.Status.CONNFAIL,"x-strophe-bad-non-anon-jid"),this.disconnect();else if(this._authentication.sasl_scram_sha1){var a=MD5.hexdigest(1234567890*Math.random()),c="n="+f.getNodeFromJid(this.jid);c+=",r=",c+=a,this._sasl_data.cnonce=a,this._sasl_data["client-first-message-bare"]=c,c="n,,"+c,this._changeConnectStatus(f.Status.AUTHENTICATING,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_scram_challenge_cb.bind(this),null,"challenge",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this.send(b("auth",{xmlns:f.NS.SASL,mechanism:"SCRAM-SHA-1"}).t(Base64.encode(c)).tree())}else this._authentication.sasl_digest_md5?(this._changeConnectStatus(f.Status.AUTHENTICATING,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_digest_challenge1_cb.bind(this),null,"challenge",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this.send(b("auth",{xmlns:f.NS.SASL,mechanism:"DIGEST-MD5"}).tree())):this._authentication.sasl_plain?(c=f.getBareJidFromJid(this.jid),c+="\x00",c+=f.getNodeFromJid(this.jid),c+="\x00",c+=this.pass,this._changeConnectStatus(f.Status.AUTHENTICATING,null),this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),hashed_auth_str=Base64.encode(c),this.send(b("auth",{xmlns:f.NS.SASL,mechanism:"PLAIN"}).t(hashed_auth_str).tree())):(this._changeConnectStatus(f.Status.AUTHENTICATING,null),this._addSysHandler(this._auth1_cb.bind(this),null,null,null,"_auth_1"),this.send(d({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:f.NS.AUTH}).c("username",{}).t(f.getNodeFromJid(this.jid)).tree()))},_sasl_digest_challenge1_cb:function(a){var c,d=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/,e=Base64.decode(f.getText(a)),g=MD5.hexdigest(""+1234567890*Math.random()),h="",i=null,j="",k="";for(this.deleteHandler(this._sasl_failure_handler);e.match(d);)switch(c=e.match(d),e=e.replace(c[0],""),c[2]=c[2].replace(/^"(.+)"$/,"$1"),c[1]){case"realm":h=c[2];break;case"nonce":j=c[2];break;case"qop":k=c[2];break;case"host":i=c[2]}var l="xmpp/"+this.domain;null!==i&&(l=l+"/"+i);var m=MD5.hash(f.getNodeFromJid(this.jid)+":"+h+":"+this.pass)+":"+j+":"+g,n="AUTHENTICATE:"+l,o="";return o+="username="+this._quote(f.getNodeFromJid(this.jid))+",",o+="realm="+this._quote(h)+",",o+="nonce="+this._quote(j)+",",o+="cnonce="+this._quote(g)+",",o+='nc="00000001",',o+='qop="auth",',o+="digest-uri="+this._quote(l)+",",o+="response="+this._quote(MD5.hexdigest(MD5.hexdigest(m)+":"+j+":00000001:"+g+":auth:"+MD5.hexdigest(n)))+",",o+='charset="utf-8"',this._sasl_challenge_handler=this._addSysHandler(this._sasl_digest_challenge2_cb.bind(this),null,"challenge",null,null),this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this.send(b("response",{xmlns:f.NS.SASL}).t(Base64.encode(o)).tree()),!1},_quote:function(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},_sasl_digest_challenge2_cb:function(){return this.deleteHandler(this._sasl_success_handler),this.deleteHandler(this._sasl_failure_handler),this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this.send(b("response",{xmlns:f.NS.SASL}).tree()),!1},_sasl_scram_challenge_cb:function(a){var c,d,e,g,h,j,l,m,n,o="c=biws,",p=Base64.decode(f.getText(a)),q=this._sasl_data["client-first-message-bare"]+","+p+",",r=this._sasl_data.cnonce,s=/([a-z]+)=([^,]+)(,|$)/;for(this.deleteHandler(this._sasl_failure_handler);p.match(s);)switch(matches=p.match(s),p=p.replace(matches[0],""),matches[1]){case"r":c=matches[2];break;case"s":d=matches[2];break;case"i":e=matches[2]}if(c.substr(0,r.length)!==r)return this._sasl_data=[],this._sasl_failure_cb(null);for(o+="r="+c,q+=o,d=Base64.decode(d),d+="\x00\x00\x00",g=j=core_hmac_sha1(this.pass,d),i=1;e>i;i++){for(h=core_hmac_sha1(this.pass,binb2str(j)),k=0;5>k;k++)g[k]^=h[k];j=h}for(g=binb2str(g),l=core_hmac_sha1(g,"Client Key"),m=str_hmac_sha1(g,"Server Key"),n=core_hmac_sha1(str_sha1(binb2str(l)),q),this._sasl_data["server-signature"]=b64_hmac_sha1(m,q),k=0;5>k;k++)l[k]^=n[k];return o+=",p="+Base64.encode(binb2str(l)),this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this.send(b("response",{xmlns:f.NS.SASL}).t(Base64.encode(o)).tree()),!1},_auth1_cb:function(){var a=d({type:"set",id:"_auth_2"}).c("query",{xmlns:f.NS.AUTH}).c("username",{}).t(f.getNodeFromJid(this.jid)).up().c("password").t(this.pass);return f.getResourceFromJid(this.jid)||(this.jid=f.getBareJidFromJid(this.jid)+"/strophe"),a.up().c("resource",{}).t(f.getResourceFromJid(this.jid)),this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2"),this.send(a.tree()),!1},_sasl_success_cb:function(a){if(this._sasl_data["server-signature"]){var b,c=Base64.decode(f.getText(a)),d=/([a-z]+)=([^,]+)(,|$)/;if(matches=c.match(d),"v"==matches[1]&&(b=matches[2]),b!=this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data=[],this._sasl_failure_cb(null)}return f.info("SASL authentication succeeded."),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._addSysHandler(this._sasl_auth1_cb.bind(this),null,"stream:features",null,null),this._sendRestart(),!1},_sasl_auth1_cb:function(a){this.features=a;var b,c;for(b=0;b<a.childNodes.length;b++)c=a.childNodes[b],"bind"==c.nodeName&&(this.do_bind=!0),"session"==c.nodeName&&(this.do_session=!0);if(!this.do_bind)return this._changeConnectStatus(f.Status.AUTHFAIL,null),!1;this._addSysHandler(this._sasl_bind_cb.bind(this),null,null,null,"_bind_auth_2");var e=f.getResourceFromJid(this.jid);return this.send(e?d({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:f.NS.BIND}).c("resource",{}).t(e).tree():d({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:f.NS.BIND}).tree()),!1},_sasl_bind_cb:function(a){if("error"==a.getAttribute("type")){f.info("SASL binding failed.");var b,c=a.getElementsByTagName("conflict");return c.length>0&&(b="conflict"),this._changeConnectStatus(f.Status.AUTHFAIL,b),!1}var e,g=a.getElementsByTagName("bind");return g.length>0?(e=g[0].getElementsByTagName("jid"),void(e.length>0&&(this.jid=f.getText(e[0]),this.do_session?(this._addSysHandler(this._sasl_session_cb.bind(this),null,null,null,"_session_auth_2"),this.send(d({type:"set",id:"_session_auth_2"}).c("session",{xmlns:f.NS.SESSION}).tree())):(this.authenticated=!0,this._changeConnectStatus(f.Status.CONNECTED,null))))):(f.info("SASL binding failed."),this._changeConnectStatus(f.Status.AUTHFAIL,null),!1)},_sasl_session_cb:function(a){if("result"==a.getAttribute("type"))this.authenticated=!0,this._changeConnectStatus(f.Status.CONNECTED,null);else if("error"==a.getAttribute("type"))return f.info("Session creation failed."),this._changeConnectStatus(f.Status.AUTHFAIL,null),!1;return!1},_sasl_failure_cb:function(){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._changeConnectStatus(f.Status.AUTHFAIL,null),!1},_auth2_cb:function(a){return"result"==a.getAttribute("type")?(this.authenticated=!0,this._changeConnectStatus(f.Status.CONNECTED,null)):"error"==a.getAttribute("type")&&(this._changeConnectStatus(f.Status.AUTHFAIL,null),this.disconnect()),!1},_addSysTimedHandler:function(a,b){var c=new f.TimedHandler(a,b);return c.user=!1,this.addTimeds.push(c),c},_addSysHandler:function(a,b,c,d,e){var g=new f.Handler(a,b,c,d,e);return g.user=!1,this.addHandlers.push(g),g},_onDisconnectTimeout:function(){f.info("_onDisconnectTimeout was called");for(var a;this._requests.length>0;)a=this._requests.pop(),a.abort=!0,a.xhr.abort(),a.xhr.onreadystatechange=function(){};return this._doDisconnect(),!1},_onIdle:function(){for(var a,b,c,d;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;)b=this.removeTimeds.pop(),a=this.timedHandlers.indexOf(b),a>=0&&this.timedHandlers.splice(a,1);var e=(new Date).getTime();for(d=[],a=0;a<this.timedHandlers.length;a++)b=this.timedHandlers[a],(this.authenticated||!b.user)&&(c=b.lastCalled+b.period,0>=c-e?b.run()&&d.push(b):d.push(b));this.timedHandlers=d;var g,h;if(this.authenticated&&0===this._requests.length&&0===this._data.length&&!this.disconnecting&&(f.info("no requests during idle cycle, sending blank request"),this._data.push(null)),this._requests.length<2&&this._data.length>0&&!this.paused){for(g=this._buildBody(),a=0;a<this._data.length;a++)null!==this._data[a]&&("restart"===this._data[a]?g.attrs({to:this.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":f.NS.BOSH}):g.cnode(this._data[a]).up());delete this._data,this._data=[],this._requests.push(new f.Request(g.tree(),this._onRequestStateChange.bind(this,this._dataRecv.bind(this)),g.tree().getAttribute("rid"))),this._processRequest(this._requests.length-1)}this._requests.length>0&&(h=this._requests[0].age(),null!==this._requests[0].dead&&this._requests[0].timeDead()>Math.floor(f.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),h>Math.floor(f.TIMEOUT*this.wait)&&(f.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(f.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())),clearTimeout(this._idleTimeout),this.connected&&(this._idleTimeout=setTimeout(this._onIdle.bind(this),100))}},a&&a(f,b,c,d,e)}(function(){window.Strophe=arguments[0],window.$build=arguments[1],window.$msg=arguments[2],window.$iq=arguments[3],window.$pres=arguments[4]}),Strophe.addConnectionPlugin("roster",{_connection:null,_callbacks:[],items:[],ver:null,init:function(a){this._connection=a,this.items=[];var b,c=this,d=a.connect,e=a.attach,f=function(d){if(d==Strophe.Status.ATTACHED||d==Strophe.Status.CONNECTED)try{a.addHandler(c._onReceivePresence.bind(c),null,"presence",null,null,null),a.addHandler(c._onReceiveIQ.bind(c),Strophe.NS.ROSTER,"iq","set",null,null)}catch(e){Strophe.error(e)}null!==b&&b.apply(this,arguments)};a.connect=function(c,e,g){b=g,"undefined"==typeof arguments[0]&&(arguments[0]=null),"undefined"==typeof arguments[1]&&(arguments[1]=null),arguments[2]=f,d.apply(a,arguments)},a.attach=function(c,d,g,h){b=h,"undefined"==typeof arguments[0]&&(arguments[0]=null),"undefined"==typeof arguments[1]&&(arguments[1]=null),"undefined"==typeof arguments[2]&&(arguments[2]=null),arguments[3]=f,e.apply(a,arguments)},Strophe.addNamespace("ROSTER_VER","urn:xmpp:features:rosterver"),Strophe.addNamespace("NICK","http://jabber.org/protocol/nick")},supportVersioning:function(){return this._connection.features&&this._connection.features.getElementsByTagName("ver").length>0},get:function(a,b,c){var d={xmlns:Strophe.NS.ROSTER};this.items=[],this.supportVersioning()&&(d.ver=b||"",this.items=c||[]);var e=$iq({type:"get",id:this._connection.getUniqueId("roster")}).c("query",d);return this._connection.sendIQ(e,this._onReceiveRosterSuccess.bind(this,a),this._onReceiveRosterError.bind(this,a))},registerCallback:function(a){this._callbacks.push(a)},findItem:function(a){for(var b=0;b<this.items.length;b++)if(this.items[b]&&this.items[b].jid==a)return this.items[b];return!1},removeItem:function(a){for(var b=0;b<this.items.length;b++)if(this.items[b]&&this.items[b].jid==a)return this.items.splice(b,1),!0;return!1},subscribe:function(a,b,c){var d=$pres({to:a,type:"subscribe"});b&&""!==b&&d.c("status").t(b),c&&""!==c&&d.c("nick",{xmlns:Strophe.NS.NICK}).t(c),this._connection.send(d)},unsubscribe:function(a,b){var c=$pres({to:a,type:"unsubscribe"});b&&""!=b&&c.c("status").t(b),this._connection.send(c)},authorize:function(a,b){var c=$pres({to:a,type:"subscribed"});b&&""!=b&&c.c("status").t(b),this._connection.send(c)},unauthorize:function(a,b){var c=$pres({to:a,type:"unsubscribed"});b&&""!=b&&c.c("status").t(b),this._connection.send(c)},add:function(a,b,c,d){for(var e=$iq({type:"set"}).c("query",{xmlns:Strophe.NS.ROSTER}).c("item",{jid:a,name:b}),f=0;f<c.length;f++)e.c("group").t(c[f]).up();this._connection.sendIQ(e,d,d)},update:function(a,b,c,d){var e=this.findItem(a);if(!e)throw"item not found";for(var f=b||e.name,g=c||e.groups,h=$iq({type:"set"}).c("query",{xmlns:Strophe.NS.ROSTER}).c("item",{jid:e.jid,name:f}),i=0;i<g.length;i++)h.c("group").t(g[i]).up();return this._connection.sendIQ(h,d,d)},remove:function(a,b){var c=this.findItem(a);if(!c)throw"item not found";var d=$iq({type:"set"}).c("query",{xmlns:Strophe.NS.ROSTER}).c("item",{jid:c.jid,subscription:"remove"});this._connection.sendIQ(d,b,b)},_onReceiveRosterSuccess:function(a,b){this._updateItems(b),a(this.items)},_onReceiveRosterError:function(a){a(this.items)},_onReceivePresence:function(a){var b=a.getAttribute("from"),c=Strophe.getBareJidFromJid(b),d=this.findItem(c);if(!d)return!0;var e=a.getAttribute("type");if("unavailable"==e)delete d.resources[Strophe.getResourceFromJid(b)];else{if(e)return!0;d.resources[Strophe.getResourceFromJid(b)]={show:0!=a.getElementsByTagName("show").length?Strophe.getText(a.getElementsByTagName("show")[0]):"",status:0!=a.getElementsByTagName("status").length?Strophe.getText(a.getElementsByTagName("status")[0]):"",priority:0!=a.getElementsByTagName("priority").length?Strophe.getText(a.getElementsByTagName("priority")[0]):""}}return this._call_backs(this.items,d),!0},_call_backs:function(a,b){for(var c=0;c<this._callbacks.length;c++)this._callbacks[c](a,b)},_onReceiveIQ:function(a){var b=a.getAttribute("id"),c=a.getAttribute("from");if(c&&""!=c&&c!=this._connection.jid&&c!=Strophe.getBareJidFromJid(this._connection.jid))return!0;var d=$iq({type:"result",id:b,from:this._connection.jid});return this._connection.send(d),this._updateItems(a),!0},_updateItems:function(a){var b=a.getElementsByTagName("query");if(0!=b.length){this.ver=b.item(0).getAttribute("ver");var c=this;Strophe.forEachChild(b.item(0),"item",function(a){c._updateItem(a)})}this._call_backs(this.items)},_updateItem:function(a){var b=a.getAttribute("jid"),c=a.getAttribute("name"),d=a.getAttribute("subscription"),e=a.getAttribute("ask"),f=[];if(Strophe.forEachChild(a,"group",function(a){f.push(Strophe.getText(a))}),"remove"==d)return void this.removeItem(b);var a=this.findItem(b);a?(a.name=c,a.subscription=d,a.ask=e,a.groups=f):this.items.push({name:c,jid:b,subscription:d,ask:e,groups:f,resources:{}})}}),function(){var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}};Strophe.addConnectionPlugin("muc",{_connection:null,rooms:{},roomNames:[],init:function(a){return this._connection=a,this._muc_handler=null,Strophe.addNamespace("MUC_OWNER",Strophe.NS.MUC+"#owner"),Strophe.addNamespace("MUC_ADMIN",Strophe.NS.MUC+"#admin"),Strophe.addNamespace("MUC_USER",Strophe.NS.MUC+"#user"),Strophe.addNamespace("MUC_ROOMCONF",Strophe.NS.MUC+"#roomconfig")},join:function(a,b,d,e,f,g,h){var i,j,k=this;return j=this.test_append_nick(a,b),i=$pres({from:this._connection.jid,to:j}).c("x",{xmlns:Strophe.NS.MUC}),null!=h&&(i=i.c("history",h).up),null!=g&&i.cnode(Strophe.xmlElement("password",[],g)),"undefined"!=typeof extended_presence&&null!==extended_presence&&i.up.cnode(extended_presence),null==this._muc_handler&&(this._muc_handler=this._connection.addHandler(function(b){var c,d,e,f,g,h,i,j,l,m;if(c=b.getAttribute("from"),!c)return!0;if(g=c.split("/")[0],!k.rooms[g])return!0;if(a=k.rooms[g],e={},"message"===b.nodeName)e=a._message_handlers;else if("presence"===b.nodeName&&(j=b.getElementsByTagName("x"),j.length>0))for(l=0,m=j.length;m>l;l++)if(h=j[l],i=h.getAttribute("xmlns"),i&&i.match(Strophe.NS.MUC)){e=a._presence_handlers;break}for(f in e)d=e[f],d(b,a)||delete e[f];return!0})),this.rooms.hasOwnProperty(a)||(this.rooms[a]=new c(this,a,b,g),this.roomNames.push(a)),e&&this.rooms[a].addHandler("presence",e),d&&this.rooms[a].addHandler("message",d),f&&this.rooms[a].addHandler("roster",f),this._connection.send(i)},leave:function(a,b,c,d){var e,f,g,h;return e=this.roomNames.indexOf(a),delete this.rooms[a],e>=0&&(this.roomNames.splice(e,1),0===this.roomNames.length&&(this._connection.deleteHandler(this._muc_handler),this._muc_handler=null)),h=this.test_append_nick(a,b),g=this._connection.getUniqueId(),f=$pres({type:"unavailable",id:g,from:this._connection.jid,to:h}),null!=d&&f.c("status",d),null!=c&&this._connection.addHandler(c,null,"presence",null,g),this._connection.send(f),g},message:function(a,b,c,d,e){var f,g,h,i;return i=this.test_append_nick(a,b),e=e||(null!=b?"chat":"groupchat"),g=this._connection.getUniqueId(),f=$msg({to:i,from:this._connection.jid,type:e,id:g}).c("body",{xmlns:Strophe.NS.CLIENT}).t(c),f.up(),null!=d&&(f.c("html",{xmlns:Strophe.NS.XHTML_IM}).c("body",{xmlns:Strophe.NS.XHTML}).t(d),0===f.node.childNodes.length?(h=f.node.parentNode,f.up().up(),f.node.removeChild(h)):f.up().up()),f.c("x",{xmlns:"jabber:x:event"}).c("composing"),this._connection.send(f),g},groupchat:function(a,b,c){return this.message(a,null,b,c)},invite:function(a,b,c){var d,e;return e=this._connection.getUniqueId(),d=$msg({from:this._connection.jid,to:a,id:e}).c("x",{xmlns:Strophe.NS.MUC_USER}).c("invite",{to:b}),null!=c&&d.c("reason",c),this._connection.send(d),e},directInvite:function(a,b,c,d){var e,f,g;return g=this._connection.getUniqueId(),e={xmlns:"jabber:x:conference",jid:a},null!=c&&(e.reason=c),null!=d&&(e.password=d),f=$msg({from:this._connection.jid,to:b,id:g}).c("x",e),this._connection.send(f),g},queryOccupants:function(a,b,c){var d,e;return d={xmlns:Strophe.NS.DISCO_ITEMS},e=$iq({from:this._connection.jid,to:a,type:"get"}).c("query",d),this._connection.sendIQ(e,b,c)},configure:function(a,b,c){var d,e;return d=$iq({to:a,type:"get"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}),e=d.tree(),this._connection.sendIQ(e,b,c)},cancelConfigure:function(a){var b,c;return b=$iq({to:a,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"cancel"}),c=b.tree(),this._connection.sendIQ(c)},saveConfiguration:function(a,b,c,d){var e,f,g,h,i;if(f=$iq({to:a,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}),"undefined"!=typeof Form&&b instanceof Form)b.type="submit",f.cnode(b.toXML());else for(f.c("x",{xmlns:"jabber:x:data",type:"submit"}),h=0,i=b.length;i>h;h++)e=b[h],f.cnode(e).up();return g=f.tree(),this._connection.sendIQ(g,c,d)},createInstantRoom:function(a,b,c){var d;return d=$iq({to:a,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"}),this._connection.sendIQ(d.tree(),b,c)},setTopic:function(a,b){var c;return c=$msg({to:a,from:this._connection.jid,type:"groupchat"}).c("subject",{xmlns:"jabber:client"}).t(b),this._connection.send(c.tree())},_modifyPrivilege:function(a,b,c,d,e){var f;return f=$iq({to:a,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_ADMIN}).cnode(b.node),null!=c&&f.c("reason",c),this._connection.sendIQ(f.tree(),d,e)},modifyRole:function(a,b,c,d,e,f){var g;return g=$build("item",{nick:b,role:c}),this._modifyPrivilege(a,g,d,e,f)},kick:function(a,b,c,d,e){return this.modifyRole(a,b,"none",c,d,e)},voice:function(a,b,c,d,e){return this.modifyRole(a,b,"participant",c,d,e)},mute:function(a,b,c,d,e){return this.modifyRole(a,b,"visitor",c,d,e)},op:function(a,b,c,d,e){return this.modifyRole(a,b,"moderator",c,d,e)},deop:function(a,b,c,d,e){return this.modifyRole(a,b,"participant",c,d,e)},modifyAffiliation:function(a,b,c,d,e,f){var g;return g=$build("item",{jid:b,affiliation:c}),this._modifyPrivilege(a,g,d,e,f)},ban:function(a,b,c,d,e){return this.modifyAffiliation(a,b,"outcast",c,d,e)},member:function(a,b,c,d,e){return this.modifyAffiliation(a,b,"member",c,d,e)},revoke:function(a,b,c,d,e){return this.modifyAffiliation(a,b,"none",c,d,e)},owner:function(a,b,c,d,e){return this.modifyAffiliation(a,b,"owner",c,d,e)},admin:function(a,b,c,d,e){return this.modifyAffiliation(a,b,"admin",c,d,e)},changeNick:function(a,b){var c,d;return d=this.test_append_nick(a,b),c=$pres({from:this._connection.jid,to:d,id:this._connection.getUniqueId()}),this._connection.send(c.tree())},setStatus:function(a,b,c,d){var e,f;return f=this.test_append_nick(a,b),e=$pres({from:this._connection.jid,to:f}),null!=c&&e.c("show",c).up(),null!=d&&e.c("status",d),this._connection.send(e.tree())},listRooms:function(a,b,c){var d;return d=$iq({to:a,from:this._connection.jid,type:"get"}).c("query",{xmlns:Strophe.NS.DISCO_ITEMS}),this._connection.sendIQ(d,b,c)},test_append_nick:function(a,b){return a+(null!=b?"/"+Strophe.escapeNode(b):"")}}),c=function(){function b(a,b,c,e){this.client=a,this.name=b,this.nick=c,this.password=e,this._roomRosterHandler=d(this._roomRosterHandler,this),this._addOccupant=d(this._addOccupant,this),this.roster={},this._message_handlers={},this._presence_handlers={},this._roster_handlers={},this._handler_ids=0,a.muc&&(this.client=a.muc),this.name=Strophe.getBareJidFromJid(b),this.addHandler("presence",this._roomRosterHandler)}return b.prototype.join=function(a,b,c){return this.client.join(this.name,this.nick,a,b,c,this.password)},b.prototype.leave=function(a,b){return this.client.leave(this.name,this.nick,a,b),delete this.client.rooms[this.name]},b.prototype.message=function(a,b,c,d){return this.client.message(this.name,a,b,c,d)},b.prototype.groupchat=function(a,b){return this.client.groupchat(this.name,a,b)},b.prototype.invite=function(a,b){return this.client.invite(this.name,a,b)
},b.prototype.directInvite=function(a,b){return this.client.directInvite(this.name,a,b,this.password)},b.prototype.configure=function(a){return this.client.configure(this.name,a)},b.prototype.cancelConfigure=function(){return this.client.cancelConfigure(this.name)},b.prototype.saveConfiguration=function(a){return this.client.saveConfiguration(this.name,a)},b.prototype.queryOccupants=function(a,b){return this.client.queryOccupants(this.name,a,b)},b.prototype.setTopic=function(a){return this.client.setTopic(this.name,a)},b.prototype.modifyRole=function(a,b,c,d,e){return this.client.modifyRole(this.name,a,b,c,d,e)},b.prototype.kick=function(a,b,c,d){return this.client.kick(this.name,a,b,c,d)},b.prototype.voice=function(a,b,c,d){return this.client.voice(this.name,a,b,c,d)},b.prototype.mute=function(a,b,c,d){return this.client.mute(this.name,a,b,c,d)},b.prototype.op=function(a,b,c,d){return this.client.op(this.name,a,b,c,d)},b.prototype.deop=function(a,b,c,d){return this.client.deop(this.name,a,b,c,d)},b.prototype.modifyAffiliation=function(a,b,c,d,e){return this.client.modifyAffiliation(this.name,a,b,c,d,e)},b.prototype.ban=function(a,b,c,d){return this.client.ban(this.name,a,b,c,d)},b.prototype.member=function(a,b,c,d){return this.client.member(this.name,a,b,c,d)},b.prototype.revoke=function(a,b,c,d){return this.client.revoke(this.name,a,b,c,d)},b.prototype.owner=function(a,b,c,d){return this.client.owner(this.name,a,b,c,d)},b.prototype.admin=function(a,b,c,d){return this.client.admin(this.name,a,b,c,d)},b.prototype.changeNick=function(a){return this.nick=a,this.client.changeNick(this.name,a)},b.prototype.setStatus=function(a,b){return this.client.setStatus(this.name,this.nick,a,b)},b.prototype.addHandler=function(a,b){var c;switch(c=this._handler_ids++,a){case"presence":this._presence_handlers[c]=b;break;case"message":this._message_handlers[c]=b;break;case"roster":this._roster_handlers[c]=b;break;default:return this._handler_ids--,null}return c},b.prototype.removeHandler=function(a){return delete this._presence_handlers[a],delete this._message_handlers[a],delete this._roster_handlers[a]},b.prototype._addOccupant=function(b){var c;return c=new a(b,this),this.roster[c.nick]=c,c},b.prototype._roomRosterHandler=function(a){var c,d,e,f,g,h;switch(c=b._parsePresence(a),g=c.nick,f=c.newnick||null,c.type){case"error":return;case"unavailable":f&&(c.nick=f,this.roster[g]&&this.roster[f]&&(this.roster[g].update(this.roster[f]),this.roster[f]=this.roster[g]),this.roster[g]&&!this.roster[f]&&(this.roster[f]=this.roster[g].update(c))),delete this.roster[g];break;default:this.roster[g]?this.roster[g].update(c):this._addOccupant(c)}h=this._roster_handlers;for(e in h)d=h[e],d(this.roster,this)||delete this._roster_handlers[e];return!0},b._parsePresence=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;for(e={},b=a.attributes,e.nick=Strophe.getResourceFromJid(b.from.textContent),e.type=(null!=(j=b.type)?j.textContent:void 0)||null,e.states=[],k=a.childNodes,f=0,h=k.length;h>f;f++)switch(c=k[f],c.nodeName){case"status":e.status=c.textContent||null;break;case"show":e.show=c.textContent||null;break;case"x":if(b=c.attributes,(null!=(l=b.xmlns)?l.textContent:void 0)===Strophe.NS.MUC_USER)for(m=c.childNodes,g=0,i=m.length;i>g;g++)switch(d=m[g],d.nodeName){case"item":b=d.attributes,e.affiliation=(null!=(n=b.affiliation)?n.textContent:void 0)||null,e.role=(null!=(o=b.role)?o.textContent:void 0)||null,e.jid=(null!=(p=b.jid)?p.textContent:void 0)||null,e.newnick=(null!=(q=b.nick)?q.textContent:void 0)||null;break;case"status":d.attributes.code&&e.states.push(d.attributes.code.textContent)}}return e},b}(),b=function(){function a(a){this.parse=d(this.parse,this),null!=a&&this.parse(a)}return a.prototype.parse=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;for(g=a.getElementsByTagName("query")[0].childNodes,this.identities=[],this.features=[],this.x=[],h=0,k=g.length;k>h;h++)switch(d=g[h],c=d.attributes,d.nodeName){case"identity":for(f={},i=0,l=c.length;l>i;i++)b=c[i],f[b.name]=b.textContent;this.identities.push(f);break;case"feature":this.features.push(c["var"].textContent);break;case"x":if(c=d.childNodes[0].attributes,"FORM_TYPE"===!c["var"].textContent||"hidden"===!c.type.textContent)break;for(n=d.childNodes,j=0,m=n.length;m>j;j++)e=n[j],e.attributes.type||(c=e.attributes,this.x.push({"var":c["var"].textContent,label:c.label.textContent||"",value:e.firstChild.textContent||""}))}return{identities:this.identities,features:this.features,x:this.x}},a}(),a=function(){function a(a,b){this.room=b,this.update=d(this.update,this),this.admin=d(this.admin,this),this.owner=d(this.owner,this),this.revoke=d(this.revoke,this),this.member=d(this.member,this),this.ban=d(this.ban,this),this.modifyAffiliation=d(this.modifyAffiliation,this),this.deop=d(this.deop,this),this.op=d(this.op,this),this.mute=d(this.mute,this),this.voice=d(this.voice,this),this.kick=d(this.kick,this),this.modifyRole=d(this.modifyRole,this),this.update(a)}return a.prototype.modifyRole=function(a,b,c,d){return this.room.modifyRole(this.nick,a,b,c,d)},a.prototype.kick=function(a,b,c){return this.room.kick(this.nick,a,b,c)},a.prototype.voice=function(a,b,c){return this.room.voice(this.nick,a,b,c)},a.prototype.mute=function(a,b,c){return this.room.mute(this.nick,a,b,c)},a.prototype.op=function(a,b,c){return this.room.op(this.nick,a,b,c)},a.prototype.deop=function(a,b,c){return this.room.deop(this.nick,a,b,c)},a.prototype.modifyAffiliation=function(a,b,c,d){return this.room.modifyAffiliation(this.jid,a,b,c,d)},a.prototype.ban=function(a,b,c){return this.room.ban(this.jid,a,b,c)},a.prototype.member=function(a,b,c){return this.room.member(this.jid,a,b,c)},a.prototype.revoke=function(a,b,c){return this.room.revoke(this.jid,a,b,c)},a.prototype.owner=function(a,b,c){return this.room.owner(this.jid,a,b,c)},a.prototype.admin=function(a,b,c){return this.room.admin(this.jid,a,b,c)},a.prototype.update=function(a){return this.nick=a.nick||null,this.affiliation=a.affiliation||null,this.role=a.role||null,this.jid=a.jid||null,this.status=a.status||null,this.show=a.show||null,this},a}()}.call(this);var buildIq;buildIq=function(a,b,c){var d;return d=$iq(b?{type:a,to:b}:{type:a}),d.c("vCard",{xmlns:Strophe.NS.VCARD}),c&&d.cnode(c),d},Strophe.addConnectionPlugin("vcard",{_connection:null,init:function(a){return this._connection=a,Strophe.addNamespace("VCARD","vcard-temp")},get:function(a,b,c){var d;return d=buildIq("get",b),this._connection.sendIQ(d,a,c)},set:function(a,b,c){var d;return d=buildIq("set",c,b),this._connection.sendIQ(d,a,error_rb)}}),Strophe.addConnectionPlugin("disco",{_connection:null,_identities:[],_features:[],_items:[],init:function(a){this._connection=a,this._identities=[],this._features=[],this._items=[],a.addHandler(this._onDiscoInfo.bind(this),Strophe.NS.DISCO_INFO,"iq","get",null,null),a.addHandler(this._onDiscoItems.bind(this),Strophe.NS.DISCO_ITEMS,"iq","get",null,null)},addIdentity:function(a,b,c,d){for(var e=0;e<this._identities.length;e++)if(this._identities[e].category==a&&this._identities[e].type==b&&this._identities[e].name==c&&this._identities[e].lang==d)return!1;return this._identities.push({category:a,type:b,name:c,lang:d}),!0},addFeature:function(a){for(var b=0;b<this._features.length;b++)if(this._features[b]==a)return!1;return this._features.push(a),!0},removeFeature:function(a){for(var b=0;b<this._features.length;b++)if(this._features[b]===a)return this._features.splice(b,1),!0;return!1},addItem:function(a,b,c,d){return c&&!d?!1:(this._items.push({jid:a,name:b,node:c,call_back:d}),!0)},info:function(a,b,c,d,e){var f={xmlns:Strophe.NS.DISCO_INFO};b&&(f.node=b);var g=$iq({from:this._connection.jid,to:a,type:"get"}).c("query",f);this._connection.sendIQ(g,c,d,e)},items:function(a,b,c,d,e){var f={xmlns:Strophe.NS.DISCO_ITEMS};b&&(f.node=b);var g=$iq({from:this._connection.jid,to:a,type:"get"}).c("query",f);this._connection.sendIQ(g,c,d,e)},_buildIQResult:function(a,b){var c=a.getAttribute("id"),d=a.getAttribute("from"),e=$iq({type:"result",id:c});return null!==d&&e.attrs({to:d}),e.c("query",b)},_onDiscoInfo:function(a){var b=a.getElementsByTagName("query")[0].getAttribute("node"),c={xmlns:Strophe.NS.DISCO_INFO};b&&(c.node=b);for(var d=this._buildIQResult(a,c),e=0;e<this._identities.length;e++){var c={category:this._identities[e].category,type:this._identities[e].type};this._identities[e].name&&(c.name=this._identities[e].name),this._identities[e].lang&&(c["xml:lang"]=this._identities[e].lang),d.c("identity",c).up()}for(var e=0;e<this._features.length;e++)d.c("feature",{"var":this._features[e]}).up();return this._connection.send(d.tree()),!0},_onDiscoItems:function(a){var b={xmlns:Strophe.NS.DISCO_ITEMS},c=a.getElementsByTagName("query")[0].getAttribute("node");if(c){b.node=c;for(var d=[],e=0;e<this._items.length;e++)if(this._items[e].node==c){d=this._items[e].call_back(a);break}}else var d=this._items;for(var f=this._buildIQResult(a,b),e=0;e<d.length;e++){var g={jid:d[e].jid};d[e].name&&(g.name=d[e].name),d[e].node&&(g.node=d[e].node),f.c("item",g).up()}return this._connection.send(f.tree()),!0}}),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.5.1";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g in a)if(x.has(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?void 0:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.findWhere=function(a,b){return x.where(a,b,!0)},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};var C=function(a,b,c,d){var e={},f=B(null==b?x.identity:b);return y(a,function(b,g){var h=f.call(c,b,g,a);d(e,h,b)}),e};x.groupBy=function(a,b,c){return C(a,b,c,function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)})},x.countBy=function(a,b,c){return C(a,b,c,function(a,b){x.has(a,b)||(a[b]=0),a[b]++})},x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){return a.apply(this,b.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e=null;return function(){var f=this,g=arguments,h=function(){e=null,c||(d=a.apply(f,g))},i=c&&!e;return clearTimeout(e),e=setTimeout(h,b),i&&(d=a.apply(f,g)),d}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push(a[c]);return b},x.pairs=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push([c,a[c]]);return b},x.invert=function(a){var b={};for(var c in a)x.has(a,c)&&(b[a[c]]=c);return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return void 0;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(){var a,b=this,c=b.Backbone,d=[],e=d.push,f=d.slice,g=d.splice;a="undefined"!=typeof exports?exports:b.Backbone={},a.VERSION="1.0.0";var h=b._;h||"undefined"==typeof require||(h=require("underscore")),a.$=b.jQuery||b.Zepto||b.ender||b.$,a.noConflict=function(){return b.Backbone=c,this},a.emulateHTTP=!1,a.emulateJSON=!1;var i=a.Events={on:function(a,b,c){if(!k(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,c){if(!k(this,"once",a,[b,c])||!b)return this;var d=this,e=h.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c)},off:function(a,b,c){var d,e,f,g,i,j,l,m;if(!this._events||!k(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;for(g=a?[a]:h.keys(this._events),i=0,j=g.length;j>i;i++)if(a=g[i],f=this._events[a]){if(this._events[a]=d=[],b||c)for(l=0,m=f.length;m>l;l++)e=f[l],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&d.push(e);d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=f.call(arguments,1);if(!k(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&l(c,b),d&&l(d,arguments),this},stopListening:function(a,b,c){var d=this._listeners;if(!d)return this;var e=!b&&!c;"object"==typeof b&&(c=this),a&&((d={})[a._listenerId]=a);for(var f in d)d[f].off(b,c,this),e&&delete this._listeners[f];return this}},j=/\s+/,k=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(j.test(c)){for(var f=c.split(j),g=0,h=f.length;h>g;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},l=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},m={listenTo:"on",listenToOnce:"once"};h.each(m,function(a,b){i[b]=function(b,c,d){var e=this._listeners||(this._listeners={}),f=b._listenerId||(b._listenerId=h.uniqueId("l"));return e[f]=b,"object"==typeof c&&(d=this),b[a](c,d,this),this}}),i.bind=i.on,i.unbind=i.off,h.extend(a,i);var n=a.Model=function(a,b){var c,d=a||{};b||(b={}),this.cid=h.uniqueId("c"),this.attributes={},h.extend(this,h.pick(b,o)),b.parse&&(d=this.parse(d,b)||{}),(c=h.result(this,"defaults"))&&(d=h.defaults({},d,c)),this.set(d,b),this.changed={},this.initialize.apply(this,arguments)},o=["url","urlRoot","collection"];h.extend(n.prototype,i,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return h.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return h.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e,f,g,i,j,k,l;if(null==a)return this;if("object"==typeof a?(e=a,c=b):(e={})[a]=b,c||(c={}),!this._validate(e,c))return!1;f=c.unset,i=c.silent,g=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=h.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in e&&(this.id=e[this.idAttribute]);for(d in e)b=e[d],h.isEqual(l[d],b)||g.push(d),h.isEqual(k[d],b)?delete this.changed[d]:this.changed[d]=b,f?delete l[d]:l[d]=b;if(!i){g.length&&(this._pending=!0);for(var m=0,n=g.length;n>m;m++)this.trigger("change:"+g[m],this,l[g[m]],c)}if(j)return this;if(!i)for(;this._pending;)this._pending=!1,this.trigger("change",this,c);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,h.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var c in this.attributes)b[c]=void 0;return this.set(b,h.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!h.isEmpty(this.changed):h.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?h.clone(this.changed):!1;var b,c=!1,d=this._changing?this._previousAttributes:this.attributes;for(var e in a)h.isEqual(d[e],b=a[e])||((c||(c={}))[e]=b);return c},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return h.clone(this._previousAttributes)},fetch:function(a){a=a?h.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d){return b.set(b.parse(d,a),a)?(c&&c(b,d,a),void b.trigger("sync",b,d,a)):!1},L(this,a),this.sync("read",this,a)},save:function(a,b,c){var d,e,f,g=this.attributes;if(null==a||"object"==typeof a?(d=a,c=b):(d={})[a]=b,!(!d||c&&c.wait||this.set(d,c)))return!1;if(c=h.extend({validate:!0},c),!this._validate(d,c))return!1;d&&c.wait&&(this.attributes=h.extend({},g,d)),void 0===c.parse&&(c.parse=!0);var i=this,j=c.success;return c.success=function(a){i.attributes=g;var b=i.parse(a,c);return c.wait&&(b=h.extend(d||{},b)),h.isObject(b)&&!i.set(b,c)?!1:(j&&j(i,a,c),void i.trigger("sync",i,a,c))},L(this,c),e=this.isNew()?"create":c.patch?"patch":"update","patch"===e&&(c.attrs=d),f=this.sync(e,this,c),d&&c.wait&&(this.attributes=g),f},destroy:function(a){a=a?h.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(a.success=function(e){(a.wait||b.isNew())&&d(),c&&c(b,e,a),b.isNew()||b.trigger("sync",b,e,a)},this.isNew())return a.success(),!1;L(this,a);var e=this.sync("delete",this,a);return a.wait||d(),e},url:function(){var a=h.result(this,"urlRoot")||h.result(this.collection,"url")||K();return this.isNew()?a:a+("/"===a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(a){return this._validate({},h.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=h.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;return c?(this.trigger("invalid",this,c,h.extend(b||{},{validationError:c})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];h.each(p,function(a){n.prototype[a]=function(){var b=f.call(arguments);return b.unshift(this.attributes),h[a].apply(h,b)}});var q=a.Collection=function(a,b){b||(b={}),b.url&&(this.url=b.url),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,h.extend({silent:!0},b))},r={add:!0,remove:!0,merge:!0},s={add:!0,merge:!1,remove:!1};h.extend(q.prototype,i,{model:n,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return a.sync.apply(this,arguments)},add:function(a,b){return this.set(a,h.defaults(b||{},s))},remove:function(a,b){a=h.isArray(a)?a.slice():[a],b||(b={});var c,d,e,f;for(c=0,d=a.length;d>c;c++)f=this.get(a[c]),f&&(delete this._byId[f.id],delete this._byId[f.cid],e=this.indexOf(f),this.models.splice(e,1),this.length--,b.silent||(b.index=e,f.trigger("remove",f,this,b)),this._removeReference(f));return this},set:function(a,b){b=h.defaults(b||{},r),b.parse&&(a=this.parse(a,b)),h.isArray(a)||(a=a?[a]:[]);var c,d,f,i,j,k=b.at,l=this.comparator&&null==k&&b.sort!==!1,m=h.isString(this.comparator)?this.comparator:null,n=[],o=[],p={};for(c=0,d=a.length;d>c;c++)(f=this._prepareModel(a[c],b))&&((i=this.get(f))?(b.remove&&(p[i.cid]=!0),b.merge&&(i.set(f.attributes,b),l&&!j&&i.hasChanged(m)&&(j=!0))):b.add&&(n.push(f),f.on("all",this._onModelEvent,this),this._byId[f.cid]=f,null!=f.id&&(this._byId[f.id]=f)));if(b.remove){for(c=0,d=this.length;d>c;++c)p[(f=this.models[c]).cid]||o.push(f);o.length&&this.remove(o,b)}if(n.length&&(l&&(j=!0),this.length+=n.length,null!=k?g.apply(this.models,[k,0].concat(n)):e.apply(this.models,n)),j&&this.sort({silent:!0}),b.silent)return this;for(c=0,d=n.length;d>c;c++)(f=n[c]).trigger("add",f,this,b);return j&&this.trigger("sort",this,b),this},reset:function(a,b){b||(b={});for(var c=0,d=this.models.length;d>c;c++)this._removeReference(this.models[c]);return b.previousModels=this.models,this._reset(),this.add(a,h.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),this},push:function(a,b){return a=this._prepareModel(a,b),this.add(a,h.extend({at:this.length},b)),a},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return a=this._prepareModel(a,b),this.add(a,h.extend({at:0},b)),a},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(a,b){return this.models.slice(a,b)},get:function(a){return null==a?void 0:this._byId[null!=a.id?a.id:a.cid||a]},at:function(a){return this.models[a]},where:function(a,b){return h.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)
},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),h.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(h.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},sortedIndex:function(a,b,c){b||(b=this.comparator);var d=h.isFunction(b)?b:function(a){return a.get(b)};return h.sortedIndex(this.models,a,d,c)},pluck:function(a){return h.invoke(this.models,"get",a)},fetch:function(a){a=a?h.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=a.success,c=this;return a.success=function(d){var e=a.reset?"reset":"set";c[e](d,a),b&&b(c,d,a),c.trigger("sync",c,d,a)},L(this,a),this.sync("read",this,a)},create:function(a,b){if(b=b?h.clone(b):{},!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,d=b.success;return b.success=function(e){b.wait&&c.add(a,b),d&&d(a,e,b)},a.save(null,b),a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(a instanceof n)return a.collection||(a.collection=this),a;b||(b={}),b.collection=this;var c=new this.model(a,b);return c._validate(a,b)?c:(this.trigger("invalid",this,a,b),!1)},_removeReference:function(a){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var t=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];h.each(t,function(a){q.prototype[a]=function(){var b=f.call(arguments);return b.unshift(this.models),h[a].apply(h,b)}});var u=["groupBy","countBy","sortBy"];h.each(u,function(a){q.prototype[a]=function(b,c){var d=h.isFunction(b)?b:function(a){return a.get(b)};return h[a](this.models,d,c)}});var v=a.View=function(a){this.cid=h.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];h.extend(v.prototype,i,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(b,c){return this.$el&&this.undelegateEvents(),this.$el=b instanceof a.$?b:a.$(b),this.el=this.$el[0],c!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=h.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var c=a[b];if(h.isFunction(c)||(c=this[a[b]]),c){var d=b.match(w),e=d[1],f=d[2];c=h.bind(c,this),e+=".delegateEvents"+this.cid,""===f?this.$el.on(e,c):this.$el.on(e,f,c)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(a){this.options&&(a=h.extend({},h.result(this,"options"),a)),h.extend(this,h.pick(a,x)),this.options=a},_ensureElement:function(){if(this.el)this.setElement(h.result(this,"el"),!1);else{var b=h.extend({},h.result(this,"attributes"));this.id&&(b.id=h.result(this,"id")),this.className&&(b["class"]=h.result(this,"className"));var c=a.$("<"+h.result(this,"tagName")+">").attr(b);this.setElement(c,!1)}}}),a.sync=function(b,c,d){var e=y[b];h.defaults(d||(d={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var f={type:e,dataType:"json"};if(d.url||(f.url=h.result(c,"url")||K()),null!=d.data||!c||"create"!==b&&"update"!==b&&"patch"!==b||(f.contentType="application/json",f.data=JSON.stringify(d.attrs||c.toJSON(d))),d.emulateJSON&&(f.contentType="application/x-www-form-urlencoded",f.data=f.data?{model:f.data}:{}),d.emulateHTTP&&("PUT"===e||"DELETE"===e||"PATCH"===e)){f.type="POST",d.emulateJSON&&(f.data._method=e);var g=d.beforeSend;d.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",e),g?g.apply(this,arguments):void 0}}"GET"===f.type||d.emulateJSON||(f.processData=!1),"PATCH"!==f.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(f.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var i=d.xhr=a.ajax(h.extend(f,d));return c.trigger("request",c,i,d),i};var y={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var z=a.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,B=/(\(\?)?:\w+/g,C=/\*\w+/g,D=/[\-{}\[\]+?.,\\\^$|#\s]/g;h.extend(z.prototype,i,{initialize:function(){},route:function(b,c,d){h.isRegExp(b)||(b=this._routeToRegExp(b)),h.isFunction(c)&&(d=c,c=""),d||(d=this[c]);var e=this;return a.history.route(b,function(f){var g=e._extractParameters(b,f);d&&d.apply(e,g),e.trigger.apply(e,["route:"+c].concat(g)),e.trigger("route",c,g),a.history.trigger("route",e,c,g)}),this},navigate:function(b,c){return a.history.navigate(b,c),this},_bindRoutes:function(){if(this.routes){this.routes=h.result(this,"routes");for(var a,b=h.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(D,"\\$&").replace(A,"(?:$1)?").replace(B,function(a,b){return b?a:"([^/]+)"}).replace(C,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return h.map(c,function(a){return a?decodeURIComponent(a):null})}});var E=a.History=function(){this.handlers=[],h.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},F=/^[#\/]|\s+$/g,G=/^\/+|\/+$/g,H=/msie [\w.]+/,I=/\/$/;E.started=!1,h.extend(E.prototype,i,{interval:50,getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=this.location.pathname;var c=this.root.replace(I,"");a.indexOf(c)||(a=a.substr(c.length))}else a=this.getHash();return a.replace(F,"")},start:function(b){if(E.started)throw new Error("Backbone.history has already been started");E.started=!0,this.options=h.extend({},{root:"/"},this.options,b),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var c=this.getFragment(),d=document.documentMode,e=H.exec(navigator.userAgent.toLowerCase())&&(!d||7>=d);this.root=("/"+this.root+"/").replace(G,"/"),e&&this._wantsHashChange&&(this.iframe=a.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(c)),this._hasPushState?a.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!e?a.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=c;var f=this.location,g=f.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!g?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&g&&f.hash&&(this.fragment=this.getHash().replace(F,""),this.history.replaceState({},document.title,this.root+this.fragment+f.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){a.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),E.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();return a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe))),a===this.fragment?!1:(this.iframe&&this.navigate(a),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(a){var b=this.fragment=this.getFragment(a),c=h.any(this.handlers,function(a){return a.route.test(b)?(a.callback(b),!0):void 0});return c},navigate:function(a,b){if(!E.started)return!1;if(b&&b!==!0||(b={trigger:b}),a=this.getFragment(a||""),this.fragment!==a){this.fragment=a;var c=this.root+a;if(this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}b.trigger&&this.loadUrl(a)}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),a.history=new E;var J=function(a,b){var c,d=this;c=a&&h.has(a,"constructor")?a.constructor:function(){return d.apply(this,arguments)},h.extend(c,d,b);var e=function(){this.constructor=c};return e.prototype=d.prototype,c.prototype=new e,a&&h.extend(c.prototype,a),c.__super__=d.prototype,c};n.extend=q.extend=z.extend=v.extend=E.extend=J;var K=function(){throw new Error('A "url" property or function must be specified')},L=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}}}.call(this),function(a,b){"object"==typeof exports&&a.require?module.exports=b(require("underscore"),require("backbone")):"function"==typeof define&&define.amd?define(["underscore","backbone"],function(c,d){return b(c||a._,d||a.Backbone)}):b(_,Backbone)}(this,function(a,b){function c(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function d(){return c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c()}return b.LocalStorage=window.Store=function(a){if(!this.localStorage)throw"Backbone.localStorage: Environment does not support localStorage.";this.name=a;var b=this.localStorage().getItem(this.name);this.records=b&&b.split(",")||[]},a.extend(b.LocalStorage.prototype,{save:function(){this.localStorage().setItem(this.name,this.records.join(","))},create:function(a){return a.id||(a.id=d(),a.set(a.idAttribute,a.id)),this.localStorage().setItem(this.name+"-"+a.id,JSON.stringify(a)),this.records.push(a.id.toString()),this.save(),this.find(a)},update:function(b){return this.localStorage().setItem(this.name+"-"+b.id,JSON.stringify(b)),a.include(this.records,b.id.toString())||this.records.push(b.id.toString()),this.save(),this.find(b)},find:function(a){return this.jsonData(this.localStorage().getItem(this.name+"-"+a.id))},findAll:function(){return(a.chain||a)(this.records).map(function(a){return this.jsonData(this.localStorage().getItem(this.name+"-"+a))},this).compact().value()},destroy:function(b){return b.isNew()?!1:(this.localStorage().removeItem(this.name+"-"+b.id),this.records=a.reject(this.records,function(a){return a===b.id.toString()}),this.save(),b)},localStorage:function(){return localStorage},jsonData:function(a){return a&&JSON.parse(a)},_clear:function(){var b=this.localStorage(),c=new RegExp("^"+this.name+"-");b.removeItem(this.name),(a.chain||a)(b).keys().filter(function(a){return c.test(a)}).each(function(a){b.removeItem(a)}),this.records.length=0},_storageSize:function(){return this.localStorage().length}}),b.LocalStorage.sync=window.Store.sync=b.localSync=function(a,c,d){var e,f,g=c.localStorage||c.collection.localStorage,h=b.$.Deferred&&b.$.Deferred();try{switch(a){case"read":e=void 0!=c.id?g.find(c):g.findAll();break;case"create":e=g.create(c);break;case"update":e=g.update(c);break;case"delete":e=g.destroy(c)}}catch(i){f=22===i.code&&0===g._storageSize()?"Private browsing is unsupported":i.message}return e?(d&&d.success&&("0.9.10"===b.VERSION?d.success(c,e,d):d.success(e)),h&&h.resolve(e)):(f=f?f:"Record Not Found",d&&d.error&&("0.9.10"===b.VERSION?d.error(c,f,d):d.error(f)),h&&h.reject(f)),d&&d.complete&&d.complete(e),h&&h.promise()},b.ajaxSync=b.sync,b.getSyncMethod=function(a){return a.localStorage||a.collection&&a.collection.localStorage?b.localSync:b.ajaxSync},b.sync=function(a,c,d){return b.getSyncMethod(c).apply(this,[a,c,d])},b.LocalStorage}),function(a,b){"use strict";function c(a){return a&&a.toLowerCase?a.toLowerCase():a}function d(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]==b)return!e;return e}var e=!1,f=null,g=parseFloat,h=Math.min,i=/(-?\d+\.?\d*)$/g,j=/(\d+\.?\d*)$/g,k=[],l=[],m=function(a){return"string"==typeof a},n=function(a,b){for(var c,d=a.length,e=d;e--;)c=d-e-1,b(a[c],c)},o=Array.prototype.indexOf||function(a){var b=this.length,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1};a.tinysort={id:"TinySort",version:"1.5.6",copyright:"Copyright (c) 2008-2013 Ron Valstar",uri:"http://tinysort.sjeiti.com/",licensed:{MIT:"http://www.opensource.org/licenses/mit-license.php",GPL:"http://www.gnu.org/licenses/gpl.html"},plugin:function(){var a=function(a,b){k.push(a),l.push(b)};return a.indexOf=o,a}(),defaults:{order:"asc",attr:f,data:f,useVal:e,place:"start",returns:e,cases:e,forceStrings:e,ignoreDashes:e,sortFunction:f}},a.fn.extend({tinysort:function(){var p,q,r,s,t=this,u=[],v=[],w=[],x=[],y=0,z=[],A=[],B=function(a){n(k,function(b){b.call(b,a)})},C=function(a,b){return"string"==typeof b&&(a.cases||(b=c(b)),b=b.replace(/^\s*(.*?)\s*$/i,"$1")),b},D=function(a,b){var c=0;for(0!==y&&(y=0);0===c&&s>y;){var d=x[y],f=d.oSettings,h=f.ignoreDashes?j:i;if(B(f),f.sortFunction)c=f.sortFunction(a,b);else if("rand"==f.order)c=Math.random()<.5?1:-1;else{var k=e,o=C(f,a.s[y]),p=C(f,b.s[y]);if(!f.forceStrings){var q=m(o)?o&&o.match(h):e,r=m(p)?p&&p.match(h):e;if(q&&r){var t=o.substr(0,o.length-q[0].length),u=p.substr(0,p.length-r[0].length);t==u&&(k=!e,o=g(q[0]),p=g(r[0]))}}c=d.iAsc*(p>o?-1:o>p?1:0)}n(l,function(a){c=a.call(a,k,o,p,c)}),0===c&&y++}return c};for(p=0,r=arguments.length;r>p;p++){var E=arguments[p];m(E)?z.push(E)-1>A.length&&(A.length=z.length-1):A.push(E)>z.length&&(z.length=A.length)}for(z.length>A.length&&(A.length=z.length),s=z.length,0===s&&(s=z.length=1,A.push({})),p=0,r=s;r>p;p++){var F=z[p],G=a.extend({},a.tinysort.defaults,A[p]),H=!(!F||""===F),I=H&&":"===F[0];x.push({sFind:F,oSettings:G,bFind:H,bAttr:!(G.attr===f||""===G.attr),bData:G.data!==f,bFilter:I,$Filter:I?t.filter(F):t,fnSort:G.sortFunction,iAsc:"asc"==G.order?1:-1})}return t.each(function(c,d){var e,f=a(d),g=f.parent().get(0),h=[];for(q=0;s>q;q++){var i=x[q],j=i.bFind?i.bFilter?i.$Filter.filter(d):f.find(i.sFind):f;h.push(i.bData?j.data(i.oSettings.data):i.bAttr?j.attr(i.oSettings.attr):i.oSettings.useVal?j.val():j.text()),e===b&&(e=j)}var k=o.call(w,g);0>k&&(k=w.push(g)-1,v[k]={s:[],n:[]}),e.length>0?v[k].s.push({s:h,e:f,n:c}):v[k].n.push({e:f,n:c})}),n(v,function(a){a.s.sort(D)}),n(v,function(a){var b=a.s,c=a.n,f=b.length,g=c.length,i=f+g,j=[],k=i,l=[0,0];switch(G.place){case"first":n(b,function(a){k=h(k,a.n)});break;case"org":n(b,function(a){j.push(a.n)});break;case"end":k=g;break;default:k=0}for(p=0;i>p;p++){var m=d(j,p)?!e:p>=k&&k+f>p,o=m?0:1,q=(m?b:c)[l[o]].e;q.parent().append(q),(m||!G.returns)&&u.push(q.get(0)),l[o]++}}),t.length=0,Array.prototype.push.apply(t,u),t}}),a.fn.TinySort=a.fn.Tinysort=a.fn.tsort=a.fn.tinysort}(jQuery),function(a,b){function c(a){return l.PF.compile(a||"nplurals=2; plural=(n != 1);")}function d(a,b){this._key=a,this._i18n=b}var e=Array.prototype,f=Object.prototype,g=e.slice,h=f.hasOwnProperty,i=e.forEach,j={},k={forEach:function(a,b,c){var d,e,f;if(null!==a)if(i&&a.forEach===i)a.forEach(b,c);else if(a.length===+a.length){for(d=0,e=a.length;e>d;d++)if(d in a&&b.call(c,a[d],d,a)===j)return}else for(f in a)if(h.call(a,f)&&b.call(c,a[f],f,a)===j)return},extend:function(a){return this.forEach(g.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a}},l=function(a){if(this.defaults={locale_data:{messages:{"":{domain:"messages",lang:"en",plural_forms:"nplurals=2; plural=(n != 1);"}}},domain:"messages"},this.options=k.extend({},this.defaults,a),this.textdomain(this.options.domain),a.domain&&!this.options.locale_data[this.options.domain])throw new Error("Text domain set to non-existent domain: `"+a.domain+"`")};l.context_delimiter=String.fromCharCode(4),k.extend(d.prototype,{onDomain:function(a){return this._domain=a,this},withContext:function(a){return this._context=a,this},ifPlural:function(a,b){return this._val=a,this._pkey=b,this},fetch:function(a){return"[object Array]"!={}.toString.call(a)&&(a=[].slice.call(arguments)),(a&&a.length?l.sprintf:function(a){return a})(this._i18n.dcnpgettext(this._domain,this._context,this._key,this._pkey,this._val),a)}}),k.extend(l.prototype,{translate:function(a){return new d(a,this)},textdomain:function(a){return a?void(this._textdomain=a):this._textdomain},gettext:function(a){return this.dcnpgettext.call(this,b,b,a)},dgettext:function(a,c){return this.dcnpgettext.call(this,a,b,c)},dcgettext:function(a,c){return this.dcnpgettext.call(this,a,b,c)},ngettext:function(a,c,d){return this.dcnpgettext.call(this,b,b,a,c,d)},dngettext:function(a,c,d,e){return this.dcnpgettext.call(this,a,b,c,d,e)},dcngettext:function(a,c,d,e){return this.dcnpgettext.call(this,a,b,c,d,e)},pgettext:function(a,c){return this.dcnpgettext.call(this,b,a,c)},dpgettext:function(a,b,c){return this.dcnpgettext.call(this,a,b,c)},dcpgettext:function(a,b,c){return this.dcnpgettext.call(this,a,b,c)},npgettext:function(a,c,d,e){return this.dcnpgettext.call(this,b,a,c,d,e)},dnpgettext:function(a,b,c,d,e){return this.dcnpgettext.call(this,a,b,c,d,e)},dcnpgettext:function(a,b,d,e,f){e=e||d,a=a||this._textdomain,f="undefined"==typeof f?1:f;var g;if(!this.options)return g=new l,g.dcnpgettext.call(g,void 0,void 0,d,e,f);if(!this.options.locale_data)throw new Error("No locale data provided.");if(!this.options.locale_data[a])throw new Error("Domain `"+a+"` was not found.");if(!this.options.locale_data[a][""])throw new Error("No locale meta information provided.");if(!d)throw new Error("No translation key found.");if("number"!=typeof f&&(f=parseInt(f,10),isNaN(f)))throw new Error("The number that was passed in is not a number.");var h,i,j=b?b+l.context_delimiter+d:d,k=this.options.locale_data,m=k[a],n=m[""].plural_forms||(k.messages||this.defaults.locale_data.messages)[""].plural_forms,o=c(n)(f)+1;if(!m)throw new Error("No domain named `"+a+"` could be found.");return h=m[j],!h||o>=h.length?(this.options.missing_key_callback&&this.options.missing_key_callback(j),i=[null,d,e],i[c(n)(f)+1]):(i=h[o],i?i:(i=[null,d,e],i[c(n)(f)+1]))}});var m=function(){function a(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}function b(a,b){for(var c=[];b>0;c[--b]=a);return c.join("")}var c=function(){return c.cache.hasOwnProperty(arguments[0])||(c.cache[arguments[0]]=c.parse(arguments[0])),c.format.call(null,c.cache[arguments[0]],arguments)};return c.format=function(c,d){var e,f,g,h,i,j,k,l=1,n=c.length,o="",p=[];for(f=0;n>f;f++)if(o=a(c[f]),"string"===o)p.push(c[f]);else if("array"===o){if(h=c[f],h[2])for(e=d[l],g=0;g<h[2].length;g++){if(!e.hasOwnProperty(h[2][g]))throw m('[sprintf] property "%s" does not exist',h[2][g]);e=e[h[2][g]]}else e=h[1]?d[h[1]]:d[l++];if(/[^s]/.test(h[8])&&"number"!=a(e))throw m("[sprintf] expecting number but found %s",a(e));switch(("undefined"==typeof e||null===e)&&(e=""),h[8]){case"b":e=e.toString(2);break;case"c":e=String.fromCharCode(e);break;case"d":e=parseInt(e,10);break;case"e":e=h[7]?e.toExponential(h[7]):e.toExponential();break;case"f":e=h[7]?parseFloat(e).toFixed(h[7]):parseFloat(e);break;case"o":e=e.toString(8);break;case"s":e=(e=String(e))&&h[7]?e.substring(0,h[7]):e;break;case"u":e=Math.abs(e);break;case"x":e=e.toString(16);break;case"X":e=e.toString(16).toUpperCase()}e=/[def]/.test(h[8])&&h[3]&&e>=0?"+"+e:e,j=h[4]?"0"==h[4]?"0":h[4].charAt(1):" ",k=h[6]-String(e).length,i=h[6]?b(j,k):"",p.push(h[5]?e+i:i+e)}return p.join("")},c.cache={},c.parse=function(a){for(var b=a,c=[],d=[],e=0;b;){if(null!==(c=/^[^\x25]+/.exec(b)))d.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(b)))d.push("%");else{if(null===(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw"[sprintf] huh?";if(c[2]){e|=1;var f=[],g=c[2],h=[];if(null===(h=/^([a-z_][a-z_\d]*)/i.exec(g)))throw"[sprintf] huh?";for(f.push(h[1]);""!==(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]);else{if(null===(h=/^\[(\d+)\]/.exec(g)))throw"[sprintf] huh?";f.push(h[1])}c[2]=f}else e|=2;if(3===e)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";d.push(c)}b=b.substring(c[0].length)}return d},c}(),n=function(a,b){return b.unshift(a),m.apply(null,b)};l.parse_plural=function(a,b){return a=a.replace(/n/g,b),l.parse_expression(a)},l.sprintf=function(a,b){return"[object Array]"=={}.toString.call(b)?n(a,[].slice.call(b)):m.apply(this,[].slice.call(arguments))},l.prototype.sprintf=function(){return l.sprintf.apply(this,arguments)},l.PF={},l.PF.parse=function(a){var b=l.PF.extractPluralExpr(a);return l.PF.parser.parse.call(l.PF.parser,b)},l.PF.compile=function(a){function b(a){return a===!0?1:a?a:0}var c=l.PF.parse(a);return function(a){return b(l.PF.interpreter(c)(a))}},l.PF.interpreter=function(a){return function(b){switch(a.type){case"GROUP":return l.PF.interpreter(a.expr)(b);case"TERNARY":return l.PF.interpreter(a.expr)(b)?l.PF.interpreter(a.truthy)(b):l.PF.interpreter(a.falsey)(b);case"OR":return l.PF.interpreter(a.left)(b)||l.PF.interpreter(a.right)(b);case"AND":return l.PF.interpreter(a.left)(b)&&l.PF.interpreter(a.right)(b);case"LT":return l.PF.interpreter(a.left)(b)<l.PF.interpreter(a.right)(b);case"GT":return l.PF.interpreter(a.left)(b)>l.PF.interpreter(a.right)(b);case"LTE":return l.PF.interpreter(a.left)(b)<=l.PF.interpreter(a.right)(b);case"GTE":return l.PF.interpreter(a.left)(b)>=l.PF.interpreter(a.right)(b);case"EQ":return l.PF.interpreter(a.left)(b)==l.PF.interpreter(a.right)(b);case"NEQ":return l.PF.interpreter(a.left)(b)!=l.PF.interpreter(a.right)(b);case"MOD":return l.PF.interpreter(a.left)(b)%l.PF.interpreter(a.right)(b);case"VAR":return b;case"NUM":return a.val;default:throw new Error("Invalid Token found.")}}},l.PF.extractPluralExpr=function(a){a=a.replace(/^\s\s*/,"").replace(/\s\s*$/,""),/;\s*$/.test(a)||(a=a.concat(";"));var b,c=/nplurals\=(\d+);/,d=/plural\=(.*);/,e=a.match(c),f={};if(!(e.length>1))throw new Error("nplurals not found in plural_forms string: "+a);if(f.nplurals=e[1],a=a.replace(c,""),b=a.match(d),!(b&&b.length>1))throw new Error("`plural` expression not found: "+a);return b[1]},l.PF.parser=function(){var a={trace:function(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,"?":6,":":7,"||":8,"&&":9,"<":10,"<=":11,">":12,">=":13,"!=":14,"==":15,"%":16,"(":17,")":18,n:19,NUMBER:20,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",6:"?",7:":",8:"||",9:"&&",10:"<",11:"<=",12:">",13:">=",14:"!=",15:"==",16:"%",17:"(",18:")",19:"n",20:"NUMBER"},productions_:[0,[3,2],[4,5],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,1],[4,1]],performAction:function(a,b,c,d,e,f){var g=f.length-1;switch(e){case 1:return{type:"GROUP",expr:f[g-1]};case 2:this.$={type:"TERNARY",expr:f[g-4],truthy:f[g-2],falsey:f[g]};break;case 3:this.$={type:"OR",left:f[g-2],right:f[g]};break;case 4:this.$={type:"AND",left:f[g-2],right:f[g]};break;case 5:this.$={type:"LT",left:f[g-2],right:f[g]};break;case 6:this.$={type:"LTE",left:f[g-2],right:f[g]};break;case 7:this.$={type:"GT",left:f[g-2],right:f[g]};break;case 8:this.$={type:"GTE",left:f[g-2],right:f[g]};break;case 9:this.$={type:"NEQ",left:f[g-2],right:f[g]};break;case 10:this.$={type:"EQ",left:f[g-2],right:f[g]};break;case 11:this.$={type:"MOD",left:f[g-2],right:f[g]};break;case 12:this.$={type:"GROUP",expr:f[g-1]};break;case 13:this.$={type:"VAR"};break;case 14:this.$={type:"NUM",val:Number(a)}}},table:[{3:1,4:2,17:[1,3],19:[1,4],20:[1,5]},{1:[3]},{5:[1,6],6:[1,7],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16]},{4:17,17:[1,3],19:[1,4],20:[1,5]},{5:[2,13],6:[2,13],7:[2,13],8:[2,13],9:[2,13],10:[2,13],11:[2,13],12:[2,13],13:[2,13],14:[2,13],15:[2,13],16:[2,13],18:[2,13]},{5:[2,14],6:[2,14],7:[2,14],8:[2,14],9:[2,14],10:[2,14],11:[2,14],12:[2,14],13:[2,14],14:[2,14],15:[2,14],16:[2,14],18:[2,14]},{1:[2,1]},{4:18,17:[1,3],19:[1,4],20:[1,5]},{4:19,17:[1,3],19:[1,4],20:[1,5]},{4:20,17:[1,3],19:[1,4],20:[1,5]},{4:21,17:[1,3],19:[1,4],20:[1,5]},{4:22,17:[1,3],19:[1,4],20:[1,5]},{4:23,17:[1,3],19:[1,4],20:[1,5]},{4:24,17:[1,3],19:[1,4],20:[1,5]},{4:25,17:[1,3],19:[1,4],20:[1,5]},{4:26,17:[1,3],19:[1,4],20:[1,5]},{4:27,17:[1,3],19:[1,4],20:[1,5]},{6:[1,7],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[1,28]},{6:[1,7],7:[1,29],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16]},{5:[2,3],6:[2,3],7:[2,3],8:[2,3],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,3]},{5:[2,4],6:[2,4],7:[2,4],8:[2,4],9:[2,4],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,4]},{5:[2,5],6:[2,5],7:[2,5],8:[2,5],9:[2,5],10:[2,5],11:[2,5],12:[2,5],13:[2,5],14:[2,5],15:[2,5],16:[1,16],18:[2,5]},{5:[2,6],6:[2,6],7:[2,6],8:[2,6],9:[2,6],10:[2,6],11:[2,6],12:[2,6],13:[2,6],14:[2,6],15:[2,6],16:[1,16],18:[2,6]},{5:[2,7],6:[2,7],7:[2,7],8:[2,7],9:[2,7],10:[2,7],11:[2,7],12:[2,7],13:[2,7],14:[2,7],15:[2,7],16:[1,16],18:[2,7]},{5:[2,8],6:[2,8],7:[2,8],8:[2,8],9:[2,8],10:[2,8],11:[2,8],12:[2,8],13:[2,8],14:[2,8],15:[2,8],16:[1,16],18:[2,8]},{5:[2,9],6:[2,9],7:[2,9],8:[2,9],9:[2,9],10:[2,9],11:[2,9],12:[2,9],13:[2,9],14:[2,9],15:[2,9],16:[1,16],18:[2,9]},{5:[2,10],6:[2,10],7:[2,10],8:[2,10],9:[2,10],10:[2,10],11:[2,10],12:[2,10],13:[2,10],14:[2,10],15:[2,10],16:[1,16],18:[2,10]},{5:[2,11],6:[2,11],7:[2,11],8:[2,11],9:[2,11],10:[2,11],11:[2,11],12:[2,11],13:[2,11],14:[2,11],15:[2,11],16:[2,11],18:[2,11]},{5:[2,12],6:[2,12],7:[2,12],8:[2,12],9:[2,12],10:[2,12],11:[2,12],12:[2,12],13:[2,12],14:[2,12],15:[2,12],16:[2,12],18:[2,12]},{4:30,17:[1,3],19:[1,4],20:[1,5]},{5:[2,2],6:[1,7],7:[2,2],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,2]}],defaultActions:{6:[2,1]},parseError:function(a){throw new Error(a)},parse:function(a){function b(a){e.length=e.length-2*a,f.length=f.length-a,g.length=g.length-a}function c(){var a;return a=d.lexer.lex()||1,"number"!=typeof a&&(a=d.symbols_[a]||a),a}var d=this,e=[0],f=[null],g=[],h=this.table,i="",j=0,k=0,l=0,m=2,n=1;this.lexer.setInput(a),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var o=this.lexer.yylloc;g.push(o),"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,q,r,s,t,u,v,w,x,y={};;){if(r=e[e.length-1],this.defaultActions[r]?s=this.defaultActions[r]:(null==p&&(p=c()),s=h[r]&&h[r][p]),"undefined"==typeof s||!s.length||!s[0]){if(!l){x=[];for(u in h[r])this.terminals_[u]&&u>2&&x.push("'"+this.terminals_[u]+"'");var z="";z=this.lexer.showPosition?"Parse error on line "+(j+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+x.join(", ")+", got '"+this.terminals_[p]+"'":"Parse error on line "+(j+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(z,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:o,expected:x})}if(3==l){if(p==n)throw new Error(z||"Parsing halted.");k=this.lexer.yyleng,i=this.lexer.yytext,j=this.lexer.yylineno,o=this.lexer.yylloc,p=c()}for(;;){if(m.toString()in h[r])break;if(0==r)throw new Error(z||"Parsing halted.");b(1),r=e[e.length-1]}q=p,p=m,r=e[e.length-1],s=h[r]&&h[r][m],l=3}if(s[0]instanceof Array&&s.length>1)throw new Error("Parse Error: multiple actions possible at state: "+r+", token: "+p);switch(s[0]){case 1:e.push(p),f.push(this.lexer.yytext),g.push(this.lexer.yylloc),e.push(s[1]),p=null,q?(p=q,q=null):(k=this.lexer.yyleng,i=this.lexer.yytext,j=this.lexer.yylineno,o=this.lexer.yylloc,l>0&&l--);break;case 2:if(v=this.productions_[s[1]][1],y.$=f[f.length-v],y._$={first_line:g[g.length-(v||1)].first_line,last_line:g[g.length-1].last_line,first_column:g[g.length-(v||1)].first_column,last_column:g[g.length-1].last_column},t=this.performAction.call(y,i,k,j,this.yy,s[1],f,g),"undefined"!=typeof t)return t;v&&(e=e.slice(0,-1*v*2),f=f.slice(0,-1*v),g=g.slice(0,-1*v)),e.push(this.productions_[s[1]][0]),f.push(y.$),g.push(y._$),w=h[e[e.length-2]][e[e.length-1]],e.push(w);break;case 3:return!0}}return!0}},b=function(){var a={EOF:1,parseError:function(a,b){if(!this.yy.parseError)throw new Error(a);this.yy.parseError(a,b)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.match+=a,this.matched+=a;var b=a.match(/\n/);return b&&this.yylineno++,this._input=this._input.slice(1),a},unput:function(a){return this._input=a+this._input,this},more:function(){return this._more=!0,this},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=new Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c;this._more||(this.yytext="",this.match="");for(var d=this._currentRules(),e=0;e<d.length;e++)if(b=this._input.match(this.rules[d[e]]))return c=b[0].match(/\n.*/g),c&&(this.yylineno+=c.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:c?c[c.length-1].length-1:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,d[e],this.conditionStack[this.conditionStack.length-1]),a?a:void 0;return""===this._input?this.EOF:void this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return"undefined"!=typeof a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)}};return a.performAction=function(a,b,c,d){switch(c){case 0:break;case 1:return 20;case 2:return 19;case 3:return 8;case 4:return 9;case 5:return 6;case 6:return 7;case 7:return 11;case 8:return 13;case 9:return 10;case 10:return 12;case 11:return 14;case 12:return 15;case 13:return 16;case 14:return 17;case 15:return 18;case 16:return 5;case 17:return"INVALID"}},a.rules=[/^\s+/,/^[0-9]+(\.[0-9]+)?\b/,/^n\b/,/^\|\|/,/^&&/,/^\?/,/^:/,/^<=/,/^>=/,/^</,/^>/,/^!=/,/^==/,/^%/,/^\(/,/^\)/,/^$/,/^./],a.conditions={INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],inclusive:!0}},a}();return a.lexer=b,a}(),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=l),exports.Jed=l):("function"==typeof define&&define.amd&&define("jed",function(){return l
}),a.Jed=l)}(this),function(a,b){var c={domain:"converse",locale_data:{converse:{"":{domain:"converse",lang:"en",plural_forms:"nplurals=2; plural=(n != 1);"}}}};"function"==typeof define&&define.amd?define("en",["jed"],function(){return b(new Jed(c))}):(window.locales||(window.locales={}),window.locales.en=b(new Jed(c)))}(this,function(a){return a}),function(a,b){("undefined"==typeof console||"undefined"==typeof console.log)&&(console={log:function(){},error:function(){}}),"function"==typeof define&&define.amd?define("converse",["converse-dependencies"],function(a){return _.templateSettings={evaluate:/\{\[([\s\S]+?)\]\}/g,interpolate:/\{\{([\s\S]+?)\}\}/g},"undefined"!=typeof a?b(jQuery,_,a.OTR,a.DSA,console):b(jQuery,_,void 0,void 0,console)}):(_.templateSettings={evaluate:/\{\[([\s\S]+?)\]\}/g,interpolate:/\{\{([\s\S]+?)\}\}/g},a.converse="undefined"!=typeof OTR&&"undefined"!=typeof DSA?b(jQuery,_,OTR,DSA,console):b(jQuery,_,void 0,void 0,console))}(this,function(a,b,c,d,e){a.fn.addHyperlinks=function(){return this.length>0&&this.each(function(b,c){var d=a(c).html(),e=d.match(/\b(https?:\/\/|www\.|https?:\/\/www\.)[^\s<]{2,200}\b/g);if(e)for(b=0;b<e.length;b++){var f=0===e[b].indexOf("http://")||0===e[b].indexOf("https://")?"":"http://",g=encodeURI(decodeURI(e[b])).replace(/[!'()]/g,escape).replace(/\*/g,"%2A");d=d.replace(e[b],"<a target='_blank' href='"+f+g+"'>"+e[b]+"</a>")}a(c).html(d)}),this},a.fn.addEmoticons=function(){return f.show_emoticons&&this.length>0&&this.each(function(b,c){var d=a(c).html();d=d.replace(/:\)/g,'<span class="emoticon icon-smiley"></span>'),d=d.replace(/:\-\)/g,'<span class="emoticon icon-smiley"></span>'),d=d.replace(/;\)/g,'<span class="emoticon icon-wink"></span>'),d=d.replace(/;\-\)/g,'<span class="emoticon icon-wink"></span>'),d=d.replace(/:D/g,'<span class="emoticon icon-grin"></span>'),d=d.replace(/:\-D/g,'<span class="emoticon icon-grin"></span>'),d=d.replace(/:P/g,'<span class="emoticon icon-tongue"></span>'),d=d.replace(/:\-P/g,'<span class="emoticon icon-tongue"></span>'),d=d.replace(/:p/g,'<span class="emoticon icon-tongue"></span>'),d=d.replace(/:\-p/g,'<span class="emoticon icon-tongue"></span>'),d=d.replace(/8\)/g,'<span class="emoticon icon-cool"></span>'),d=d.replace(/&gt;:\)/g,'<span class="emoticon icon-evil"></span>'),d=d.replace(/:S/g,'<span class="emoticon icon-confused"></span>'),d=d.replace(/:\\/g,'<span class="emoticon icon-wondering"></span>'),d=d.replace(/:\/ /g,'<span class="emoticon icon-wondering"></span>'),d=d.replace(/&gt;:\(/g,'<span class="emoticon icon-angry"></span>'),d=d.replace(/:\(/g,'<span class="emoticon icon-sad"></span>'),d=d.replace(/:\-\(/g,'<span class="emoticon icon-sad"></span>'),d=d.replace(/:O/g,'<span class="emoticon icon-shocked"></span>'),d=d.replace(/:\-O/g,'<span class="emoticon icon-shocked"></span>'),d=d.replace(/\=\-O/g,'<span class="emoticon icon-shocked"></span>'),d=d.replace(/\(\^.\^\)b/g,'<span class="emoticon icon-thumbs-up"></span>'),d=d.replace(/<3/g,'<span class="emoticon icon-heart"></span>'),a(c).html(d)}),this};var f={emit:function(b,c){a(this).trigger(b,c)},once:function(b,c){a(this).one(b,c)},on:function(b,c){a(this).bind(b,c)},off:function(b,c){a(this).unbind(b,c)}};return f.initialize=function(f,g){var h=this,i=0,j=1,k=2,l=3,m={ENTER:13},n="undefined"!=typeof crypto&&("function"==typeof crypto.randomBytes||"function"==typeof crypto.getRandomValues),o=n&&"undefined"!=typeof CryptoJS&&"undefined"!=typeof c&&"undefined"!=typeof d;this.allow_contact_requests=!0,this.allow_muc=!0,this.allow_otr=!0,this.animate=!0,this.auto_list_rooms=!1,this.auto_reconnect=!0,this.auto_subscribe=!1,this.bosh_service_url=void 0,this.cache_otr_key=!1,this.debug=!1,this.expose_rid_and_sid=!1,this.hide_muc_server=!1,this.i18n=locales.en,this.prebind=!1,this.show_controlbox_by_default=!1,this.show_only_online_users=!1,this.show_call_button=!1,this.show_emoticons=!0,this.show_toolbar=!0,this.use_otr_by_default=!1,this.use_vcards=!0,this.xhr_custom_status=!1,this.xhr_custom_status_url="",this.xhr_user_search=!1,this.xhr_user_search_url="",b.extend(this,b.pick(f,["allow_contact_requests","allow_muc","allow_otr","animate","auto_list_rooms","auto_reconnect","auto_subscribe","bosh_service_url","cache_otr_key","connection","debug","expose_rid_and_sid","fullname","hide_muc_server","i18n","jid","prebind","rid","show_call_button","show_controlbox_by_default","show_emoticons","show_only_online_users","show_toolbar","sid","use_otr_by_default","use_vcards","xhr_custom_status","xhr_custom_status_url","xhr_user_search","xhr_user_search_url"])),this.allow_otr=this.allow_otr&&o,this.use_otr_by_default=this.use_otr_by_default&&this.allow_otr;var p=a.proxy(function(a){void 0===this.i18n&&(this.i18n=locales.en);var b=this.i18n.translate(a);return arguments.length>1?b.fetch.apply(b,[].slice.call(arguments,1)):b.fetch()},this),q=function(a){return a},r={};r[i]="unencrypted",r[j]="unverified",r[k]="verified",r[l]="finished";var s={};s[i]=p("unencrypted"),s[j]=p("unverified"),s[k]=p("verified"),s[l]=p("finished");var t={dnd:p("This contact is busy"),online:p("This contact is online"),offline:p("This contact is offline"),unavailable:p("This contact is unavailable"),xa:p("This contact is away for an extended period"),away:p("This contact is away")};if(this.callback=g||function(){},this.initial_presence_sent=0,this.msg_counter=0,this.giveFeedback=function(b,c){a(".conn-feedback").text(b),a(".conn-feedback").attr("class","conn-feedback"),c&&a(".conn-feedback").addClass(c)},this.log=function(a,b){this.debug&&e.log("error"==b?"ERROR: "+a:a)},this.getVCard=function(c,d,e){return this.use_vcards?void h.connection.vcard.get(a.proxy(function(e){var f=a(e).find("vCard"),g=f.find("FN").text(),i=f.find("BINVAL").text(),j=f.find("TYPE").text(),k=f.find("URL").text();if(c){var l=h.roster.get(c);l&&(g=b.isEmpty(g)?l.get("fullname")||c:g,l.save({fullname:g,image_type:j,image:i,url:k,vcard_updated:h.toISOString(new Date)}))}d&&d(c,g,i,j,k)},this),c,function(a){var b=h.roster.get(c);b&&b.save({vcard_updated:h.toISOString(new Date)}),e&&e(a)}):void(d&&d(c,c))},this.reconnect=function(){h.giveFeedback(p("Reconnecting"),"error"),h.prebind||this.connection.connect(this.connection.jid,this.connection.pass,function(a,b){h.onConnect(a,b,!0)},this.connection.wait,this.connection.hold,this.connection.route)},this.showLoginButton=function(){var a=h.chatboxesview.views.controlbox;"undefined"!=typeof a.loginpanel&&a.loginpanel.showLoginButton()},this.onConnect=function(a,b,c){a===Strophe.Status.CONNECTED||a===Strophe.Status.ATTACHED?"undefined"!=typeof c&&c?(h.log(a===Strophe.Status.CONNECTED?"Reconnected":"Reattached"),h.onReconnected()):(h.log(a===Strophe.Status.CONNECTED?"Connected":"Attached"),h.onConnected()):a===Strophe.Status.DISCONNECTED?(h.giveFeedback(p("Disconnected"),"error"),h.auto_reconnect?h.reconnect():h.showLoginButton()):a===Strophe.Status.Error?(h.showLoginButton(),h.giveFeedback(p("Error"),"error")):a===Strophe.Status.CONNECTING?h.giveFeedback(p("Connecting")):a===Strophe.Status.CONNFAIL?(h.showLoginButton(),h.giveFeedback(p("Connection Failed"),"error")):a===Strophe.Status.AUTHENTICATING?h.giveFeedback(p("Authenticating")):a===Strophe.Status.AUTHFAIL?(h.showLoginButton(),h.giveFeedback(p("Authentication Failed"),"error")):a===Strophe.Status.DISCONNECTING&&h.giveFeedback(p("Disconnecting"),"error")},this.toISOString=function(a){var b;return"undefined"!=typeof a.toISOString?a.toISOString():(b=function(a){return 10>a?"0"+a:""+a},a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+".000Z")},this.parseISO8601=function(a){var b,c,d=[1,4,5,6,7,10,11],e=/^\s*(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}\.?\d*)Z\s*$/.exec(a),f=0;for(b=0;c=d[b];++b)e[c]=+e[c]||0;return e[2]=(+e[2]||1)-1,e[3]=+e[3]||1,"Z"!==e[8]&&void 0!==e[9]&&(f=60*e[10]+e[11],"+"===e[9]&&(f=0-f)),new Date(Date.UTC(e[1],e[2],e[3],e[4],e[5]+f,e[6],e[7]))},this.updateMsgCounter=function(){this.msg_counter>0?(document.title=-1==document.title.search(/^Messages \(\d+\) /)?"Messages ("+this.msg_counter+") "+document.title:document.title.replace(/^Messages \(\d+\) /,"Messages ("+this.msg_counter+") "),window.blur(),window.focus()):-1!=document.title.search(/^Messages \(\d+\) /)&&(document.title=document.title.replace(/^Messages \(\d+\) /,""))},this.incrementMsgCounter=function(){this.msg_counter+=1,this.updateMsgCounter()},this.clearMsgCounter=function(){this.msg_counter=0,this.updateMsgCounter()},this.initStatus=function(a){this.xmppstatus=new this.XMPPStatus;var b=hex_sha1("converse.xmppstatus-"+this.bare_jid);this.xmppstatus.id=b,this.xmppstatus.localStorage=new Backbone.LocalStorage(b),this.xmppstatus.fetch({success:a,error:a})},this.registerRosterHandler=function(){this.connection.roster.registerCallback(a.proxy(this.roster.rosterHandler,this.roster),null,"presence",null)},this.registerRosterXHandler=function(){this.connection.addHandler(a.proxy(this.roster.subscribeToSuggestedItems,this.roster),"http://jabber.org/protocol/rosterx","message",null)},this.registerPresenceHandler=function(){this.connection.addHandler(a.proxy(function(a){return this.presenceHandler(a),!0},this.roster),null,"presence",null)},this.initRoster=function(){this.roster=new this.RosterItems,this.roster.localStorage=new Backbone.LocalStorage(hex_sha1("converse.rosteritems-"+h.bare_jid)),this.registerRosterHandler(),this.registerRosterXHandler(),this.registerPresenceHandler(),this.rosterview=new this.RosterView({model:this.roster})},this.registerGlobalEventHandlers=function(){a(document).click(function(){a(".toggle-otr ul").is(":visible")&&a(".toggle-otr ul",this).slideUp(),a(".toggle-smiley ul").is(":visible")&&a(".toggle-smiley ul",this).slideUp()}),a(window).on("blur focus",a.proxy(function(a){this.windowState!=a.type&&"focus"==a.type&&h.clearMsgCounter(),this.windowState=a.type},this))},this.onReconnected=function(){this.initStatus(a.proxy(function(){this.registerRosterXHandler(),this.registerPresenceHandler(),this.chatboxes.registerMessageHandler(),h.xmppstatus.sendPresence(),this.giveFeedback(p("Online Contacts"))},this))},this.onConnected=function(){this.debug&&(this.connection.xmlInput=function(a){e.log(a)},this.connection.xmlOutput=function(a){e.log(a)},Strophe.log=function(a,b){e.log(a+" "+b)},Strophe.error=function(a){e.log("ERROR: "+a)}),this.bare_jid=Strophe.getBareJidFromJid(this.connection.jid),this.domain=Strophe.getDomainFromJid(this.connection.jid),this.features=new this.Features,this.initStatus(a.proxy(function(){this.initRoster(),this.chatboxes.onConnected(),this.connection.roster.get(function(){}),this.registerGlobalEventHandlers(),this.giveFeedback(p("Online Contacts")),this.callback&&("jasmine tests"===this.connection.service?this.callback(this):this.callback())},this)),h.emit("onReady")},this.OTR=Backbone.Model.extend({getSessionPassphrase:function(){if(h.prebind){var a=hex_sha1(h.connection.jid),b=window.sessionStorage[a];return"undefined"==typeof b&&(b=Math.floor(4294967295*Math.random()).toString(),window.sessionStorage[a]=b),b}return h.connection.pass},generatePrivateKey:function(){var a=new d,b=h.connection.jid;if(h.cache_otr_key){var c=CryptoJS.lib.PasswordBasedCipher,e=this.getSessionPassphrase();"undefined"!=typeof e&&(window.sessionStorage[hex_sha1(b+"priv_key")]=c.encrypt(CryptoJS.algo.AES,a.packPrivate(),e).toString(),window.sessionStorage[hex_sha1(b+"instance_tag")]=instance_tag,window.sessionStorage[hex_sha1(b+"pass_check")]=c.encrypt(CryptoJS.algo.AES,"match",e).toString())}return a}}),this.Message=Backbone.Model.extend(),this.Messages=Backbone.Collection.extend({model:h.Message}),this.ChatBox=Backbone.Model.extend({initialize:function(){"controlbox"!==this.get("box_id")&&(this.messages=new h.Messages,this.messages.localStorage=new Backbone.LocalStorage(hex_sha1("converse.messages"+this.get("jid")+h.bare_jid)),this.set({user_id:Strophe.getNodeFromJid(this.get("jid")),box_id:hex_sha1(this.get("jid")),otr_status:this.get("otr_status")||i}))},getSession:function(a){var b,e,f,g,i=CryptoJS.lib.PasswordBasedCipher;if(h.cache_otr_key&&(b=h.otr.getSessionPassphrase(),"undefined"!=typeof b&&(e=window.sessionStorage[hex_sha1(this.id+"instance_tag")],f=window.sessionStorage[hex_sha1(this.id+"priv_key")],g=window.sessionStorage[hex_sha1(this.connection.jid+"pass_check")],f&&e&&"undefined"!=typeof g))){var j=i.decrypt(CryptoJS.algo.AES,f,b),k=d.parsePrivate(j.toString(CryptoJS.enc.Latin1));if("match"===i.decrypt(CryptoJS.algo.AES,g,b).toString(CryptoJS.enc.Latin1))return this.trigger("showHelpMessages",[p("Re-establishing encrypted session")]),void a({key:k,instance_tag:e})}this.trigger("showHelpMessages",[p("Generating private key."),p("Your browser might become unresponsive.")],null,!0),setTimeout(function(){a({key:h.otr.generatePrivateKey.apply(this),instance_tag:c.makeInstanceTag()})},500)},updateOTRStatus:function(a){switch(a){case c.CONST.STATUS_AKE_SUCCESS:this.otr.msgstate===c.CONST.MSGSTATE_ENCRYPTED&&this.save({otr_status:j});break;case c.CONST.STATUS_END_OTR:this.otr.msgstate===c.CONST.MSGSTATE_FINISHED?this.save({otr_status:l}):this.otr.msgstate===c.CONST.MSGSTATE_PLAINTEXT&&this.save({otr_status:i})}},onSMP:function(a,b){switch(a){case"question":this.otr.smpSecret(prompt(p("Authentication request from %1$s\n\nYour buddy is attempting to verify your identity, by asking you the question below.\n\n%2$s",[this.get("fullname"),b])));break;case"trust":b===!0?this.save({otr_status:k}):(this.trigger("showHelpMessages",[p("Could not verify this user's identify.")],"error"),this.save({otr_status:j}));break;default:throw new Error("Unknown type.")}},initiateOTR:function(b){this.save({otr_status:i});this.getSession(a.proxy(function(d){this.otr=new c({fragment_size:140,send_interval:200,priv:d.key,instance_tag:d.instance_tag,debug:this.debug}),this.otr.on("status",a.proxy(this.updateOTRStatus,this)),this.otr.on("smp",a.proxy(this.onSMP,this)),this.otr.on("ui",a.proxy(function(a){this.trigger("showReceivedOTRMessage",a)},this)),this.otr.on("io",a.proxy(function(a){this.trigger("sendMessageStanza",a)},this)),this.otr.on("error",a.proxy(function(a){this.trigger("showOTRError",a)},this)),this.trigger("showHelpMessages",[p("Exchanging private key with buddy.")]),b?this.otr.receiveMsg(b):this.otr.sendQueryMsg()},this))},endOTR:function(){this.otr&&this.otr.endOtr(),this.save({otr_status:i})},createMessage:function(c){var d,e,f,g=a(c),i=g.children("body").text(),j=Strophe.getBareJidFromJid(g.attr("from")),k=g.find("composing"),l=g.find("delay").length>0,m=this.get("fullname");m=(b.isEmpty(m)?j:m).split(" ")[0],i?(l?(d=g.find("delay").attr("stamp"),e=d):e=h.toISOString(new Date),f=j==h.bare_jid?"me":"them",this.messages.create({fullname:m,sender:f,delayed:l,time:e,message:i})):k.length&&this.messages.add({fullname:m,sender:"them",delayed:l,time:h.toISOString(new Date),composing:k.length})},receiveMessage:function(c){var d=a(c).children("body"),e=d.length>0?d.text():void 0;return e&&h.allow_otr?void(e.match(/^\?OTRv23?/)?this.initiateOTR(e):b.contains([j,k],this.get("otr_status"))?this.otr.receiveMsg(e):e.match(/^\?OTR/)?this.otr?this.otr.receiveMsg(e):this.initiateOTR(e):this.createMessage(c)):this.createMessage(c)}}),this.ChatBoxView=Backbone.View.extend({length:200,tagName:"div",className:"chatbox",is_chatroom:!1,events:{"click .close-chatbox-button":"closeChat","keypress textarea.chat-textarea":"keyPressed","click .toggle-smiley":"toggleEmoticonMenu","click .toggle-smiley ul li":"insertEmoticon","click .toggle-otr":"toggleOTRMenu","click .start-otr":"startOTRFromToolbar","click .end-otr":"endOTR","click .auth-otr":"authOTR","click .toggle-call":"toggleCall"},template:b.template('<div class="chat-head chat-head-chatbox"><a class="close-chatbox-button icon-close"></a><a href="{{url}}" target="_blank" class="user"><div class="chat-title"> {{ fullname }} </div></a><p class="user-custom-message"><p/></div><div class="chat-content"></div><form class="sendXMPPMessage" action="" method="post">{[ if ('+h.show_toolbar+') { ]}<ul class="chat-toolbar no-text-select"></ul>{[ } ]}<textarea type="text" class="chat-textarea" placeholder="'+p("Personal message")+'"/></form>'),toolbar_template:b.template('{[ if (show_emoticons)  { ]}<li class="toggle-smiley icon-happy" title="Insert a smilery"><ul><li><a class="icon-smiley" href="#" data-emoticon=":)"></a></li><li><a class="icon-wink" href="#" data-emoticon=";)"></a></li><li><a class="icon-grin" href="#" data-emoticon=":D"></a></li><li><a class="icon-tongue" href="#" data-emoticon=":P"></a></li><li><a class="icon-cool" href="#" data-emoticon="8)"></a></li><li><a class="icon-evil" href="#" data-emoticon=">:)"></a></li><li><a class="icon-confused" href="#" data-emoticon=":S"></a></li><li><a class="icon-wondering" href="#" data-emoticon=":\\"></a></li><li><a class="icon-angry" href="#" data-emoticon=">:("></a></li><li><a class="icon-sad" href="#" data-emoticon=":("></a></li><li><a class="icon-shocked" href="#" data-emoticon=":O"></a></li><li><a class="icon-thumbs-up" href="#" data-emoticon="(^.^)b"></a></li><li><a class="icon-heart" href="#" data-emoticon="<3"></a></li></ul></li>{[ } ]}{[ if ('+h.show_call_button+')  { ]}<li><a class="toggle-call icon-phone" title="Start a call"></a></li>{[ } ]}{[ if (allow_otr)  { ]}<li class="toggle-otr {{otr_status_class}}" title="{{otr_tooltip}}"><span class="chat-toolbar-text">{{otr_translated_status}}</span>{[ if (otr_status == "'+i+'") { ]}<span class="icon-unlocked"></span>{[ } ]}{[ if (otr_status == "'+j+'") { ]}<span class="icon-lock"></span>{[ } ]}{[ if (otr_status == "'+k+'") { ]}<span class="icon-lock"></span>{[ } ]}{[ if (otr_status == "'+l+'") { ]}<span class="icon-unlocked"></span>{[ } ]}<ul>{[ if (otr_status == "'+i+'") { ]}<li><a class="start-otr" href="#">'+p("Start encrypted conversation")+'</a></li>{[ } ]}{[ if (otr_status != "'+i+'") { ]}<li><a class="start-otr" href="#">'+p("Refresh encrypted conversation")+'</a></li><li><a class="end-otr" href="#">'+p("End encrypted conversation")+'</a></li><li><a class="auth-otr" data-scheme="smp" href="#">'+p("Verify with SMP")+'</a></li>{[ } ]}{[ if (otr_status == "'+j+'") { ]}<li><a class="auth-otr" data-scheme="fingerprint" href="#">'+p("Verify with fingerprints")+'</a></li>{[ } ]}<li><a href="http://www.cypherpunks.ca/otr/help/3.2.0/levels.php" target="_blank">'+p("What's this?")+"</a></li></ul></li>{[ } ]}"),message_template:b.template('<div class="chat-message {{extra_classes}}"><span class="chat-message-{{sender}}">{{time}} {{username}}:&nbsp;</span><span class="chat-message-content">{{message}}</span></div>'),action_template:b.template('<div class="chat-message {{extra_classes}}"><span class="chat-message-{{sender}}">{{time}} **{{username}} </span><span class="chat-message-content">{{message}}</span></div>'),new_day_template:b.template('<time class="chat-date" datetime="{{isodate}}">{{datestring}}</time>'),initialize:function(){this.model.messages.on("add",this.onMessageAdded,this),this.model.on("show",this.show,this),this.model.on("destroy",this.hide,this),this.model.on("change",this.onChange,this),this.model.on("showOTRError",this.showOTRError,this),this.model.on("buddyStartsOTR",this.buddyStartsOTR,this),this.model.on("showHelpMessages",this.showHelpMessages,this),this.model.on("sendMessageStanza",this.sendMessageStanza,this),this.model.on("showSentOTRMessage",function(a){this.showMessage({message:a,sender:"me"})},this),this.model.on("showReceivedOTRMessage",function(a){this.showMessage({message:a,sender:"them"})},this),this.updateVCard(),this.$el.appendTo(h.chatboxesview.$el),this.render().show().model.messages.fetch({add:!0}),this.model.get("status")&&this.showStatusMessage(this.model.get("status")),(b.contains([j,k],this.model.get("otr_status"))||h.use_otr_by_default)&&this.model.initiateOTR()},render:function(){return this.$el.attr("id",this.model.get("box_id")).html(this.template(this.model.toJSON())),this.renderToolbar().renderAvatar(),this},showStatusNotification:function(b){var c=this.$el.find(".chat-content");c.find("div.chat-event").remove().end().append(a('<div class="chat-event"></div>').text(b)),this.scrollDown()},showMessage:function(b){var c,d,e=this.$el.find(".chat-content"),f=b.time?h.parseISO8601(b.time):new Date,g=b.message,i=g.match(/^\/(.*?)(?: (.*))?$/),j=b.fullname||this.model.get("fullname");i&&"me"===i[1]?(g=g.replace(/^\/me/,""),c=this.action_template,d=j):(c=this.message_template,d="me"===b.sender&&p("me")||j),e.find("div.chat-event").remove();var k=c({sender:b.sender,time:f.toTimeString().substring(0,5),username:d,message:"",extra_classes:b.delayed&&"delayed"||""});return e.append(a(k).children(".chat-message-content").first().text(g).addHyperlinks().addEmoticons().parent()),this.scrollDown()},showHelpMessages:function(b,c,d){var e,f=this.$el.find(".chat-content"),g=b.length;for(e=0;g>e;e++)f.append(a('<div class="chat-'+(c||"info")+'">'+b[e]+"</div>"));return d===!0?f.append('<span class="spinner"/>'):d===!1&&f.find("span.spinner").remove(),this.scrollDown()},onMessageAdded:function(a){var c,d,e,f,g=a.get("time"),i=this.model.messages.pluck("time"),j=h.parseISO8601(g);return d=b.indexOf(i,g)-1,d>=0&&(c=this.model.messages.at(d),e=h.parseISO8601(c.get("time")),f=new Date(j.getTime()),f.setUTCHours(0,0,0,0),f=h.toISOString(f),this.isDifferentDay(e,j)&&this.$el.find(".chat-content").append(this.new_day_template({isodate:f,datestring:j.toString().substring(0,15)}))),a.get("composing")?void this.showStatusNotification(a.get("fullname")+" is typing"):(this.showMessage(b.clone(a.attributes)),"me"!=a.get("sender")&&"blur"==h.windowState&&h.incrementMsgCounter(),this.scrollDown())},isDifferentDay:function(a,b){return b.getDate()!=a.getDate()||b.getFullYear()!=a.getFullYear()||b.getMonth()!=a.getMonth()},sendMessageStanza:function(a){var b=(new Date).getTime(),c=this.model.get("jid"),d=$msg({from:h.connection.jid,to:c,type:"chat",id:b}).c("body").t(a).up().c("active",{xmlns:"http://jabber.org/protocol/chatstates"}),e=$msg({to:h.bare_jid,type:"chat",id:b}).c("forwarded",{xmlns:"urn:xmpp:forward:0"}).c("delay",{xmns:"urn:xmpp:delay",stamp:b}).up().cnode(d.tree());h.connection.send(d),h.connection.send(e)},sendMessage:function(a){var c,d=a.replace(/^\s*/,"").match(/^\/(.*)\s*$/);if(d){if("clear"===d[1])return this.$el.find(".chat-content").empty(),void this.model.messages.reset().localStorage._clear();if("help"===d[1])return c=["<strong>/help</strong>:"+p("Show this menu"),"<strong>/me</strong>:"+p("Write in the third person"),"<strong>/clear</strong>:"+p("Remove messages")],void this.showHelpMessages(c);if(h.allow_otr&&"endotr"===d[1])return this.endOTR();if(h.allow_otr&&"otr"===d[1])return this.model.initiateOTR()}if(b.contains([j,k],this.model.get("otr_status")))this.model.otr.sendMsg(a),this.model.trigger("showSentOTRMessage",a);else{var e=h.xmppstatus.get("fullname");e=b.isEmpty(e)?h.bare_jid:e,this.model.messages.create({fullname:e,sender:"me",time:h.toISOString(new Date),message:a}),this.sendMessageStanza(a)}},keyPressed:function(b){var c,d,e,f=a(b.target);b.keyCode==m.ENTER?(b.preventDefault(),c=f.val(),f.val("").focus(),""!==c&&(this.model.get("chatroom")?this.sendChatRoomMessage(c):this.sendMessage(c),h.emit("onMessageSend",c)),this.$el.data("composing",!1)):this.model.get("chatroom")||(e=this.$el.data("composing"),e||(47!=b.keyCode&&(d=$msg({to:this.model.get("jid"),type:"chat"}).c("composing",{xmlns:"http://jabber.org/protocol/chatstates"}),h.connection.send(d)),this.$el.data("composing",!0)))},insertEmoticon:function(b){b.stopPropagation(),this.$el.find(".toggle-smiley ul").slideToggle(200);var c=this.$el.find("textarea.chat-textarea"),d=c.val(),e=a(b.target);e=e.is("a")?e:e.children("a"),d&&" "!==d[d.length-1]&&(d+=" "),c.focus().val(d+e.data("emoticon")+" ")},toggleEmoticonMenu:function(a){a.stopPropagation(),this.$el.find(".toggle-smiley ul").slideToggle(200)},toggleOTRMenu:function(a){a.stopPropagation(),this.$el.find(".toggle-otr ul").slideToggle(200)},showOTRError:function(a){"Message cannot be sent at this time."==a?this.showHelpMessages([p("Your message could not be sent")],"error"):"Received an unencrypted message."==a?this.showHelpMessages([p("We received an unencrypted message")],"error"):"Received an unreadable encrypted message."==a?this.showHelpMessages([p("We received an unreadable encrypted message")],"error"):this.showHelpMessages(["Encryption error occured: "+a],"error"),e.log("OTR ERROR:"+a)},buddyStartsOTR:function(){this.showHelpMessages([p("This user has requested an encrypted session.")]),this.model.initiateOTR()},startOTRFromToolbar:function(b){a(b.target).parent().parent().slideUp(),b.stopPropagation(),this.model.initiateOTR()},endOTR:function(a){"undefined"!=typeof a&&(a.preventDefault(),a.stopPropagation()),this.model.endOTR()},authOTR:function(b){var c,d,e,f=a(b.target).data().scheme;"fingerprint"===f?(c=confirm(p("Here are the fingerprints, please confirm them with %1$s, outside of this chat.\n\nFingerprint for you, %2$s: %3$s\n\nFingerprint for %1$s: %4$s\n\nIf you have confirmed that the fingerprints match, click OK, otherwise click Cancel.",[this.model.get("fullname"),h.xmppstatus.get("fullname")||h.bare_jid,this.model.otr.priv.fingerprint(),this.model.otr.their_priv_pk.fingerprint()])),this.model.save(c===!0?{otr_status:k}:{otr_status:j})):"smp"===f?(alert(p("You will be prompted to provide a security question and then an answer to that question.\n\nYour buddy will then be prompted the same question and if they type the exact same answer (case sensitive), their identity will be verified.")),d=prompt(p("What is your security question?")),d&&(e=prompt(p("What is the answer to the security question?")),this.model.otr.smpSecret(e,d))):this.showHelpMessages([p("Invalid authentication scheme provided")],"error")},toggleCall:function(a){a.stopPropagation(),h.emit("onCallButtonClicked",{connection:h.connection,model:this.model})},onChange:function(a){if(b.has(a.changed,"chat_status")){var c=a.get("chat_status"),d=a.get("fullname");d=b.isEmpty(d)?a.get("jid"):d,this.$el.is(":visible")&&("offline"===c?this.showStatusNotification(d+" has gone offline"):"away"===c?this.showStatusNotification(d+" has gone away"):"dnd"===c?this.showStatusNotification(d+" is busy"):"online"===c&&this.$el.find("div.chat-event").remove()),h.emit("onBuddyStatusChanged",a.attributes,a.get("chat_status"))}b.has(a.changed,"status")&&(this.showStatusMessage(a.get("status")),h.emit("onBuddyStatusMessageChanged",a.attributes,a.get("status"))),b.has(a.changed,"image")&&this.renderAvatar(),b.has(a.changed,"otr_status")&&this.renderToolbar().informOTRChange()},showStatusMessage:function(a){this.$el.find("p.user-custom-message").text(a).attr("title",a)},closeChat:function(){h.connection?this.model.destroy():this.model.trigger("hide")},updateVCard:function(){var b=this.model.get("jid"),c=h.roster.get(b);c&&!c.get("vcard_updated")&&h.getVCard(b,a.proxy(function(a,b,c,d,e){this.model.save({fullname:b||a,url:e,image_type:d,image:c})},this),a.proxy(function(){h.log("ChatBoxView.initialize: An error occured while fetching vcard")},this))},informOTRChange:function(){var a=this.model.toJSON(),b=[];return a.otr_status==i?b.push(p("Your messages are not encrypted anymore")):a.otr_status==j?b.push(p("Your messages are now encrypted but your buddy's identity has not been verified.")):a.otr_status==k?b.push(p("Your buddy's identify has been verified.")):a.otr_status==l&&b.push(p("Your buddy has ended encryption on their end, you should do the same.")),this.showHelpMessages(b,"info",!1)},renderToolbar:function(){if(h.show_toolbar){var a=this.model.toJSON();a.otr_status==i?a.otr_tooltip=p("Your messages are not encrypted. Click here to enable OTR encryption."):a.otr_status==j?a.otr_tooltip=p("Your messages are encrypted, but your buddy has not been verified."):a.otr_status==k?a.otr_tooltip=p("Your messages are encrypted and your buddy verified."):a.otr_status==l&&(a.otr_tooltip=p("Your buddy has closed their end of the private session, you should do the same")),a.allow_otr=h.allow_otr&&!this.is_chatroom,a.show_emoticons=h.show_emoticons,a.otr_translated_status=s[a.otr_status],a.otr_status_class=r[a.otr_status],this.$el.find(".chat-toolbar").html(this.toolbar_template(a))}return this},renderAvatar:function(){if(this.model.get("image")){var b="data:"+this.model.get("image_type")+";base64,"+this.model.get("image"),c=a('<canvas height="33px" width="33px" class="avatar"></canvas>').get(0);if(!c.getContext||!c.getContext("2d"))return this;var d=c.getContext("2d"),e=new Image;return e.onload=function(){var a=e.width/e.height;d.drawImage(e,0,0,35*a,35)},e.src=b,this.$el.find(".chat-title").before(c),this}},focus:function(){return this.$el.find(".chat-textarea").focus(),this},hide:function(){this.$el.is(":visible")&&"1"==this.$el.css("opacity")&&(h.animate?this.$el.hide("fast"):this.$el.hide(),h.emit("onChatBoxClosed",this))},show:function(){return this.$el.is(":visible")&&"1"==this.$el.css("opacity")?(h.emit("onChatBoxFocused",this),this.focus()):(h.animate?this.$el.css({opacity:0,display:"inline"}).animate({opacity:"1"},200):this.$el.css({opacity:1,display:"inline"}),h.connection&&this.model.save(),h.emit("onChatBoxOpened",this),this)},scrollDown:function(){var a=this.$el.find(".chat-content");return a.scrollTop(a[0].scrollHeight),this}}),this.ContactsPanel=Backbone.View.extend({tagName:"div",className:"oc-chat-content",id:"users",events:{"click a.toggle-xmpp-contact-form":"toggleContactForm","submit form.add-xmpp-contact":"addContactFromForm","submit form.search-xmpp-contact":"searchContacts","click a.subscribe-to-user":"addContactFromList"},tab_template:b.template('<li><a class="s current" href="#users">'+p("Contacts")+"</a></li>"),template:b.template('<form class="set-xmpp-status" action="" method="post"><span id="xmpp-status-holder"><select id="select-xmpp-status" style="display:none"><option value="online">'+p("Online")+'</option><option value="dnd">'+p("Busy")+'</option><option value="away">'+p("Away")+'</option><option value="offline">'+p("Offline")+"</option></select></span></form>"),add_contact_dropdown_template:b.template('<dl class="add-converse-contact dropdown"><dt id="xmpp-contact-search" class="fancy-dropdown"><a class="toggle-xmpp-contact-form" href="#"title="'+p("Click to add new chat contacts")+'"><span class="icon-plus"></span>'+p("Add a contact")+'</a></dt><dd class="search-xmpp" style="display:none"><ul></ul></dd></dl>'),add_contact_form_template:b.template('<li><form class="add-xmpp-contact"><input type="text" name="identifier" class="username" placeholder="'+p("Contact username")+'"/><button type="submit">'+p("Add")+"</button></form><li>"),search_contact_template:b.template('<li><form class="search-xmpp-contact"><input type="text" name="identifier" class="username" placeholder="'+p("Contact name")+'"/><button type="submit">'+p("Search")+"</button></form><li>"),initialize:function(a){a.$parent.append(this.$el),this.$tabs=a.$parent.parent().find("#controlbox-tabs")},render:function(){var a,b=this.template();return this.$tabs.append(this.tab_template()),a=h.xhr_user_search?this.search_contact_template():this.add_contact_form_template(),h.allow_contact_requests&&(b+=this.add_contact_dropdown_template()),this.$el.html(b),this.$el.find(".search-xmpp ul").append(a),this.$el.append(h.rosterview.$el),this},toggleContactForm:function(b){b.preventDefault(),this.$el.find(".search-xmpp").toggle("fast",function(){a(this).is(":visible")&&a(this).find("input.username").focus()})},searchContacts:function(b){b.preventDefault(),a.getJSON(xhr_user_search_url+"?q="+a(b.target).find("input.username").val(),function(b){var c=a(".search-xmpp ul");c.find("li.found-user").remove(),c.find("li.chat-info").remove(),b.length||c.append('<li class="chat-info">'+p("No users found")+"</li>"),a(b).each(function(b,d){c.append(a('<li class="found-user"></li>').append(a('<a class="subscribe-to-user" href="#" title="'+p("Click to add as a chat contact")+'"></a>').attr("data-recipient",Strophe.escapeNode(d.id)+"@"+h.domain).text(d.fullname)))
})})},addContactFromForm:function(b){b.preventDefault();var c=a(b.target).find("input"),d=c.val();return d?(this.addContact(d),void a(".search-xmpp").hide()):void c.addClass("error")},addContactFromList:function(b){b.preventDefault();var c=a(b.target),d=c.attr("data-recipient"),e=c.text();this.addContact(d,e),c.parent().remove(),a(".search-xmpp").hide()},addContact:function(a,c){c=b.isEmpty(c)?a:c,h.connection.roster.add(a,c,[],function(){h.connection.roster.subscribe(a,null,h.xmppstatus.get("fullname"))})}}),this.RoomsPanel=Backbone.View.extend({tagName:"div",id:"chatrooms",events:{"submit form.add-chatroom":"createChatRoom","click input#show-rooms":"showRooms","click a.open-room":"createChatRoom","click a.room-info":"showRoomInfo"},room_template:b.template('<dd class="available-chatroom"><a class="open-room" data-room-jid="{{jid}}"title="'+p("Click to open this room")+'" href="#">{{name}}</a><a class="room-info icon-room-info" data-room-jid="{{jid}}"title="'+p("Show more information on this room")+'" href="#">&nbsp;</a></dd>'),room_description_template:b.template('<div class="room-info"><p class="room-info"><strong>'+p("Description:")+'</strong> {{desc}}</p><p class="room-info"><strong>'+p("Occupants:")+'</strong> {{occ}}</p><p class="room-info"><strong>'+p("Features:")+'</strong> <ul>{[ if (passwordprotected) { ]}<li class="room-info locked">'+p("Requires authentication")+'</li>{[ } ]}{[ if (hidden) { ]}<li class="room-info">'+p("Hidden")+'</li>{[ } ]}{[ if (membersonly) { ]}<li class="room-info">'+p("Requires an invitation")+'</li>{[ } ]}{[ if (moderated) { ]}<li class="room-info">'+p("Moderated")+'</li>{[ } ]}{[ if (nonanonymous) { ]}<li class="room-info">'+p("Non-anonymous")+'</li>{[ } ]}{[ if (open) { ]}<li class="room-info">'+p("Open room")+'</li>{[ } ]}{[ if (persistent) { ]}<li class="room-info">'+p("Permanent room")+'</li>{[ } ]}{[ if (publicroom) { ]}<li class="room-info">'+p("Public")+'</li>{[ } ]}{[ if (semianonymous) { ]}<li class="room-info">'+p("Semi-anonymous")+'</li>{[ } ]}{[ if (temporary) { ]}<li class="room-info">'+p("Temporary room")+'</li>{[ } ]}{[ if (unmoderated) { ]}<li class="room-info">'+p("Unmoderated")+"</li>{[ } ]}</p></div>"),tab_template:b.template('<li><a class="s" href="#chatrooms">'+p("Rooms")+"</a></li>"),template:b.template('<form class="add-chatroom" action="" method="post"><input type="text" name="chatroom" class="new-chatroom-name" placeholder="'+p("Room name")+'"/><input type="text" name="nick" class="new-chatroom-nick" placeholder="'+p("Nickname")+'"/><input type="{{ server_input_type }}" name="server" class="new-chatroom-server" placeholder="'+p("Server")+'"/><input type="submit" name="join" value="'+p("Join")+'"/><input type="button" name="show" id="show-rooms" value="'+p("Show rooms")+'"/></form><dl id="available-chatrooms"></dl>'),initialize:function(c){c.$parent.append(this.$el.html(this.template({server_input_type:h.hide_muc_server&&"hidden"||"text"})).hide()),this.$tabs=c.$parent.parent().find("#controlbox-tabs"),this.on("update-rooms-list",function(){this.updateRoomsList()}),h.xmppstatus.on("change",a.proxy(function(a){if(b.has(a.changed,"fullname")){var c=this.$el.find("input.new-chatroom-nick");c.is(":focus")||c.val(a.get("fullname"))}},this))},render:function(){return this.$tabs.append(this.tab_template()),this},informNoRoomsFound:function(){var b=this.$el.find("#available-chatrooms");b.html("<dt>"+p("No rooms on %1$s",this.muc_domain)+"</dt>"),a("input#show-rooms").show().siblings("span.spinner").remove()},updateRoomsList:function(){h.connection.muc.listRooms(this.muc_domain,a.proxy(function(b){var c,d,e,f,g=this.$el.find("#available-chatrooms");if(this.rooms=a(b).find("query").find("item"),this.rooms.length){for(g.html("<dt>"+p("Rooms on %1$s",this.muc_domain)+"</dt>"),f=document.createDocumentFragment(),e=0;e<this.rooms.length;e++)c=Strophe.unescapeNode(a(this.rooms[e]).attr("name")||a(this.rooms[e]).attr("jid")),d=a(this.rooms[e]).attr("jid"),f.appendChild(a(this.room_template({name:c,jid:d}))[0]);g.append(f),a("input#show-rooms").show().siblings("span.spinner").remove()}else this.informNoRoomsFound();return!0},this),a.proxy(function(){this.informNoRoomsFound()},this))},showRooms:function(){var b=this.$el.find("#available-chatrooms"),c=this.$el.find("input.new-chatroom-server"),d=c.val();return d?(this.$el.find("input.new-chatroom-name").removeClass("error"),c.removeClass("error"),b.empty(),a("input#show-rooms").hide().after('<span class="spinner"/>'),this.muc_domain=d,void this.updateRoomsList()):void c.addClass("error")},showRoomInfo:function(b){var c=b.target,d=a(c).parent("dd"),e=d.find("div.room-info");e.length?e.remove():(d.find("span.spinner").remove(),d.append('<span class="spinner hor_centered"/>'),h.connection.disco.info(a(c).attr("data-room-jid"),null,a.proxy(function(b){var c=a(b);d.find("span.spinner").replaceWith(this.room_description_template({desc:c.find('field[var="muc#roominfo_description"] value').text(),occ:c.find('field[var="muc#roominfo_occupants"] value').text(),hidden:c.find('feature[var="muc_hidden"]').length,membersonly:c.find('feature[var="muc_membersonly"]').length,moderated:c.find('feature[var="muc_moderated"]').length,nonanonymous:c.find('feature[var="muc_nonanonymous"]').length,open:c.find('feature[var="muc_open"]').length,passwordprotected:c.find('feature[var="muc_passwordprotected"]').length,persistent:c.find('feature[var="muc_persistent"]').length,publicroom:c.find('feature[var="muc_public"]').length,semianonymous:c.find('feature[var="muc_semianonymous"]').length,temporary:c.find('feature[var="muc_temporary"]').length,unmoderated:c.find('feature[var="muc_unmoderated"]').length}))},this)))},createChatRoom:function(b){b.preventDefault();var c,d,e,f,g,i,j=this.$el.find("input.new-chatroom-nick"),k=j.val();if(k?j.removeClass("error"):j.addClass("error"),"click"===b.type)g=a(b.target).attr("data-room-jid");else{if(d=this.$el.find("input.new-chatroom-name"),f=this.$el.find("input.new-chatroom-server"),e=f.val(),c=d.val().trim().toLowerCase(),d.val(""),!c||!e)return c||d.addClass("error"),void(e||f.addClass("error"));g=Strophe.escapeNode(c)+"@"+e,d.removeClass("error"),f.removeClass("error"),this.muc_domain=e}k&&(i=h.chatboxesview.showChatBox({id:g,jid:g,name:Strophe.unescapeNode(Strophe.getNodeFromJid(g)),nick:k,chatroom:!0,box_id:hex_sha1(g)}),i.get("connected")||h.chatboxesview.views[g].connect(null))}}),this.ControlBoxView=h.ChatBoxView.extend({tagName:"div",className:"chatbox",id:"controlbox",events:{"click a.close-chatbox-button":"closeChat","click ul#controlbox-tabs li a":"switchTab"},initialize:function(){this.$el.appendTo(h.chatboxesview.$el),this.model.on("change",a.proxy(function(c){if(b.has(c.changed,"connected")){this.render(),h.features.on("add",a.proxy(this.featureAdded,this));var d=h.features.findWhere({"var":"http://jabber.org/protocol/muc"});d&&this.featureAdded(d)}b.has(c.changed,"visible")&&c.changed.visible===!0&&this.show()},this)),this.model.on("show",this.show,this),this.model.on("destroy",this.hide,this),this.model.on("hide",this.hide,this),this.model.get("visible")&&this.show()},featureAdded:function(a){if("http://jabber.org/protocol/muc"==a.get("var")&&h.allow_muc){this.roomspanel.muc_domain=a.get("from");var b=this.$el.find("input.new-chatroom-server");b.is(":focus")||b.val(this.roomspanel.muc_domain),h.auto_list_rooms&&this.roomspanel.trigger("update-rooms-list")}},template:b.template('<div class="chat-head oc-chat-head"><ul id="controlbox-tabs"></ul><a class="close-chatbox-button icon-close"></a></div><div class="controlbox-panes"></div>'),switchTab:function(b){b.preventDefault();var c=a(b.target),d=c.parent().siblings("li").children("a"),e=a(c.attr("href")),f=a(d.attr("href"));f.fadeOut("fast",function(){d.removeClass("current"),c.addClass("current"),e.fadeIn("fast",function(){})})},showHelpMessages:function(){},render:function(){return h.prebind||h.connection?this.contactspanel||(this.$el.html(this.template(this.model.toJSON())),this.contactspanel=new h.ContactsPanel({$parent:this.$el.find(".controlbox-panes")}),this.contactspanel.render(),h.xmppstatusview=new h.XMPPStatusView({model:h.xmppstatus}),h.xmppstatusview.render(),h.allow_muc&&(this.roomspanel=new h.RoomsPanel({$parent:this.$el.find(".controlbox-panes")}),this.roomspanel.render())):(this.$el.html(this.template(this.model.toJSON())),this.loginpanel=new h.LoginPanel({$parent:this.$el.find(".controlbox-panes"),model:this}),this.loginpanel.render()),this}}),this.ChatRoomView=h.ChatBoxView.extend({length:300,tagName:"div",className:"chatroom",events:{"click a.close-chatbox-button":"closeChat","click a.configure-chatroom-button":"configureChatRoom","click .toggle-smiley":"toggleEmoticonMenu","click .toggle-smiley ul li":"insertEmoticon","keypress textarea.chat-textarea":"keyPressed"},info_template:b.template('<div class="chat-info">{{message}}</div>'),is_chatroom:!0,sendChatRoomMessage:function(a){var b,c=a.replace(/^\s*/,"").match(/^\/(.*?)(?: (.*))?$/)||[!1];switch(c[1]){case"msg":break;case"clear":this.$el.find(".chat-content").empty();break;case"topic":h.connection.muc.setTopic(this.model.get("jid"),c[2]);break;case"kick":h.connection.muc.kick(this.model.get("jid"),c[2]);break;case"ban":h.connection.muc.ban(this.model.get("jid"),c[2]);break;case"op":h.connection.muc.op(this.model.get("jid"),c[2]);break;case"deop":h.connection.muc.deop(this.model.get("jid"),c[2]);break;case"help":b=this.$el.find(".chat-content"),msgs=["<strong>/help</strong>:"+p("Show this menu"),"<strong>/me</strong>:"+p("Write in the third person"),"<strong>/topic</strong>:"+p("Set chatroom topic"),"<strong>/kick</strong>:"+p("Kick user from chatroom"),"<strong>/ban</strong>:"+p("Ban user from chatroom"),"<strong>/clear</strong>:"+p("Remove messages")],this.showHelpMessages(msgs);break;default:this.last_msgid=h.connection.muc.groupchat(this.model.get("jid"),a)}},template:b.template('<div class="chat-head chat-head-chatroom"><a class="close-chatbox-button icon-close"></a><a class="configure-chatroom-button icon-wrench" style="display:none"></a><div class="chat-title"> {{ name }} </div><p class="chatroom-topic"><p/></div><div class="chat-body"><span class="spinner centered"/></div>'),chatarea_template:b.template('<div class="chat-area"><div class="chat-content"></div><form class="sendXMPPMessage" action="" method="post">{[ if ('+h.show_toolbar+') { ]}<ul class="chat-toolbar no-text-select"></ul>{[ } ]}<textarea type="text" class="chat-textarea" placeholder="'+p("Message")+'"/></form></div><div class="participants"><ul class="participant-list"></ul></div>'),render:function(){return this.$el.attr("id",this.model.get("box_id")).html(this.template(this.model.toJSON())),this},renderChatArea:function(){return this.$el.find(".chat-area").length||(this.$el.find(".chat-body").empty().append(this.chatarea_template()),this.renderToolbar()),this},connect:function(c){b.has(h.connection.muc.rooms,this.model.get("jid"))?h.connection.muc.join(this.model.get("jid"),this.model.get("nick"),null,null,null,c):h.connection.muc.join(this.model.get("jid"),this.model.get("nick"),a.proxy(this.onChatRoomMessage,this),a.proxy(this.onChatRoomPresence,this),a.proxy(this.onChatRoomRoster,this),c)},initialize:function(){this.connect(null),this.model.messages.on("add",this.onMessageAdded,this),this.model.on("destroy",function(){this.hide(),h.connection.muc.leave(this.model.get("jid"),this.model.get("nick"),a.proxy(this.onLeave,this),void 0)},this),this.$el.appendTo(h.chatboxesview.$el),this.render().show().model.messages.fetch({add:!0})},onLeave:function(){this.model.set("connected",!1)},form_input_template:b.template('<label>{{label}}<input name="{{name}}" type="{{type}}" value="{{value}}"></label>'),select_option_template:b.template('<option value="{{value}}">{{label}}</option>'),form_select_template:b.template('<label>{{label}}<select name="{{name}}">{{options}}</select></label>'),form_checkbox_template:b.template('<label>{{label}}<input name="{{name}}" type="{{type}}" {{checked}}"></label>'),renderConfigurationForm:function(b){var c,d,e=this.$el.find("form.chatroom-form"),f=a(b),g=f.find("field"),h=f.find("title").text(),i=f.find("instructions").text(),j=[],k={"text-private":"password","text-single":"textline","boolean":"checkbox",hidden:"hidden","list-single":"dropdown"};for(e.find("span.spinner").remove(),e.append(a("<legend>").text(h)),i!=h&&e.append(a("<p>").text(i)),c=0;c<g.length;c++)if($field=a(g[c]),"list-single"==$field.attr("type")){for(j=[],$options=$field.find("option"),d=0;d<$options.length;d++)j.push(this.select_option_template({value:a($options[d]).find("value").text(),label:a($options[d]).attr("label")}));e.append(this.form_select_template({name:$field.attr("var"),label:$field.attr("label"),options:j.join("")}))}else e.append("boolean"==$field.attr("type")?this.form_checkbox_template({name:$field.attr("var"),type:k[$field.attr("type")],label:$field.attr("label")||"",checked:"1"===$field.find("value").text()&&'checked="1"'||""}):this.form_input_template({name:$field.attr("var"),type:k[$field.attr("type")],label:$field.attr("label")||"",value:$field.find("value").text()}));e.append('<input type="submit" value="'+p("Save")+'"/>'),e.append('<input type="button" value="'+p("Cancel")+'"/>'),e.on("submit",a.proxy(this.saveConfiguration,this)),e.find("input[type=button]").on("click",a.proxy(this.cancelConfiguration,this))},field_template:b.template('<field var="{{name}}"><value>{{value}}</value></field>'),saveConfiguration:function(b){b.preventDefault();var c=this,d=a(b.target).find(":input:not([type=button]):not([type=submit])"),e=d.length,f=[];d.each(function(){var b,d=a(this);b=d.is("[type=checkbox]")?d.is(":checked")&&1||0:d.val();var g=a(c.field_template({name:d.attr("name"),value:b}))[0];f.push(g),--e||h.connection.muc.saveConfiguration(c.model.get("jid"),f,a.proxy(c.onConfigSaved,c),a.proxy(c.onErrorConfigSaved,c))}),this.$el.find("div.chatroom-form-container").hide(function(){a(this).remove(),c.$el.find(".chat-area").show(),c.$el.find(".participants").show()})},onConfigSaved:function(){},onErrorConfigSaved:function(){this.showStatusNotification(p("An error occurred while trying to save the form."))},cancelConfiguration:function(b){b.preventDefault();var c=this;this.$el.find("div.chatroom-form-container").hide(function(){a(this).remove(),c.$el.find(".chat-area").show(),c.$el.find(".participants").show()})},configureChatRoom:function(b){b.preventDefault(),this.$el.find("div.chatroom-form-container").length||(this.$el.find(".chat-area").hide(),this.$el.find(".participants").hide(),this.$el.find(".chat-body").append(a('<div class="chatroom-form-container"><form class="chatroom-form"><span class="spinner centered"/></form></div>')),h.connection.muc.configure(this.model.get("jid"),a.proxy(this.renderConfigurationForm,this)))},submitPassword:function(a){a.preventDefault();var b=this.$el.find(".chatroom-form").find("input[type=password]").val();this.$el.find(".chatroom-form-container").replaceWith('<span class="spinner centered"/>'),this.connect(b)},renderPasswordForm:function(){this.$el.find("span.centered.spinner").remove(),this.$el.find(".chat-body").append(a('<div class="chatroom-form-container"><form class="chatroom-form"><legend>'+p("This chatroom requires a password")+"</legend><label>"+p("Password: ")+'<input type="password" name="password"/></label><input type="submit" value="'+p("Submit")+"/></form></div>")),this.$el.find(".chatroom-form").on("submit",a.proxy(this.submitPassword,this))},showDisconnectMessage:function(b){this.$el.find(".chat-area").remove(),this.$el.find(".participants").remove(),this.$el.find("span.centered.spinner").remove(),this.$el.find(".chat-body").append(a("<p>"+b+"</p>"))},infoMessages:{100:p("This room is not anonymous"),102:p("This room now shows unavailable members"),103:p("This room does not show unavailable members"),104:p("Non-privacy-related room configuration has changed"),170:p("Room logging is now enabled"),171:p("Room logging is now disabled"),172:p("This room is now non-anonymous"),173:p("This room is now semi-anonymous"),174:p("This room is now fully-anonymous"),201:p("A new room has been created"),210:p("Your nickname has been changed")},actionInfoMessages:{301:q("<strong>%1$s</strong> has been banned"),307:q("<strong>%1$s</strong> has been kicked out"),321:q("<strong>%1$s</strong> has been removed because of an affiliation change"),322:q("<strong>%1$s</strong> has been removed for not being a member")},disconnectMessages:{301:p("You have been banned from this room"),307:p("You have been kicked from this room"),321:p("You have been removed from this room because of an affiliation change"),322:p("You have been removed from this room because the room has changed to members-only and you're not a member"),332:p("You have been removed from this room because the MUC (Multi-user chat) service is being shut down.")},showStatusMessages:function(a,c){var d,e=this.$el.find(".chat-content"),f=a.find("status"),g=[],h=[],i=[];for(d=0;d<f.length;d++){var j=f[d].getAttribute("code");c?b.contains(b.keys(this.disconnectMessages),j)&&g.push(this.disconnectMessages[j]):b.contains(b.keys(this.infoMessages),j)?h.push(this.infoMessages[j]):b.contains(b.keys(this.actionInfoMessages),j)&&i.push(p(this.actionInfoMessages[j],Strophe.unescapeNode(Strophe.getResourceFromJid(a.attr("from")))))}if(g.length>0){for(d=0;d<g.length;d++)this.showDisconnectMessage(g[d]);return void this.model.set("connected",!1)}for(this.renderChatArea(),d=0;d<h.length;d++)e.append(this.info_template({message:h[d]}));for(d=0;d<i.length;d++)e.append(this.info_template({message:i[d]}));return this.scrollDown()},showErrorMessage:function(a,b){delete h.connection.muc[b.name],"auth"==a.attr("type")?a.find("not-authorized").length?this.renderPasswordForm():a.find("registration-required").length?this.showDisconnectMessage(p("You are not on the member list of this room")):a.find("forbidden").length&&this.showDisconnectMessage(p("You have been banned from this room")):"modify"==a.attr("type")?a.find("jid-malformed").length&&this.showDisconnectMessage(p("No nickname was specified")):"cancel"==a.attr("type")&&(a.find("not-allowed").length?this.showDisconnectMessage(p("You are not allowed to create new rooms")):a.find("not-acceptable").length?this.showDisconnectMessage(p("Your nickname doesn't conform to this room's policies")):a.find("conflict").length?this.showDisconnectMessage(p("Your nickname is already taken")):a.find("item-not-found").length?this.showDisconnectMessage(p("This room does not (yet) exist")):a.find("service-unavailable").length&&this.showDisconnectMessage(p("This room has reached it's maximum number of occupants")))},onChatRoomPresence:function(b,c){var d,e=c.nick,f=a(b),g=f.attr("from"),i=f.find("status[code='110']").length||g==c.name+"/"+Strophe.escapeNode(e);if("error"===f.attr("type"))this.model.set("connected",!1),this.showErrorMessage(f.find("error"),c);else{if(this.model.set("connected",!0),this.showStatusMessages(f,i),!this.model.get("connected"))return!0;f.find("status[code='201']").length&&h.connection.muc.createInstantRoom(c.name),i&&(d=f.find("item"),d.length&&"owner"==d.attr("affiliation")&&this.$el.find("a.configure-chatroom-button").show(),f.find("status[code='210']").length&&this.model.set({nick:Strophe.getResourceFromJid(g)}))}return!0},onChatRoomMessage:function(c){var d,e,f,g,i,j=a(c),k=j.children("body").text(),l=j.attr("from"),m=this.$el.find(".chat-content"),n=Strophe.getResourceFromJid(l),o=n&&Strophe.unescapeNode(n)||"",q=j.find("delay").length>0,r=j.children("subject").text();if(q?(i=j.find("delay").attr("stamp"),d=h.parseISO8601(i)):d=new Date,f=m.find("time").map(function(){return a(this).attr("datetime")}).get(),e=new Date(d.getTime()),e.setUTCHours(0,0,0,0),g=h.toISOString(e),-1==b.indexOf(f,g)&&m.append(this.new_day_template({isodate:g,datestring:e.toString().substring(0,15)})),this.showStatusMessages(j),r&&(this.$el.find(".chatroom-topic").text(r).attr("title",r),m.append(this.info_template({message:p("Topic set by %1$s to: %2$s",o,r)}))),!k)return!0;var s=o===this.model.get("nick")&&"me"||"room";return this.showMessage({message:k,sender:s,fullname:o,time:h.toISOString(d)}),"room"===s&&h.emit("onMessage",c),!0},occupant_template:b.template('<li class="{{role}}" {[ if (role === "moderator") { ]}title="'+p("This user is a moderator")+'"{[ } ]}{[ if (role === "participant") { ]}title="'+p("This user can send messages in this room")+'"{[ } ]}{[ if (role === "visitor") { ]}title="'+p("This user can NOT send messages in this room")+'"{[ } ]}>{{nick}}</li>'),onChatRoomRoster:function(a){this.renderChatArea();var c,d=(h.chatboxesview.views.controlbox,b.size(a)),e=this.$el.find(".participant-list"),f=[],g=b.keys(a);for(this.$el.find(".participant-list").empty(),c=0;d>c;c++)f.push(this.occupant_template({role:a[g[c]].role,nick:Strophe.unescapeNode(g[c])}));return e.append(f.join("")),!0}}),this.ChatBoxes=Backbone.Collection.extend({model:h.ChatBox,registerMessageHandler:function(){h.connection.addHandler(a.proxy(function(a){return this.onMessage(a),!0},this),null,"message","chat")},onConnected:function(){this.localStorage=new Backbone.LocalStorage(hex_sha1("converse.chatboxes-"+h.bare_jid)),this.get("controlbox")?this.get("controlbox").save():this.add({id:"controlbox",box_id:"controlbox"}),this.get("controlbox").set({connected:!0}),this.registerMessageHandler(),this.fetch({add:!0,success:a.proxy(function(a,c){b.include(b.pluck(c,"id"),"controlbox")&&this.get("controlbox").set({visible:!0}).save()},this)})},onMessage:function(c){var d,e=a(c),f=e.attr("from");if(f==h.connection.jid)return!0;var g=e.children("forwarded");g.length&&(e=g.children("message"));var i,j,k,l=Strophe.getBareJidFromJid(f),m=Strophe.getBareJidFromJid(e.attr("to"));if(l==h.bare_jid?(d=m,i=Strophe.getResourceFromJid(e.attr("to"))):(d=l,i=Strophe.getResourceFromJid(f)),j=this.get(d),k=h.roster.get(d),void 0===k)return h.log("Could not get roster item for JID "+d,"error"),!0;if(!j){var n=k.get("fullname");n=b.isEmpty(n)?d:n,j=this.create({id:d,jid:d,fullname:n,image_type:k.get("image_type"),image:k.get("image"),url:k.get("url")})}return j.receiveMessage(c),h.roster.addResource(d,i),h.emit("onMessage",c),!0}}),this.ChatBoxesView=Backbone.View.extend({el:"#conversejs",initialize:function(){this.views={},this.model.on("add",function(a){var b=this.views[a.get("id")];b?(delete b.model,b.model=a,b.initialize(),"controlbox"!==a.get("id")&&b.$el.appendTo(this.$el)):(a.get("chatroom")?b=new h.ChatRoomView({model:a}):"controlbox"===a.get("box_id")?(b=new h.ControlBoxView({model:a}),b.render()):b=new h.ChatBoxView({model:a}),this.views[a.get("id")]=b)},this)},showChatBox:function(a){var b=this.model.get(a.jid);return b?b.trigger("show"):b=this.model.create(a,{error:function(a,b){h.log(b.responseText)}}),b}}),this.RosterItem=Backbone.Model.extend({initialize:function(a){var c=a.jid;a.fullname||(a.fullname=c);var d=b.extend({id:c,user_id:Strophe.getNodeFromJid(c),resources:[],status:""},a);d.sorted=!1,d.chat_status="offline",this.set(d)}}),this.RosterItemView=Backbone.View.extend({tagName:"dd",events:{"click .accept-xmpp-request":"acceptRequest","click .decline-xmpp-request":"declineRequest","click .open-chat":"openChat","click .remove-xmpp-contact":"removeContact"},openChat:function(a){a.preventDefault(),h.chatboxesview.showChatBox({id:this.model.get("jid"),jid:this.model.get("jid"),fullname:this.model.get("fullname"),image_type:this.model.get("image_type"),image:this.model.get("image"),url:this.model.get("url"),status:this.model.get("status")})},removeContact:function(a){a.preventDefault();var b=confirm("Are you sure you want to remove this contact?");if(b===!0){var c=this.model.get("jid");h.connection.roster.remove(c,function(){h.connection.roster.unauthorize(c),h.rosterview.model.remove(c)})}},acceptRequest:function(a){var b=this.model.get("jid");h.connection.roster.authorize(b),h.connection.roster.add(b,this.model.get("fullname"),[],function(){h.connection.roster.subscribe(b,null,h.xmppstatus.get("fullname"))}),a.preventDefault()},declineRequest:function(a){a.preventDefault(),h.connection.roster.unauthorize(this.model.get("jid")),this.model.destroy()},template:b.template('<a class="open-chat" title="'+p("Click to chat with this contact")+'" href="#"><span class="icon-{{ chat_status }}" title="{{ status_desc }}"></span>{{ fullname }}</a><a class="remove-xmpp-contact icon-remove" title="'+p("Click to remove this contact")+'" href="#"></a>'),pending_template:b.template('<span>{{ fullname }}</span><a class="remove-xmpp-contact icon-remove" title="'+p("Click to remove this contact")+'" href="#"></a>'),request_template:b.template('<div>{{ fullname }}</div><button type="button" class="accept-xmpp-request">Accept</button><button type="button" class="decline-xmpp-request">Decline</button>'),render:function(){var a=this.model,c=a.get("ask"),d=a.get("requesting"),e=a.get("subscription"),f=["current-xmpp-contact","pending-xmpp-contact","requesting-xmpp-contact"].concat(b.keys(t));return b.each(f,function(a){-1!==this.el.className.indexOf(a)&&this.$el.removeClass(a)},this),this.$el.addClass(a.get("chat_status")),"subscribe"===c?(this.$el.addClass("pending-xmpp-contact"),this.$el.html(this.pending_template(a.toJSON()))):d===!0?(this.$el.addClass("requesting-xmpp-contact"),this.$el.html(this.request_template(a.toJSON())),h.controlboxtoggle.showControlBox()):("both"===e||"to"===e)&&(this.$el.addClass("current-xmpp-contact"),this.$el.html(this.template(b.extend(a.toJSON(),{status_desc:t[a.get("chat_status")||"offline"]})))),this}}),this.RosterItems=Backbone.Collection.extend({model:h.RosterItem,comparator:function(a){var b=a.get("chat_status"),c=4;switch(b){case"offline":c=0;break;case"unavailable":c=1;break;case"xa":c=2;break;case"away":c=3;break;case"dnd":c=4;break;case"online":c=5}return c},subscribeToSuggestedItems:function(b){return a(b).find("item").each(function(){var b=a(this),c=b.attr("jid"),d=b.attr("action"),e=b.attr("name");"add"===d&&h.connection.roster.add(c,e,[],function(){h.connection.roster.subscribe(c,null,h.xmppstatus.get("fullname"))})}),!0},isSelf:function(a){return Strophe.getBareJidFromJid(a)===Strophe.getBareJidFromJid(h.connection.jid)},addResource:function(a,c){var d,e=this.get(a);e&&(d=e.get("resources"),d?-1==b.indexOf(d,c)&&(d.push(c),e.set({resources:d})):e.set({resources:[c]}))},removeResource:function(a,c){var d,e,f=this.get(a);return f&&(d=f.get("resources"),e=b.indexOf(d,c),-1!==e)?(d.splice(e,1),f.set({resources:d}),d.length):0},subscribeBack:function(a){var b=Strophe.getBareJidFromJid(a);h.connection.roster.findItem(b)?(h.connection.roster.authorize(b),h.connection.roster.subscribe(a,null,h.xmppstatus.get("fullname"))):h.connection.roster.add(a,"",[],function(){h.connection.roster.authorize(b),h.connection.roster.subscribe(a,null,h.xmppstatus.get("fullname"))})},unsubscribe:function(a){h.xmppstatus.sendPresence("unsubscribe"),h.connection.roster.findItem(a)&&h.connection.roster.remove(a,function(){h.rosterview.model.remove(a)})},getNumOnlineContacts:function(){var a,c=0,d=["offline","unavailable"],e=this.models,f=e.length;for(h.show_only_online_users&&(d=b.union(d,["dnd","xa","away"])),a=0;f>a;a++)-1===b.indexOf(d,e[a].get("chat_status"))&&c++;return c},cleanCache:function(a){var c,d,e=[];for(d=0;d<a.length;++d)e.push(a[d].jid);for(d=0;d<this.models.length;++d)c=this.models[d].get("id"),-1===b.indexOf(e,c)&&this.get(c).destroy()},rosterHandler:function(a){h.emit("onRoster",a),this.cleanCache(a),b.each(a,function(a,b,c){if(!this.isSelf(a.jid)){var d=this.get(a.jid);if(d)"none"===a.subscription&&null===a.ask?d.destroy():(d.get("subscription")!==a.subscription||d.get("ask")!==a.ask)&&(d.set({subscription:a.subscription,ask:a.ask,requesting:null}),d.save());else{var e=b===c.length-1?!0:!1;if("none"===a.subscription&&null===a.ask&&!e)return;this.create({jid:a.jid,subscription:a.subscription,ask:a.ask,fullname:a.name||a.jid,is_last:e})}}},this),h.initial_presence_sent||(h.initial_presence_sent=1,h.xmppstatus.sendPresence())},handleIncomingSubscription:function(b){var c=Strophe.getBareJidFromJid(b),d=this.get(c);if(!h.allow_contact_requests)return h.connection.roster.unauthorize(c),!0;if(h.auto_subscribe)d&&"to"==d.get("subscription")?h.connection.roster.authorize(c):this.subscribeBack(b);else if(d&&"none"!=d.get("subscription"))h.connection.roster.authorize(c);else{if(this.get(c))return!0;h.getVCard(c,a.proxy(function(a,b,d,e,f){this.add({jid:c,subscription:"none",ask:null,requesting:!0,fullname:b,image:d,image_type:e,url:f,vcard_updated:h.toISOString(new Date),is_last:!0})},this),a.proxy(function(a){h.log("Error while retrieving vcard"),this.add({jid:c,subscription:"none",ask:null,requesting:!0,fullname:a,is_last:!0})},this))}return!0},presenceHandler:function(b){var c=a(b),d=c.attr("type");if("error"===d)return!0;var e,f=c.attr("from"),g=Strophe.getBareJidFromJid(f),i=Strophe.getResourceFromJid(f),j=c.find("show"),k=j.text()||"online",l=c.find("status");return this.isSelf(g)?(h.connection.jid!==f&&"unavailable"!==d&&h.xmppstatus.save({status:k}),!0):0===(c.find("x").attr("xmlns")||"").indexOf(Strophe.NS.MUC)?!0:(e=this.get(g),e&&l.text()!=e.get("status")&&e.save({status:l.text()}),"subscribed"===d||"unsubscribe"===d?!0:"subscribe"===d?this.handleIncomingSubscription(f):("unsubscribed"===d?this.unsubscribe(g):"unavailable"===d?0===this.removeResource(g,i)&&e&&e.set({chat_status:"offline"}):e&&(this.addResource(g,i),e.set({chat_status:k})),!0))}}),this.RosterView=Backbone.View.extend({tagName:"dl",id:"converse-roster",rosteritemviews:{},requesting_contacts_template:b.template('<dt id="xmpp-contact-requests">'+p("Contact requests")+"</dt>"),contacts_template:b.template('<dt id="xmpp-contacts">'+p("My contacts")+"</dt>"),pending_contacts_template:b.template('<dt id="pending-xmpp-contacts">'+p("Pending contacts")+"</dt>"),initialize:function(){this.model.on("add",function(a){this.addRosterItemView(a).render(a),a.get("vcard_updated")||h.getVCard(a.get("jid"))},this),this.model.on("change",function(a){1===b.size(a.changed)&&b.contains(b.keys(a.changed),"sorted")||this.updateChatBox(a).render(a)},this),this.model.on("remove",function(a){this.removeRosterItemView(a)},this),this.model.on("destroy",function(a){this.removeRosterItemView(a)},this);var a=this.contacts_template();h.allow_contact_requests&&(a=this.requesting_contacts_template()+a+this.pending_contacts_template()),this.$el.hide().html(a),this.model.fetch({add:!0})},updateChatBox:function(a){var c=h.chatboxes.get(a.get("jid")),d={};return c?(b.has(a.changed,"chat_status")&&(d.chat_status=a.get("chat_status")),b.has(a.changed,"status")&&(d.status=a.get("status")),c.save(d),this):this},addRosterItemView:function(a){var b=new h.RosterItemView({model:a});return this.rosteritemviews[a.id]=b,this},removeRosterItemView:function(a){var b=this.rosteritemviews[a.id];return b&&(b.$el.remove(),delete this.rosteritemviews[a.id],this.render()),this},renderRosterItem:function(b,c){return h.show_only_online_users&&"online"!==b.get("chat_status")?(c.$el.remove(),c.delegateEvents(),this):void(a.contains(document.documentElement,c.el)?c.render():this.$el.find("#xmpp-contacts").after(c.render().el))},render:function(c){var d,e,f=this.$el.find("#xmpp-contacts"),g=this.$el.find("#xmpp-contact-requests"),i=this.$el.find("#pending-xmpp-contacts"),j=!1;if(c){var k=(c.id,this.rosteritemviews[c.id]),l=c.get("ask"),m=c.get("subscription"),n=c.get("requesting"),o={order:"asc"};"subscribe"===l&&"none"==m?(i.after(k.render().el),i.after(i.siblings("dd.pending-xmpp-contact").tsort(o))):"subscribe"===l&&"from"==m?(i.after(k.render().el),i.after(i.siblings("dd.pending-xmpp-contact").tsort(o))):n===!0?(g.after(k.render().el),g.after(g.siblings("dd.requesting-xmpp-contact").tsort(o))):("both"===m||"to"===m)&&this.renderRosterItem(c,k),e=c.changed.chat_status,e&&(this.sortRoster(e),j=!0),c.get("is_last")&&(j||this.sortRoster(c.get("chat_status")),this.$el.is(":visible")||this.$el.show())
}return b.each([f,g,i],function(a){a.nextUntil("dt").length?a.is(":visible")||a.show():a.is(":visible")&&a.hide()}),d=a("#online-count"),d.text("("+this.model.getNumOnlineContacts()+")"),d.is(":visible")||d.show(),h.emit("onRosterViewUpdated"),this},sortRoster:function(a){var b=this.$el.find("#xmpp-contacts");b.siblings("dd.current-xmpp-contact."+a).tsort("a",{order:"asc"}),b.after(b.siblings("dd.current-xmpp-contact.offline")),b.after(b.siblings("dd.current-xmpp-contact.unavailable")),b.after(b.siblings("dd.current-xmpp-contact.xa")),b.after(b.siblings("dd.current-xmpp-contact.away")),b.after(b.siblings("dd.current-xmpp-contact.dnd")),b.after(b.siblings("dd.current-xmpp-contact.online"))}}),this.XMPPStatus=Backbone.Model.extend({initialize:function(){this.set({status:this.get("status")||"online"}),this.on("change",a.proxy(function(c){void 0===this.get("fullname")&&h.getVCard(null,a.proxy(function(a,b){this.save({fullname:b})},this)),b.has(c.changed,"status")&&h.emit("onStatusChanged",this.get("status")),b.has(c.changed,"status_message")&&h.emit("onStatusMessageChanged",this.get("status_message"))},this))},sendPresence:function(a){void 0===a&&(a=this.get("status")||"online");var b,c=this.get("status_message");"unavailable"===a||"probe"===a||"error"===a||"unsubscribe"===a||"unsubscribed"===a||"subscribe"===a||"subscribed"===a?b=$pres({type:a}):(b="online"===a?$pres():$pres().c("show").t(a).up(),c&&b.c("status").t(c)),h.connection.send(b)},setStatus:function(a){this.sendPresence(a),this.save({status:a})},setStatusMessage:function(b){h.connection.send($pres().c("show").t(this.get("status")).up().c("status").t(b)),this.save({status_message:b}),this.xhr_custom_status&&a.ajax({url:this.xhr_custom_status_url,type:"POST",data:{msg:b}})}}),this.XMPPStatusView=Backbone.View.extend({el:"span#xmpp-status-holder",events:{"click a.choose-xmpp-status":"toggleOptions","click #fancy-xmpp-status-select a.change-xmpp-status-message":"renderStatusChangeForm","submit #set-custom-xmpp-status":"setStatusMessage","click .dropdown dd ul li a":"setStatus"},toggleOptions:function(b){b.preventDefault(),a(b.target).parent().parent().siblings("dd").find("ul").toggle("fast")},change_status_message_template:b.template('<form id="set-custom-xmpp-status"><input type="text" class="custom-xmpp-status" {{ status_message }}"placeholder="'+p("Custom status")+'"/><button type="submit">'+p("Save")+"</button></form>"),status_template:b.template('<div class="xmpp-status"><a class="choose-xmpp-status {{ chat_status }}" data-value="{{status_message}}" href="#" title="'+p("Click to change your chat status")+'"><span class="icon-{{ chat_status }}"></span>{{ status_message }}</a><a class="change-xmpp-status-message icon-pencil" href="#" title="'+p("Click here to write a custom status message")+'"></a></div>'),renderStatusChangeForm:function(a){a.preventDefault();var b=this.model.get("status")||"offline",c=this.change_status_message_template({status_message:b});this.$el.find(".xmpp-status").replaceWith(c),this.$el.find(".custom-xmpp-status").focus().focus()},setStatusMessage:function(b){b.preventDefault();var c=a(b.target).find("input").val();this.model.setStatusMessage(c)},setStatus:function(b){b.preventDefault();var c=a(b.target),d=c.attr("data-value");this.model.setStatus(d),this.$el.find(".dropdown dd ul").hide()},getPrettyStatus:function(a){return pretty_status="chat"===a?p("online"):"dnd"===a?p("busy"):"xa"===a?p("away for long"):"away"===a?p("away"):p(a)||p("online")},updateStatusUI:function(a){if(b.has(a.changed,"status")||b.has(a.changed,"status_message")){var c=a.get("status"),d=a.get("status_message")||p("I am %1$s",this.getPrettyStatus(c));this.$el.find("#fancy-xmpp-status-select").html(this.status_template({chat_status:c,status_message:d}))}},choose_template:b.template('<dl id="target" class="dropdown"><dt id="fancy-xmpp-status-select" class="fancy-dropdown"></dt><dd><ul class="xmpp-status-menu"></ul></dd></dl>'),option_template:b.template('<li><a href="#" class="{{ value }}" data-value="{{ value }}"><span class="icon-{{ value }}"></span>{{ text }}</a></li>'),initialize:function(){this.model.on("change",this.updateStatusUI,this)},render:function(){var b,c=this.$el.find("select#select-xmpp-status"),d=this.model.get("status")||"offline",e=a("option",c),f=[],g=this;return this.$el.html(this.choose_template()),this.$el.find("#fancy-xmpp-status-select").html(this.status_template({status_message:this.model.get("status_message")||p("I am %1$s",this.getPrettyStatus(d)),chat_status:d})),e.each(function(){f.push(g.option_template({value:a(this).val(),text:this.text}))}),b=this.$el.find("#target dd ul").hide(),b.append(f.join("")),c.remove(),this}}),this.Feature=Backbone.Model.extend(),this.Features=Backbone.Collection.extend({model:h.Feature,initialize:function(){this.localStorage=new Backbone.LocalStorage(hex_sha1("converse.features"+h.bare_jid)),0===this.localStorage.records.length?(h.connection.disco.info(h.domain,null,a.proxy(this.onInfo,this)),h.connection.disco.items(h.domain,null,a.proxy(this.onItems,this))):this.fetch({add:!0})},onItems:function(b){a(b).find("query item").each(a.proxy(function(b,c){h.connection.disco.info(a(c).attr("jid"),null,a.proxy(this.onInfo,this))},this))},onInfo:function(b){var c=a(b);(0!==c.find("identity[category=server][type=im]").length||0!==c.find("identity[category=conference][type=text]").length)&&c.find("feature").each(a.proxy(function(b,d){this.create({"var":a(d).attr("var"),from:c.attr("from")})},this))}}),this.LoginPanel=Backbone.View.extend({tagName:"div",id:"login-dialog",events:{"submit form#converse-login":"authenticate"},tab_template:b.template('<li><a class="current" href="#login">'+p("Sign in")+"</a></li>"),template:b.template('<form id="converse-login"><label>'+p("XMPP/Jabber Username:")+'</label><input type="username" name="jid"><label>'+p("Password:")+'</label><input type="password" name="password"><input class="login-submit" type="submit" value="'+p("Log In")+'"></form">'),bosh_url_input:b.template("<label>"+p("BOSH Service URL:")+'</label><input type="text" id="bosh_service_url">'),connect:function(a,b,c){a&&a.find("input[type=submit]").hide().after('<span class="spinner login-submit"/>'),h.connection=new Strophe.Connection(h.bosh_service_url),h.connection.connect(b,c,h.onConnect)},showLoginButton:function(){var a=this.$el.find("#converse-login"),b=a.find("input[type=submit]");b.length&&b.show().siblings("span").remove()},initialize:function(a){a.$parent.html(this.$el.html(this.template())),this.$tabs=a.$parent.parent().find("#controlbox-tabs")},render:function(){return this.$tabs.append(this.tab_template()),this.$el.find("input#jid").focus(),this},authenticate:function(b){var c=a(b.target),d=c.find("input[name=jid]"),e=d.val(),f=c.find("input[name=password]"),g=f.val(),i=null,j=!1;return h.bosh_service_url||(i=c.find("input#bosh_service_url"),h.bosh_service_url=i.val(),h.bosh_service_url||(j=!0,i.addClass("error"))),e||(j=!0,d.addClass("error")),g||(j=!0,f.addClass("error")),j?void 0:(this.connect(c,e,g),!1)},remove:function(){this.$tabs.empty(),this.$el.parent().empty()}}),this.ControlBoxToggle=Backbone.View.extend({tagName:"a",className:"toggle-online-users",id:"toggle-controlbox",events:{click:"onClick"},attributes:{href:"#"},template:b.template('<strong class="conn-feedback">Toggle chat</strong><strong style="display: none" id="online-count">(0)</strong>'),initialize:function(){this.render()},render:function(){return a("#conversejs").append(this.$el.html(this.template())),this},showControlBox:function(){var a=h.chatboxes.get("controlbox");a?a.trigger("show"):(h.chatboxes.add({id:"controlbox",box_id:"controlbox",visible:!0}),h.connection&&h.chatboxes.get("controlbox").save())},onClick:function(b){if(b.preventDefault(),a("div#controlbox").is(":visible")){var c=h.chatboxes.get("controlbox");h.connection?c.destroy():c.trigger("hide")}else this.showControlBox()}}),this.chatboxes=new this.ChatBoxes,this.chatboxesview=new this.ChatBoxesView({model:this.chatboxes}),this.controlboxtoggle=new this.ControlBoxToggle,this.otr=new this.OTR,this.prebind&&!this.connection){if(!(this.jid&&this.sid&&this.rid&&this.bosh_service_url))return void this.log("If you set prebind=true, you MUST supply JID, RID and SID values");this.connection=new Strophe.Connection(this.bosh_service_url),this.connection.attach(this.jid,this.sid,this.rid,this.onConnect)}else this.connection&&this.onConnected();this.show_controlbox_by_default&&this.controlboxtoggle.showControlBox(),h.emit("onInitialized")},{initialize:function(a,b){f.initialize(a,b)},setStatus:function(a){f.xmppstatus&&f.xmppstatus.setStatus(a)},getStatus:function(){return f.xmppstatus&&f.xmppstatus.attributes?f.xmppstatus.attributes.status:null},getRID:function(){return f.expose_rid_and_sid&&"undefined"!=typeof f.connection?f.connection.rid:null},getSID:function(){return f.expose_rid_and_sid&&"undefined"!=typeof f.connection?f.connection.sid:null},once:function(a,b){f.once(a,b)},on:function(a,b){f.on(a,b)},off:function(a,b){f.off(a,b)}}});