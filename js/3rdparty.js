/***************************************************
* Created on Mon Jan 14 15:32:43 GMT 2013 by:
*
* Copyright 2014 Broadsoft
* http://www.broadsoft.com
***************************************************/


function getLastValue(a,b,c,d){return getLastValueAt(a,b,c,d,1)}function getLastValueAt(a,b,c,d,e){var f=getDataSeries(a.id,b,c,d);return f?f.dataPoints_[f.dataPoints_.length-e].value:null}function getAvgValue(a,b,c,d){var e=getDataSeries(a.id,b,c,d);return e?e.getAvg():null}function getDataSeries(a,b,c,d){var e=this.dataSeriesId(a,b,c,d);return dataSeries[e]}function getDataSeriesByLabel(a,b,c){var d=Object.keys(dataSeries),e=[],f=new RegExp(a+".*"+b+".*"+c);for(i=0;i<d.length;i++){var g=d[i];if(f.test(g)){e.push(dataSeries[g])}}return e}function getValueBefore(a,b,c,d,e){var f=this.dataSeriesId(a.id,b,c,d),g=dataSeries[f];if(g){for(i=g.dataPoints_.length-1;i>=0;i--)if(g.dataPoints_[i].time<e)return g.dataPoints_[i].value;return g.dataPoints_[0].value}return null}function dataSeriesId(a,b,c,d){return a+"-"+b+"-"+c+"-"+d}function graphViewId(a,b,c,d){return a.id+"-"+b+"-"+c+"-"+d}function matchesType(a,b,c){return"video"==b&&isVideoStats(c)?!0:"audio"==b&&isAudioStats(c)&&("googJitterReceived"!=a||containsLabel(c,"audioOutputLevel"))?!0:!1}function isVideoStats(a){return containsLabel(a,"googFrameHeightSent")||containsLabel(a,"googFrameHeightReceived")}function isAudioStats(a){return containsLabel(a,"audioInputLevel")||containsLabel(a,"audioOutputLevel")}function getStatsDataType(a,b){return isVideoStats(b)?"video":isAudioStats(b)&&("googJitterReceived"!=a||containsLabel(b,"audioOutputLevel"))?"audio":null}function containsLabel(a,b){for(var c=0;c<a.length-1;c+=2)if(a[c]==b)return!0;return!1}function updateGraph(a,b,c,d,e){var f=bweCompoundGraphConfig[e]?"bweCompound":e,g=this.graphViewId(a,b,c,f);if(!graphViews[g]){var h=getStatsDataType(e,d.values);graphViews[g]=createStatsGraphView(a,b,c,f,h);var i=new Date(d.timestamp);graphViews[g].setDateRange(i,i)}var j=this.dataSeriesId(a.id,b,c,e);graphViews[g].hasDataSeries(dataSeries[j])||graphViews[g].addDataSeries(dataSeries[j]),graphViews[g].updateEndDate()}function drawSingleReport(a,b,c,d){if(d&&d.values)for(var e=0;e<d.values.length-1;e+=2){var f=d.values[e],g=parseInt(d.values[e+1]);if(!isNaN(g)){var h=dataSeriesId(a.id,b,c,f),i=h,j=f,k=g;dataConversionConfig[f]&&(addDataSeriesPoint(h,d.timestamp,f,g),k=dataConversionConfig[f].convertFunction(dataSeries[h],a,b,c),j=dataConversionConfig[f].convertedName,i=dataSeriesId(a.id,b,c,j)),addDataSeriesPoint(i,d.timestamp,j,k),updateGraph(a,b,c,d,f),j!=f&&updateGraph(a,b,c,d,j)}}}function addDataSeriesPoint(a,b,c,d){dataSeries[a]||(dataSeries[a]=new TimelineDataSeries,bweCompoundGraphConfig[c]&&dataSeries[a].setColor(bweCompoundGraphConfig[c].color)),"packetsLost"==c&&0>d&&(d=0),dataSeries[a].addPoint(b,d)}function ensureStatsGraphTopContainer(a,b,c){var d=a.id+"-"+b+"-"+c+"-graph-container",e=$('[id="'+d+'"]')[0];return e||(e=document.createElement("div"),e.id=d,e.className="stats-graph-container",a.appendChild(e)),e}function createStatsGraphView(a,b,c,d,e){var f=ensureStatsGraphTopContainer(a,b,c),g=a.id+"-"+b+"-"+c+"-"+d,h=g+"-div",i=g+"-canvas",j=document.createElement("div");return j.className="stats-graph-sub-container "+d+"-"+e,f.appendChild(j),j.innerHTML="<div>"+d+"</div><div id="+h+"><canvas id="+i+"></canvas></div>","bweCompound"==d&&j.insertBefore(createBweCompoundLegend(a,b+"-"+c),$('[id="'+h+'"]')[0]),new TimelineGraphView(h,i)}function createBweCompoundLegend(a,b){var c=document.createElement("div");for(var d in bweCompoundGraphConfig){var e=document.createElement("div");c.appendChild(e),e.innerHTML="<input type=checkbox checked></input>"+d,e.style.color=bweCompoundGraphConfig[d].color,e.dataSeriesId=a.id+"-"+b+"-"+d,e.graphViewId=a.id+"-"+b+"-bweCompound",e.firstChild.addEventListener("click",function(a){var b=dataSeries[a.target.parentNode.dataSeriesId];b.show(a.target.checked),graphViews[a.target.parentNode.graphViewId].repaint()})}return c}function initialize(){ssrcInfoManager=new SsrcInfoManager,peerConnectionUpdateTable=new PeerConnectionUpdateTable,statsTable=new StatsTable(ssrcInfoManager)}function getPeerConnectionId(a){return a.pid+"-"+a.lid}function extractSsrcInfo(a){("setLocalDescription"==a.type||"setRemoteDescription"==a.type)&&ssrcInfoManager.addSsrcStreamInfo(a.value)}function removePeerConnection(a){var b=$('[id="'+getPeerConnectionId(a)+'"]')[0];b&&peerConnectionsListElem.removeChild(b)}function addPeerConnection(a){var b=$('[id="'+getPeerConnectionId(a)+'"]')[0];return b||(b=document.createElement("li"),peerConnectionsListElem.appendChild(b),b.id=getPeerConnectionId(a)),b.innerHTML="<h3>PeerConnection "+b.id+"</h3><div>"+a.url+" "+a.servers+" "+a.constraints+"</div>",b.firstChild.title="Click to collapse or expand",b.firstChild.addEventListener("click",function(a){a.target.parentElement.className=""==a.target.parentElement.className?"peer-connection-hidden":""}),b}function updatePeerConnection(a){var b=$('[id="'+getPeerConnectionId(a)+'"]')[0];peerConnectionUpdateTable.addPeerConnectionUpdate(b,a),extractSsrcInfo(a)}function updateAllPeerConnections(a){for(var b=0;b<a.length;++b)for(var c=addPeerConnection(a[b]),d=a[b].log,e=0;e<d.length;++e)peerConnectionUpdateTable.addPeerConnectionUpdate(c,d[e]),extractSsrcInfo(d[e])}function addStats(a){var b=getPeerConnectionElement(a);if(b)for(var c=0;c<a.reports.length;++c){var d=a.reports[c];if(drawSingleReport(b,d.type,d.id,d.stats),statsTable.addStatsReport(b,d.type,d.id,d),isVideoStats(d.stats.values)){var e=new Date((new Date).getTime()-6e4),f=getLastValue(b,d.type,d.id,"packetsLost"),g=getLastValue(b,d.type,d.id,"packetsReceived");if(null!=f&&null!=g){var h=getValueBefore(b,d.type,d.id,"packetsLost",e),i=getValueBefore(b,d.type,d.id,"packetsReceived",e),j=(f-h)/(g-i)*100;10>j?($("#quality1").fadeIn(10),$("#quality2, #quality3, #quality4").fadeOut(10)):j>10&&20>j?($("#quality2").fadeIn(10),$("#quality1, #quality3, #quality4").fadeOut(10)):j>20&&100>j?($("#quality3").fadeIn(10),$("#quality1, #quality2, #quality4").fadeOut(10)):j>100&&1e3>j&&($("#quality4").fadeIn(10),$("#quality1, #quality2, #quality3").fadeOut(10))}}}}function getPeerConnectionElement(a){return $('[id="'+getPeerConnectionId(a)+'"]')[0]}function updateDumpStatus(a){dumpCreator.onUpdate(a)}var peerConnectionsListElem=null,ssrcInfoManager=null,peerConnectionUpdateTable=null,statsTable=null,dumpCreator=null,SsrcInfoManager=function(){"use strict";function a(){this.streamInfoContainer_={},this.ATTRIBUTE_SEPARATOR_=/[\r,\n]/,this.FIELD_SEPARATOR_REGEX_=/ .*:/,this.SSRC_ATTRIBUTE_PREFIX_="a=ssrc:",this.SSRC_INFO_BLOCK_CLASS_="ssrc-info-block"}return a.prototype={addSsrcStreamInfo:function(a){for(var b=a.split(this.ATTRIBUTE_SEPARATOR_),c=0;c<b.length;++c)if(0==b[c].indexOf(this.SSRC_ATTRIBUTE_PREFIX_)){var d=b[c].search(this.FIELD_SEPARATOR_REGEX_);if(-1!=d){var e=b[c].substring(this.SSRC_ATTRIBUTE_PREFIX_.length,d);this.streamInfoContainer_[e]||(this.streamInfoContainer_[e]={});for(var f,g,h=b[c].substring(d+1);h.length>0;)d=h.search(this.FIELD_SEPARATOR_REGEX_),-1==d&&(d=h.length),f=h.substring(0,h.indexOf(":")),g=h.substring(h.indexOf(":")+1,d),this.streamInfoContainer_[e][f]=g,h=h.substring(d+1)}}},getStreamInfo:function(a){return this.streamInfoContainer_[a]},populateSsrcInfo:function(a,b){if(this.streamInfoContainer_[b]){a.className=this.SSRC_INFO_BLOCK_CLASS_;var c;for(var d in this.streamInfoContainer_[b])c=document.createElement("div"),a.appendChild(c),c.textContent=d+":"+this.streamInfoContainer_[b][d]}}},a}(),TimelineDataSeries=function(){"use strict";function a(){this.dataPoints_=[],this.color_="red",this.isVisible_=!0,this.cacheStartTime_=null,this.cacheStepSize_=0,this.cacheValues_=[]}function b(a,b){this.time=a,this.value=b}return a.prototype={addPoint:function(a,c){var d=new Date(a);this.dataPoints_.push(new b(d,c))},isVisible:function(){return this.isVisible_},show:function(a){this.isVisible_=a},getColor:function(){return this.color_},setColor:function(a){this.color_=a},getAvg:function(){for(var a=0,b=0;b<this.dataPoints_.length;b++)a+=this.dataPoints_[b].value;return a/this.dataPoints_.length},getValues:function(a,b,c){return this.cacheStartTime_==a&&this.cacheStepSize_==b&&this.cacheValues_.length==c?this.cacheValues_:(this.cacheValues_=this.getValuesInternal_(a,b,c),this.cacheStartTime_=a,this.cacheStepSize_=b,this.cacheValues_)},getValuesInternal_:function(a,b,c){for(var d=[],e=0,f=0,g=a,h=0;c>h;++h){for(;e<this.dataPoints_.length&&this.dataPoints_[e].time<g;)f=this.dataPoints_[e].value,++e;d[h]=f,g+=b}return d}},a}(),TimelineGraphView=function(){"use strict";function a(a,b){this.scrollbar_={position_:0,range_:0},this.graphDiv_=$('[id="'+a+'"]')[0],this.canvas_=$('[id="'+b+'"]')[0],this.startTime_=0,this.endTime_=1,this.graph_=null,this.updateScrollbarRange_(!0)}var b=2e3,c=6,d=4,e=3,f=25,g=10,h="#CCC",i="#000",j="#FFF";a.prototype={getLength_:function(){var a=this.endTime_-this.startTime_;return Math.floor(a/b)},graphScrolledToRightEdge_:function(){return this.scrollbar_.position_==this.scrollbar_.range_},updateScrollbarRange_:function(a){var b=this.getLength_()-this.canvas_.width;0>b&&(b=0),this.scrollbar_.position_>b&&(a=!0),this.scrollbar_.range_=b,a&&(this.scrollbar_.position_=b,this.repaint())},setDateRange:function(a,b){this.startTime_=a.getTime(),this.endTime_=b.getTime(),this.endTime_<=this.startTime_&&(this.startTime_=this.endTime_-1),this.updateScrollbarRange_(!0)},updateEndDate:function(){this.endTime_=(new Date).getTime(),this.updateScrollbarRange_(this.graphScrolledToRightEdge_())},getStartDate:function(){return new Date(this.startTime_)},setDataSeries:function(a){this.graph_=new k;for(var b=0;b<a.length;++b)this.graph_.addDataSeries(a[b]);this.repaint()},addDataSeries:function(a){this.graph_||(this.graph_=new k),this.graph_.addDataSeries(a),this.repaint()},repaint:function(){this.repaintTimerRunning_=!1;var a=this.canvas_.width,c=this.canvas_.height,e=this.canvas_.getContext("2d");e.fillStyle=j,e.fillRect(0,0,a,c);var f=e.font.match(/([0-9]+)px/)[1],g=parseInt(f);if(!(0==f.length||0>=g||4*g>c||50>a)){e.save(),e.translate(.5,.5);var i=this.scrollbar_.position_;0==this.scrollbar_.range_&&(i=this.getLength_()-this.canvas_.width);var k=this.startTime_+i*b,l=c;c-=g+d,this.drawTimeLabels(e,a,c,l,k),e.strokeStyle=h,e.strokeRect(0,0,a-1,c-1),this.graph_&&(this.graph_.layout(a,c,g,k,b),this.graph_.drawTicks(e),this.graph_.drawLines(e),this.graph_.drawLabels(e)),e.restore()}},drawTimeLabels:function(a,c,d,e,g){for(var j=new Date(g).toLocaleTimeString(),k=a.measureText(j).width+f,l=[1e3,5e3,3e4,6e4,3e5,18e5,36e5,18e6],m=null,n=0;n<l.length;++n)if(l[n]/b>=k){m=l[n];break}if(m){var o=Math.ceil(g/m)*m;for(a.textBaseline="bottom",a.textAlign="center",a.fillStyle=i,a.strokeStyle=h;;){var p=Math.round((o-g)/b);if(p>=c)break;var q=new Date(o).toLocaleTimeString();a.fillText(q,p,e),a.beginPath(),a.lineTo(p,0),a.lineTo(p,d),a.stroke(),o+=m}}},getDataSeriesCount:function(){return this.graph_?this.graph_.dataSeries_.length:0},hasDataSeries:function(a){return this.graph_?this.graph_.hasDataSeries(a):!1}};var k=function(){function a(){this.dataSeries_=[],this.width_=0,this.height_=0,this.fontHeight_=0,this.startTime_=0,this.scale_=0,this.max_=0,this.labels_=[]}return a.prototype={addDataSeries:function(a){this.dataSeries_.push(a)},hasDataSeries:function(a){for(var b=0;b<this.dataSeries_.length;++b)if(this.dataSeries_[b]==a)return!0;return!1},getValues:function(a){return a.isVisible()?a.getValues(this.startTime_,this.scale_,this.width_):null},layout:function(a,b,c,d,e){this.width_=a,this.height_=b,this.fontHeight_=c,this.startTime_=d,this.scale_=e;for(var f=0,g=0;g<this.dataSeries_.length;++g){var h=this.getValues(this.dataSeries_[g]);if(h)for(var i=0;i<h.length;++i)h[i]>f&&(f=h[i])}this.layoutLabels_(f)},layoutLabels_:function(a){if(1024>a)return void this.layoutLabelsBasic_(a,0);var b=["","m","M","G","T","P"],c=1;for(a/=1024;b[c+1]&&a>=1024;)a/=1024,++c;this.layoutLabelsBasic_(a,1);for(var d=0;d<this.labels_.length;++d)this.labels_[d]+=" "+b[c];this.max_*=Math.pow(1024,c)},layoutLabelsBasic_:function(a,b){if(this.labels_=[],0==a)return void(this.max_=a);var e=2*this.fontHeight_+d,f=1+this.height_/e;2>f?f=2:f>c&&(f=c);for(var g=Math.pow(10,-b),h=b;;){if(Math.ceil(a/g)+1<=f)break;if(Math.ceil(a/(2*g))+1<=f){g*=2;break}if(Math.ceil(a/(5*g))+1<=f){g*=5;break}g*=10,h>0&&--h}this.max_=Math.ceil(a/g)*g;for(var i=this.max_;i>=0;i-=g)this.labels_.push(i.toFixed(h))},drawTicks:function(a){var b,c;b=this.width_-1,c=this.width_-1-g,a.fillStyle=h,a.beginPath();for(var d=1;d<this.labels_.length-1;++d){var e=Math.round(this.height_*d/(this.labels_.length-1));a.moveTo(b,e),a.lineTo(c,e)}a.stroke()},drawLines:function(a){var b=0,c=this.height_-1;this.max_&&(b=c/this.max_);for(var d=this.dataSeries_.length-1;d>=0;--d){var e=this.getValues(this.dataSeries_[d]);if(e){a.strokeStyle=this.dataSeries_[d].getColor(),a.beginPath();for(var f=0;f<e.length;++f)a.lineTo(f,c-Math.round(e[f]*b));a.stroke()}}},drawLabels:function(a){if(0!=this.labels_.length){var b=this.width_-e;a.fillStyle=i,a.textAlign="right",a.textBaseline="top",a.fillText(this.labels_[0],b,0),a.textBaseline="bottom";for(var c=(this.height_-1)/(this.labels_.length-1),d=1;d<this.labels_.length;++d)a.fillText(this.labels_[d],b,c*d)}}},a}();return a}(),STATS_GRAPH_CONTAINER_HEADING_CLASS="stats-graph-container-heading",bweCompoundGraphConfig={googAvailableSendBandwidth:{color:"red"},googTargetEncBitrateCorrected:{color:"purple"},googActualEncBitrate:{color:"orange"},googRetransmitBitrate:{color:"blue"},googTransmitBitrate:{color:"green"}},totalToPerSecond=function(a){var b=a.dataPoints_.length;if(b>=2){var c=a.dataPoints_[b-1],d=a.dataPoints_[b-2];return Math.round(1e3*(c.value-d.value)/(c.time-d.time))}return 0},totalBytesToBitsPerSecond=function(a){return 8*totalToPerSecond(a)},totalKiloBytesToBitsPerSecond=function(a){return totalBytesToBitsPerSecond(a)/1e3},packetsLostPercentage=function(a,b,c,d){var e=getLastValue(b,c,d,"packetsLost"),f=getLastValue(b,c,d,"packetsReceived");return null!=e&&null!=f?Math.round(100*e/(f+e)*100)/100:null},dataConversionConfig={packetsSent:{convertedName:"packetsSentPerSecond",convertFunction:totalToPerSecond},bytesSent:{convertedName:"kiloBitsSentPerSecond",convertFunction:totalKiloBytesToBitsPerSecond},packetsReceived:{convertedName:"packetsReceivedPerSecond",convertFunction:totalToPerSecond},bytesReceived:{convertedName:"kiloBitsReceivedPerSecond",convertFunction:totalKiloBytesToBitsPerSecond},packetsLost:{convertedName:"packetsLostPer",convertFunction:packetsLostPercentage},googTargetEncBitrate:{convertedName:"googTargetEncBitrateCorrected",convertFunction:function(a){var b=a.dataPoints_.length,c=a.dataPoints_[b-1];return c.value<5e3?1e3*c.value:c.value}}},graphViews={},dataSeries={},StatsTable=function(){"use strict";function a(a){this.ssrcInfoManager_=a}return a.prototype={addStatsReport:function(a,b,c,d){var e=this.ensureStatsTable_(a,d);d.stats&&this.addStatsToTable_(a,b,c,e,d.stats.timestamp,d.stats.values)},ensureStatsTableContainer_:function(a){var b=a.id+"-table-container",c=$('[id="'+b+'"]')[0];return c||(c=document.createElement("div"),c.id=b,c.className="stats-table-container",a.appendChild(c)),c},ensureStatsTable_:function(a,b){var c=a.id+"-table-"+b.type+"-"+b.id,d=$(document.getElementById(c))[0];if(!d){var e=this.ensureStatsTableContainer_(a);d=document.createElement("table"),e.appendChild(d),d.id=c,d.border=1,d.innerHTML="<tr><th colspan=2></th></tr>",d.rows[0].cells[0].textContent="Statistics "+b.type+"-"+b.id,"ssrc"==b.type&&(d.insertRow(1),d.rows[1].innerHTML="<td colspan=2></td>",this.ssrcInfoManager_.populateSsrcInfo(d.rows[1].cells[0],b.id))}return d},addStatsToTable_:function(a,b,c,d,e,f){Date(e);$(".stats-var").each(function(){var d=$(this).data("var"),e=$(this).data("type");if(matchesType(d,e,f)){var g=getLastValue(a,b,c,d);null!=g&&($(this).html(g),$(this).attr("data-avg",getAvgValue(a,b,c,d)))}})},updateStatsTableRow_:function(a,b,c){var d=a.id+"-"+b,e=$('[id="'+d+'"]')[0];e||(e=document.createElement("tr"),e.id=d,a.firstChild.appendChild(e),e.innerHTML="<td>"+b+"</td><td></td>"),e.cells[1].textContent=c}},a}(),PeerConnectionUpdateEntry=function(a,b,c,d){this.pid=a,this.lid=b,this.type=c,this.value=d},PeerConnectionUpdateTable=function(){"use strict";function a(){this.UPDATE_LOG_ID_SUFFIX_="-update-log",this.UPDATE_LOG_CONTAINER_CLASS_="update-log-container",this.UPDATE_LOG_TABLE_CLASS_="update-log-table"}return a.prototype={addPeerConnectionUpdate:function(a,b){var c=this.ensureUpdateContainer_(a),d=document.createElement("tr");if(c.firstChild.appendChild(d),d.innerHTML="<td>"+(new Date).toLocaleString()+"</td>",0==b.value.length)return void(d.innerHTML+="<td>"+b.type+"</td>");d.innerHTML+="<td><details><summary>"+b.type+"</summary></details></td>";var e=document.createElement("pre"),f=d.cells[1].childNodes[0];f.appendChild(e),e.textContent=b.value},ensureUpdateContainer_:function(a){var b=a.id+this.UPDATE_LOG_ID_SUFFIX_,c=$('[id="'+b+'"]')[0];if(!c){var d=document.createElement("div");d.className=this.UPDATE_LOG_CONTAINER_CLASS_,a.appendChild(d),c=document.createElement("table"),c.className=this.UPDATE_LOG_TABLE_CLASS_,c.id=b,c.border=1,d.appendChild(c),c.innerHTML='<tr><th>Time</th><th class="update-log-header-event">Event</th></tr>'}return c}},a}(),DumpCreator=function(){function a(a){this.recording_=!1,this.StatusStrings_={NOT_STARTED:"not started.",RECORDING:"recording..."},this.status_=this.StatusStrings_.NOT_STARTED,this.root_=document.createElement("details"),this.root_.className="peer-connection-dump-root",a.appendChild(this.root_);var b=document.createElement("summary");this.root_.appendChild(b),b.textContent="Create Dump";var c=document.createElement("pre");this.root_.appendChild(c),c.innerHTML="<button></button> Status: <span></span>",c.getElementsByTagName("button")[0].addEventListener("click",this.onToggled_.bind(this)),this.updateDisplay_()}return a.prototype={onToggled_:function(){this.recording_?(this.recording_=!1,this.status_=this.StatusStrings_.NOT_STARTED,chrome.send("stopRtpRecording")):(this.recording_=!0,this.status_=this.StatusStrings_.RECORDING,chrome.send("startRtpRecording")),this.updateDisplay_()},updateDisplay_:function(){this.root_.getElementsByTagName("button")[0].textContent=this.recording_?"Stop Recording RTP Packets":"Start Recording RTP Packets",this.root_.getElementsByTagName("span")[0].textContent=this.status_},onUpdate:function(a){this.recording_&&(this.status_=JSON.stringify(a),this.updateDisplay_())}},a}();document.addEventListener("DOMContentLoaded",initialize),function(b){var c=b.detect=function(){var b=function(){},c={browser_parsers:[{regex:"^(Opera)/(\\d+)\\.(\\d+) \\(Nintendo Wii",family_replacement:"Wii",manufacturer:"Nintendo"},{regex:"(SeaMonkey|Camino)/(\\d+)\\.(\\d+)\\.?([ab]?\\d+[a-z]*)",family_replacement:"Camino",other:!0},{regex:"(Pale[Mm]oon)/(\\d+)\\.(\\d+)\\.?(\\d+)?",family_replacement:"Pale Moon (Firefox Variant)",other:!0},{regex:"(Fennec)/(\\d+)\\.(\\d+)\\.?([ab]?\\d+[a-z]*)",family_replacement:"Firefox Mobile"},{regex:"(Fennec)/(\\d+)\\.(\\d+)(pre)",family_replacment:"Firefox Mobile"},{regex:"(Fennec)/(\\d+)\\.(\\d+)",family_replacement:"Firefox Mobile"},{regex:"Mobile.*(Firefox)/(\\d+)\\.(\\d+)",family_replacement:"Firefox Mobile"},{regex:"(Namoroka|Shiretoko|Minefield)/(\\d+)\\.(\\d+)\\.(\\d+(?:pre)?)",family_replacement:"Firefox ($1)"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(a\\d+[a-z]*)",family_replacement:"Firefox Alpha"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(b\\d+[a-z]*)",family_replacement:"Firefox Beta"},{regex:"(Firefox)-(?:\\d+\\.\\d+)?/(\\d+)\\.(\\d+)(a\\d+[a-z]*)",family_replacement:"Firefox Alpha"},{regex:"(Firefox)-(?:\\d+\\.\\d+)?/(\\d+)\\.(\\d+)(b\\d+[a-z]*)",family_replacement:"Firefox Beta"},{regex:"(Namoroka|Shiretoko|Minefield)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)?",family_replacement:"Firefox ($1)"},{regex:"(Firefox).*Tablet browser (\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"MicroB",tablet:!0},{regex:"(MozillaDeveloperPreview)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)?"},{regex:"(Flock)/(\\d+)\\.(\\d+)(b\\d+?)",family_replacement:"Flock",other:!0},{regex:"(RockMelt)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Rockmelt",other:!0},{regex:"(Navigator)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Netscape"},{regex:"(Navigator)/(\\d+)\\.(\\d+)([ab]\\d+)",family_replacement:"Netscape"},{regex:"(Netscape6)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Netscape"},{regex:"(MyIBrow)/(\\d+)\\.(\\d+)",family_replacement:"My Internet Browser",other:!0},{regex:"(Opera Tablet).*Version/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",family_replacement:"Opera Tablet",tablet:!0},{regex:"(Opera)/.+Opera Mobi.+Version/(\\d+)\\.(\\d+)",family_replacement:"Opera Mobile"},{regex:"Opera Mobi",family_replacement:"Opera Mobile"},{regex:"(Opera Mini)/(\\d+)\\.(\\d+)",family_replacement:"Opera Mini"},{regex:"(Opera Mini)/att/(\\d+)\\.(\\d+)",family_replacement:"Opera Mini"},{regex:"(Opera)/9.80.*Version/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",family_replacement:"Opera"},{regex:"(webOSBrowser)/(\\d+)\\.(\\d+)",family_replacement:"webOS"},{regex:"(webOS)/(\\d+)\\.(\\d+)",family_replacement:"webOS"},{regex:"(wOSBrowser).+TouchPad/(\\d+)\\.(\\d+)",family_replacement:"webOS TouchPad"},{regex:"(luakit)",family_replacement:"LuaKit",other:!0},{regex:"(Lightning)/(\\d+)\\.(\\d+)([ab]?\\d+[a-z]*)",family_replacement:"Lightning",other:!0},{regex:"(Firefox)/(\\d+)\\.(\\d+)\\.(\\d+(?:pre)?) \\(Swiftfox\\)",family_replacement:"Swiftfox",other:!0},{regex:"(Firefox)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)? \\(Swiftfox\\)",family_replacement:"Swiftfox",other:!0},{regex:"rekonq",family_replacement:"Rekonq",other:!0},{regex:"(conkeror|Conkeror)/(\\d+)\\.(\\d+)\\.?(\\d+)?",family_replacement:"Conkeror",other:!0},{regex:"(konqueror)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Konqueror",other:!0},{regex:"(WeTab)-Browser",family_replacement:"WeTab",other:!0},{regex:"(Comodo_Dragon)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Comodo Dragon",other:!0},{regex:"(YottaaMonitor)",family_replacement:"Yottaa Monitor",other:!0},{regex:"(Kindle)/(\\d+)\\.(\\d+)",family_replacement:"Kindle"},{regex:"(Symphony) (\\d+).(\\d+)",family_replacement:"Symphony",other:!0},{regex:"Minimo",family_replacement:"Minimo",other:!0},{regex:"(CrMo)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Mobile"},{regex:"(CriOS)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Mobile iOS"},{regex:"(Chrome)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+) Mobile",family_replacement:"Chrome Mobile"},{regex:"(chromeframe)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Frame"},{regex:"(UC Browser)(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"UC Browser",other:!0},{regex:"(SLP Browser)/(\\d+)\\.(\\d+)",family_replacement:"Tizen Browser",other:!0},{regex:"(Epiphany)/(\\d+)\\.(\\d+).(\\d+)",family_replacement:"Epiphany",other:!0},{regex:"(SE 2\\.X) MetaSr (\\d+)\\.(\\d+)",family_replacement:"Sogou Explorer",other:!0},{regex:"(Pingdom.com_bot_version_)(\\d+)\\.(\\d+)",family_replacement:"PingdomBot",other:!0},{regex:"(facebookexternalhit)/(\\d+)\\.(\\d+)",family_replacement:"FacebookBot"},{regex:"(Twitterbot)/(\\d+)\\.(\\d+)",family_replacement:"TwitterBot"},{regex:"(AdobeAIR|Chromium|FireWeb|Jasmine|ANTGalio|Midori|Fresco|Lobo|PaleMoon|Maxthon|Lynx|OmniWeb|Dillo|Camino|Demeter|Fluid|Fennec|Shiira|Sunrise|Chrome|Flock|Netscape|Lunascape|WebPilot|NetFront|Netfront|Konqueror|SeaMonkey|Kazehakase|Vienna|Iceape|Iceweasel|IceWeasel|Iron|K-Meleon|Sleipnir|Galeon|GranParadiso|Opera Mini|iCab|NetNewsWire|ThunderBrowse|Iron|Iris|UP\\.Browser|Bunjaloo|Google Earth|Raven for Mac)/(\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(Bolt|Jasmine|IceCat|Skyfire|Midori|Maxthon|Lynx|Arora|IBrowse|Dillo|Camino|Shiira|Fennec|Phoenix|Chrome|Flock|Netscape|Lunascape|Epiphany|WebPilot|Opera Mini|Opera|NetFront|Netfront|Konqueror|Googlebot|SeaMonkey|Kazehakase|Vienna|Iceape|Iceweasel|IceWeasel|Iron|K-Meleon|Sleipnir|Galeon|GranParadiso|iCab|NetNewsWire|Iron|Space Bison|Stainless|Orca|Dolfin|BOLT|Minimo|Tizen Browser|Polaris)/(\\d+)\\.(\\d+)"},{regex:"(iRider|Crazy Browser|SkipStone|iCab|Lunascape|Sleipnir|Maemo Browser) (\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(iCab|Lunascape|Opera|Android|Jasmine|Polaris|BREW) (\\d+)\\.(\\d+)\\.?(\\d+)?"},{regex:"(Android) Donut",v2_replacement:"2",v1_replacement:"1"},{regex:"(Android) Eclair",v2_replacement:"1",v1_replacement:"2"},{regex:"(Android) Froyo",v2_replacement:"2",v1_replacement:"2"},{regex:"(Android) Gingerbread",v2_replacement:"3",v1_replacement:"2"},{regex:"(Android) Honeycomb",v1_replacement:"3"},{regex:"(IEMobile)[ /](\\d+)\\.(\\d+)",family_replacement:"IE Mobile"},{regex:"(MSIE) (\\d+)\\.(\\d+).*XBLWP7",family_replacement:"IE Large Screen"},{regex:"(Firefox)/(\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(pre|[ab]\\d+[a-z]*)?"},{regex:"(Obigo)InternetBrowser",other:!0},{regex:"(Obigo)\\-Browser",other:!0},{regex:"(Obigo|OBIGO)[^\\d]*(\\d+)(?:.(\\d+))?",other:!0},{regex:"(MAXTHON|Maxthon) (\\d+)\\.(\\d+)",family_replacement:"Maxthon",other:!0},{regex:"(Maxthon|MyIE2|Uzbl|Shiira)",v1_replacement:"0",other:!0},{regex:"(PLAYSTATION) (\\d+)",family_replacement:"PlayStation",manufacturer:"Sony"},{regex:"(PlayStation Portable)[^\\d]+(\\d+).(\\d+)",manufacturer:"Sony"},{regex:"(BrowseX) \\((\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(POLARIS)/(\\d+)\\.(\\d+)",family_replacement:"Polaris",other:!0},{regex:"(Embider)/(\\d+)\\.(\\d+)",family_replacement:"Polaris",other:!0},{regex:"(BonEcho)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Bon Echo",other:!0},{regex:"(iPod).+Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPod).*Version/(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPod)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPhone).*Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPhone).*Version/(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPhone)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPad).*Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",tablet:!0,manufacturer:"Apple"},{regex:"(iPad).*Version/(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",tablet:!0,manufacturer:"Apple"},{regex:"(iPad)",family_replacement:"Mobile Safari",tablet:!0,manufacturer:"Apple"},{regex:"(AvantGo) (\\d+).(\\d+)",other:!0},{regex:"(Avant)",v1_replacement:"1",other:!0},{regex:"^(Nokia)",family_replacement:"Nokia Services (WAP) Browser",manufacturer:"Nokia"},{regex:"(NokiaBrowser)/(\\d+)\\.(\\d+).(\\d+)\\.(\\d+)",manufacturer:"Nokia"},{regex:"(NokiaBrowser)/(\\d+)\\.(\\d+).(\\d+)",manufacturer:"Nokia"},{regex:"(NokiaBrowser)/(\\d+)\\.(\\d+)",manufacturer:"Nokia"},{regex:"(BrowserNG)/(\\d+)\\.(\\d+).(\\d+)",family_replacement:"NokiaBrowser",manufacturer:"Nokia"},{regex:"(Series60)/5\\.0",v2_replacement:"0",v1_replacement:"7",family_replacement:"NokiaBrowser",manufacturer:"Nokia"},{regex:"(Series60)/(\\d+)\\.(\\d+)",family_replacement:"Nokia OSS Browser",manufacturer:"Nokia"},{regex:"(S40OviBrowser)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Nokia Series 40 Ovi Browser",manufacturer:"Nokia"},{regex:"(Nokia)[EN]?(\\d+)",manufacturer:"Nokia"},{regex:"(BB10);",family_replacement:"Blackberry WebKit",manufacturer:"RIM"},{regex:"(PlayBook).+RIM Tablet OS (\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Blackberry WebKit",tablet:!0,manufacturer:"Nokia"},{regex:"(Black[bB]erry).+Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Blackberry WebKit",manufacturer:"RIM"},{regex:"(Black[bB]erry)\\s?(\\d+)",family_replacement:"Blackberry",manufacturer:"RIM"},{regex:"(OmniWeb)/v(\\d+)\\.(\\d+)",other:!0},{regex:"(Blazer)/(\\d+)\\.(\\d+)",family_replacement:"Palm Blazer",manufacturer:"Palm"},{regex:"(Pre)/(\\d+)\\.(\\d+)",family_replacement:"Palm Pre",manufacturer:"Palm"},{regex:"(Links) \\((\\d+)\\.(\\d+)",other:!0},{regex:"(QtWeb) Internet Browser/(\\d+)\\.(\\d+)",other:!0},{regex:"(Silk)/(\\d+)\\.(\\d+)(?:\\.([0-9\\-]+))?",other:!0,tablet:!0},{regex:"(AppleWebKit)/(\\d+)\\.?(\\d+)?\\+ .* Version/\\d+\\.\\d+.\\d+ Safari/",family_replacement:"WebKit Nightly"},{regex:"(Version)/(\\d+)\\.(\\d+)(?:\\.(\\d+))?.*Safari/",family_replacement:"Safari"},{regex:"(Safari)/\\d+"},{regex:"(OLPC)/Update(\\d+)\\.(\\d+)",other:!0},{regex:"(OLPC)/Update()\\.(\\d+)",v1_replacement:"0",other:!0},{regex:"(SEMC\\-Browser)/(\\d+)\\.(\\d+)",other:!0},{regex:"(Teleca)",family_replacement:"Teleca Browser",other:!0},{regex:"(MSIE) (\\d+)\\.(\\d+)",family_replacement:"IE"}],os_parsers:[{regex:"(Android) (\\d+)\\.(\\d+)(?:[.\\-]([a-z0-9]+))?"},{regex:"(Android)\\-(\\d+)\\.(\\d+)(?:[.\\-]([a-z0-9]+))?"},{regex:"(Android) Donut",os_v2_replacement:"2",os_v1_replacement:"1"},{regex:"(Android) Eclair",os_v2_replacement:"1",os_v1_replacement:"2"},{regex:"(Android) Froyo",os_v2_replacement:"2",os_v1_replacement:"2"},{regex:"(Android) Gingerbread",os_v2_replacement:"3",os_v1_replacement:"2"},{regex:"(Android) Honeycomb",os_v1_replacement:"3"},{regex:"(Windows Phone 6\\.5)"},{regex:"(Windows (?:NT 5\\.2|NT 5\\.1))",os_replacement:"Windows XP"},{regex:"(XBLWP7)",os_replacement:"Windows Phone OS"},{regex:"(Windows NT 6\\.1)",os_replacement:"Windows 7"},{regex:"(Windows NT 6\\.0)",os_replacement:"Windows Vista"},{regex:"(Windows 98|Windows XP|Windows ME|Windows 95|Windows CE|Windows 7|Windows NT 4\\.0|Windows Vista|Windows 2000)"},{regex:"(Windows NT 6\\.2)",os_replacement:"Windows 8"},{regex:"(Windows Phone 8)",os_replacement:"Windows Phone 8"},{regex:"(Windows NT 5\\.0)",os_replacement:"Windows 2000"},{regex:"(Windows Phone OS) (\\d+)\\.(\\d+)"},{regex:"(Windows ?Mobile)",os_replacement:"Windows Mobile"},{regex:"(WinNT4.0)",os_replacement:"Windows NT 4.0"},{regex:"(Win98)",os_replacement:"Windows 98"},{regex:"(Tizen)/(\\d+)\\.(\\d+)",other:!0},{regex:"(Mac OS X) (\\d+)[_.](\\d+)(?:[_.](\\d+))?",manufacturer:"Apple"},{regex:"(?:PPC|Intel) (Mac OS X)",manufacturer:"Apple"},{regex:"(CPU OS|iPhone OS) (\\d+)_(\\d+)(?:_(\\d+))?",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(iPhone|iPad|iPod); Opera",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(iPad); Opera",tablet:!0,manufacturer:"Apple"},{regex:"(iPhone|iPad|iPod).*Mac OS X.*Version/(\\d+)\\.(\\d+)",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(CrOS) [a-z0-9_]+ (\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"Chrome OS"},{regex:"(Debian)-(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",other:!0},{regex:"(Linux Mint)(?:/(\\d+))?",other:!0},{regex:"(Mandriva)(?: Linux)?/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",other:!0},{regex:"(Symbian[Oo][Ss])/(\\d+)\\.(\\d+)",os_replacement:"Symbian OS"},{regex:"(Symbian/3).+NokiaBrowser/7\\.3",os_replacement:"Symbian^3 Anna"},{regex:"(Symbian/3).+NokiaBrowser/7\\.4",os_replacement:"Symbian^3 Belle"},{regex:"(Symbian/3)",os_replacement:"Symbian^3"},{regex:"(Series 60|SymbOS|S60)",os_replacement:"Symbian OS"},{regex:"(MeeGo)",other:!0},{regex:"Symbian [Oo][Ss]",os_replacement:"Symbian OS"},{regex:"(BB10);.+Version/(\\d+).(\\d+).(\\d+)",os_replacement:"BlackBerry OS",manufacturer:"RIM"},{regex:"(Black[Bb]erry)[0-9a-z]+/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"BlackBerry OS",manufacturer:"RIM"},{regex:"(Black[Bb]erry).+Version/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"BlackBerry OS",manufacturer:"RIM"},{regex:"(RIM Tablet OS) (\\d+)\\.(\\d+)\\.(\\d+)",os_replacement:"BlackBerry Tablet OS",tablet:!0,manufacturer:"RIM"},{regex:"(Play[Bb]ook)",os_replacement:"BlackBerry Tablet OS",tablet:!0,manufacturer:"RIM"},{regex:"(Black[Bb]erry)",os_replacement:"Blackberry OS",manufacturer:"RIM"},{regex:"(webOS|hpwOS)/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"webOS"},{regex:"(SUSE|Fedora|Red Hat|PCLinuxOS)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(SUSE|Fedora|Red Hat|Puppy|PCLinuxOS|CentOS)/(\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(Ubuntu|Kindle|Bada|Lubuntu|BackTrack|Red Hat|Slackware)/(\\d+)\\.(\\d+)"},{regex:"(Windows|OpenBSD|FreeBSD|NetBSD|Ubuntu|Kubuntu|Android|Arch Linux|CentOS|WeTab|Slackware)"},{regex:"(Linux|BSD)",other:!0}],mobile_os_families:["Windows Phone 6.5","Windows CE","Symbian OS"],device_parsers:[{regex:"HTC ([A-Z][a-z0-9]+) Build",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC ([A-Z][a-z0-9 ]+) \\d+\\.\\d+\\.\\d+\\.\\d+",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC_Touch_([A-Za-z0-9]+)",device_replacement:"HTC Touch ($1)",manufacturer:"HTC"},{regex:"USCCHTC(\\d+)",device_replacement:"HTC $1 (US Cellular)",manufacturer:"HTC"},{regex:"Sprint APA(9292)",device_replacement:"HTC $1 (Sprint)",manufacturer:"HTC"},{regex:"HTC ([A-Za-z0-9]+ [A-Z])",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC-([A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC_([A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC ([A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"(ADR[A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"(HTC)",manufacturer:"HTC"},{regex:"SonyEricsson([A-Za-z0-9]+)/",device_replacement:"Ericsson $1",other:!0,manufacturer:"Sony"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\; [A-Za-z]{2}\\-[A-Za-z]{2}\\; WOWMobile (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\.[\\d]+; [A-Za-z]{2}\\-[A-Za-z]{2}\\; (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\-update1\\; [A-Za-z]{2}\\-[A-Za-z]{2}\\; (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\; [A-Za-z]{2}\\-[A-Za-z]{2}\\; (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\.[\\d]+; (.+) Build"},{regex:"NokiaN([0-9]+)",device_replacement:"Nokia N$1",manufacturer:"Nokia"},{regex:"Nokia([A-Za-z0-9\\v-]+)",device_replacement:"Nokia $1",manufacturer:"Nokia"},{regex:"NOKIA ([A-Za-z0-9\\-]+)",device_replacement:"Nokia $1",manufacturer:"Nokia"},{regex:"Nokia ([A-Za-z0-9\\-]+)",device_replacement:"Nokia $1",manufacturer:"Nokia"},{regex:"Lumia ([A-Za-z0-9\\-]+)",device_replacement:"Lumia $1",manufacturer:"Nokia"},{regex:"Symbian",device_replacement:"Nokia",manufacturer:"Nokia"},{regex:"BB10; ([A-Za-z0-9- ]+)\\)",device_replacement:"BlackBerry $1",manufacturer:"RIM"},{regex:"(PlayBook).+RIM Tablet OS",device_replacement:"Blackberry Playbook",tablet:!0,manufacturer:"RIM"},{regex:"(Black[Bb]erry [0-9]+);",manufacturer:"RIM"},{regex:"Black[Bb]erry([0-9]+)",device_replacement:"BlackBerry $1",manufacturer:"RIM"},{regex:"(Pre)/(\\d+)\\.(\\d+)",device_replacement:"Palm Pre",manufacturer:"Palm"},{regex:"(Pixi)/(\\d+)\\.(\\d+)",device_replacement:"Palm Pixi",manufacturer:"Palm"},{regex:"(Touchpad)/(\\d+)\\.(\\d+)",device_replacement:"HP Touchpad",manufacturer:"HP"},{regex:"HPiPAQ([A-Za-z0-9]+)/(\\d+).(\\d+)",device_replacement:"HP iPAQ $1",manufacturer:"HP"},{regex:"Palm([A-Za-z0-9]+)",device_replacement:"Palm $1",manufacturer:"Palm"},{regex:"Treo([A-Za-z0-9]+)",device_replacement:"Palm Treo $1",manufacturer:"Palm"},{regex:"webOS.*(P160UNA)/(\\d+).(\\d+)",device_replacement:"HP Veer",manufacturer:"HP"},{regex:"(Kindle Fire)",manufacturer:"Amazon"},{regex:"(Kindle)",manufacturer:"Amazon"},{regex:"(Silk)/(\\d+)\\.(\\d+)(?:\\.([0-9\\-]+))?",device_replacement:"Kindle Fire",tablet:!0,manufacturer:"Amazon"},{regex:"(iPad) Simulator;",manufacturer:"Apple"},{regex:"(iPad);",manufacturer:"Apple"},{regex:"(iPod);",manufacturer:"Apple"},{regex:"(iPhone) Simulator;",manufacturer:"Apple"},{regex:"(iPhone);",manufacturer:"Apple"},{regex:"Nexus\\ ([A-Za-z0-9\\-]+)",device_replacement:"Nexus $1"},{regex:"acer_([A-Za-z0-9]+)_",device_replacement:"Acer $1",manufacturer:"Acer"},{regex:"acer_([A-Za-z0-9]+)_",device_replacement:"Acer $1",manufacturer:"Acer"},{regex:"Amoi\\-([A-Za-z0-9]+)",device_replacement:"Amoi $1",other:!0,manufacturer:"Amoi"},{regex:"AMOI\\-([A-Za-z0-9]+)",device_replacement:"Amoi $1",other:!0,manufacturer:"Amoi"},{regex:"Asus\\-([A-Za-z0-9]+)",device_replacement:"Asus $1",manufacturer:"Asus"},{regex:"ASUS\\-([A-Za-z0-9]+)",device_replacement:"Asus $1",manufacturer:"Asus"},{regex:"BIRD\\-([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"BIRD\\.([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"BIRD ([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"Dell ([A-Za-z0-9]+)",device_replacement:"Dell $1",manufacturer:"Dell"},{regex:"DoCoMo/2\\.0 ([A-Za-z0-9]+)",device_replacement:"DoCoMo $1",other:!0},{regex:"([A-Za-z0-9]+)\\_W\\;FOMA",device_replacement:"DoCoMo $1",other:!0},{regex:"([A-Za-z0-9]+)\\;FOMA",device_replacement:"DoCoMo $1",other:!0},{regex:"vodafone([A-Za-z0-9]+)",device_replacement:"Huawei Vodafone $1",other:!0},{regex:"i\\-mate ([A-Za-z0-9]+)",device_replacement:"i-mate $1",other:!0},{regex:"Kyocera\\-([A-Za-z0-9]+)",device_replacement:"Kyocera $1",other:!0},{regex:"KWC\\-([A-Za-z0-9]+)",device_replacement:"Kyocera $1",other:!0},{regex:"Lenovo\\-([A-Za-z0-9]+)",device_replacement:"Lenovo $1",manufacturer:"Lenovo"},{regex:"Lenovo\\_([A-Za-z0-9]+)",device_replacement:"Lenovo $1",manufacturer:"Levovo"},{regex:"LG/([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG-LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE-LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE VX([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG ([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE LG\\-AX([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG\\-([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE\\-([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"(KIN)\\.One (\\d+)\\.(\\d+)",device_replacement:"Microsoft $1"},{regex:"(KIN)\\.Two (\\d+)\\.(\\d+)",device_replacement:"Microsoft $1"},{regex:"(Motorola)\\-([A-Za-z0-9]+)",manufacturer:"Motorola"},{regex:"MOTO\\-([A-Za-z0-9]+)",device_replacement:"Motorola $1",manufacturer:"Motorola"},{regex:"MOT\\-([A-Za-z0-9]+)",device_replacement:"Motorola $1",manufacturer:"Motorola"},{regex:"Philips([A-Za-z0-9]+)",device_replacement:"Philips $1",manufacturer:"Philips"},{regex:"Philips ([A-Za-z0-9]+)",device_replacement:"Philips $1",manufacturer:"Philips"},{regex:"SAMSUNG-([A-Za-z0-9\\-]+)",device_replacement:"Samsung $1",manufacturer:"Samsung"},{regex:"SAMSUNG\\; ([A-Za-z0-9\\-]+)",device_replacement:"Samsung $1",manufacturer:"Samsung"},{regex:"Softbank/1\\.0/([A-Za-z0-9]+)",device_replacement:"Softbank $1",other:!0},{regex:"Softbank/2\\.0/([A-Za-z0-9]+)",device_replacement:"Softbank $1",other:!0},{regex:"(hiptop|avantgo|plucker|xiino|blazer|elaine|up.browser|up.link|mmp|smartphone|midp|wap|vodafone|o2|pocket|mobile|pda)",device_replacement:"Generic Smartphone"},{regex:"^(1207|3gso|4thp|501i|502i|503i|504i|505i|506i|6310|6590|770s|802s|a wa|acer|acs\\-|airn|alav|asus|attw|au\\-m|aur |aus |abac|acoo|aiko|alco|alca|amoi|anex|anny|anyw|aptu|arch|argo|bell|bird|bw\\-n|bw\\-u|beck|benq|bilb|blac|c55/|cdm\\-|chtm|capi|comp|cond|craw|dall|dbte|dc\\-s|dica|ds\\-d|ds12|dait|devi|dmob|doco|dopo|el49|erk0|esl8|ez40|ez60|ez70|ezos|ezze|elai|emul|eric|ezwa|fake|fly\\-|fly\\_|g\\-mo|g1 u|g560|gf\\-5|grun|gene|go.w|good|grad|hcit|hd\\-m|hd\\-p|hd\\-t|hei\\-|hp i|hpip|hs\\-c|htc |htc\\-|htca|htcg)",device_replacement:"Generic Feature Phone"},{regex:"^(htcp|htcs|htct|htc\\_|haie|hita|huaw|hutc|i\\-20|i\\-go|i\\-ma|i230|iac|iac\\-|iac/|ig01|im1k|inno|iris|jata|java|kddi|kgt|kgt/|kpt |kwc\\-|klon|lexi|lg g|lg\\-a|lg\\-b|lg\\-c|lg\\-d|lg\\-f|lg\\-g|lg\\-k|lg\\-l|lg\\-m|lg\\-o|lg\\-p|lg\\-s|lg\\-t|lg\\-u|lg\\-w|lg/k|lg/l|lg/u|lg50|lg54|lge\\-|lge/|lynx|leno|m1\\-w|m3ga|m50/|maui|mc01|mc21|mcca|medi|meri|mio8|mioa|mo01|mo02|mode|modo|mot |mot\\-|mt50|mtp1|mtv |mate|maxo|merc|mits|mobi|motv|mozz|n100|n101|n102|n202|n203|n300|n302|n500|n502|n505|n700|n701|n710|nec\\-|nem\\-|newg|neon)",device_replacement:"Generic Feature Phone"},{regex:"^(netf|noki|nzph|o2 x|o2\\-x|opwv|owg1|opti|oran|ot\\-s|p800|pand|pg\\-1|pg\\-2|pg\\-3|pg\\-6|pg\\-8|pg\\-c|pg13|phil|pn\\-2|pt\\-g|palm|pana|pire|pock|pose|psio|qa\\-a|qc\\-2|qc\\-3|qc\\-5|qc\\-7|qc07|qc12|qc21|qc32|qc60|qci\\-|qwap|qtek|r380|r600|raks|rim9|rove|s55/|sage|sams|sc01|sch\\-|scp\\-|sdk/|se47|sec\\-|sec0|sec1|semc|sgh\\-|shar|sie\\-|sk\\-0|sl45|slid|smb3|smt5|sp01|sph\\-|spv |spv\\-|sy01|samm|sany|sava|scoo|send|siem|smar|smit|soft|sony|t\\-mo|t218|t250|t600|t610|t618|tcl\\-|tdg\\-|telm|tim\\-|ts70|tsm\\-|tsm3|tsm5|tx\\-9|tagt)",device_replacement:"Generic Feature Phone"},{regex:"^(talk|teli|topl|tosh|up.b|upg1|utst|v400|v750|veri|vk\\-v|vk40|vk50|vk52|vk53|vm40|vx98|virg|vite|voda|vulc|w3c |w3c\\-|wapj|wapp|wapu|wapm|wig |wapi|wapr|wapv|wapy|wapa|waps|wapt|winc|winw|wonu|x700|xda2|xdag|yas\\-|your|zte\\-|zeto|aste|audi|avan|blaz|brew|brvw|bumb|ccwa|cell|cldc|cmd\\-|dang|eml2|fetc|hipt|http|ibro|idea|ikom|ipaq|jbro|jemu|jigs|keji|kyoc|kyok|libw|m\\-cr|midp|mmef|moto|mwbp|mywa|newt|nok6|o2im|pant|pdxg|play|pluc|port|prox|rozo|sama|seri|smal|symb|treo|upsi|vx52|vx53|vx60|vx61|vx70|vx80|vx81|vx83|vx85|wap\\-|webc|whit|wmlb|xda\\-|xda\\_)",device_replacement:"Generic Feature Phone"},{regex:"(bot|borg|google(^tv)|yahoo|slurp|msnbot|msrbot|openbot|archiver|netresearch|lycos|scooter|altavista|teoma|gigabot|baiduspider|blitzbot|oegp|charlotte|furlbot|http%20client|polybot|htdig|ichiro|mogimogi|larbin|pompos|scrubby|searchsight|seekbot|semanticdiscovery|silk|snappy|speedy|spider|voila|vortex|voyager|zao|zeal|fast\\-webcrawler|converacrawler|dataparksearch|findlinks)",device_replacement:"Spider"}],mobile_browser_families:["Firefox Mobile","Opera Mobile","Opera Mini","Mobile Safari","webOS","IE Mobile","Playstation Portable","Nokia","Blackberry","Palm","Silk","Android","Maemo","Obigo","Netfront","AvantGo","Teleca","SEMC-Browser","Bolt","Iris","UP.Browser","Symphony","Minimo","Bunjaloo","Jasmine","Dolfin","Polaris","BREW","Chrome Mobile","Chrome Mobile iOS","UC Browser","Tizen Browser"]};
b.parsers=["device_parsers","browser_parsers","os_parsers","mobile_os_families","mobile_browser_families"],b.types=["browser","os","device"],b.regexes=c||function(){var a={};return b.parsers.map(function(b){a[b]=[]}),a}(),b.families=function(){var a={};return b.types.map(function(b){a[b]=[]}),a}();var d=Array.prototype,e=(Object.prototype,Function.prototype,d.forEach),f=(d.indexOf,function(a,b){for(var c={},d=0;d<b.length&&!(c=b[d](a));d++);return c}),g=function(a,b){h(a,function(a){h(b,function(b){delete a[b]})})},h=forEach=function(a,b,c){if(null!=a)if(e&&a.forEach===e)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,f=a.length;f>d;d++)if(b.call(c,a[d],d,a)==={})return}else for(var g in a)if(_.has(a,g)&&b.call(c,a[g],g,a)==={})return},i=function(a){return!(!a||"undefined"==typeof a||null==a)},j=function(a){var b="";return a=a||{},i(a)&&i(a.major)&&(b+=a.major,i(a.minor)&&(b+="."+a.minor,i(a.patch)&&(b+="."+a.patch))),b},k=function(a){a=a||{};var b=j(a);return b&&(b=" "+b),a&&i(a.family)?a.family+b:""};return b.parse=function(c){{var d=function(a){return b.regexes[a+"_parsers"].map(function(b){function c(a){var c=a.match(d);if(!c)return null;var g={};return g.family=(e?e.replace("$1",c[1]):c[1])||"other",g.major=parseInt(f?f:c[2])||null,g.minor=c[3]?parseInt(c[3]):null,g.patch=c[4]?parseInt(c[4]):null,g.tablet=b.tablet,g.man=b.manufacturer||null,g}var d=new RegExp(b.regex),e=b[("browser"===a?"family":a)+"_replacement"],f=b.major_version_replacement;return c})},e=function(){},h=d("browser"),l=d("os"),m=d("device");a=new e}a.browser=f(c,h),i(a.browser)?(a.browser.name=k(a.browser),a.browser.version=j(a.browser)):a.browser={},a.os=f(c,l),i(a.os)?(a.os.name=k(a.os),a.os.version=j(a.os)):a.os={},a.device=f(c,m),i(a.device)?(a.device.name=k(a.device),a.device.version=j(a.device)):a.device={tablet:!1};{var n={};b.regexes.mobile_browser_families.map(function(a){n[a]=!0}),b.regexes.mobile_os_families.map(function(a){n[a]=!0})}return a.device.type="Spider"===a.browser.family?"Spider":a.browser.tablet||a.os.tablet||a.device.tablet?"Tablet":n.hasOwnProperty(a.browser.family)?"Mobile":"Desktop",a.device.manufacturer=a.browser.man||a.os.man||a.device.man||null,g([a.browser,a.os,a.device],["tablet","man"]),a},b}();"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=c),exports.detect=c):b.detect=c,"function"==typeof define&&define.amd&&define(function(){return c})}(window);var saveAs=saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(a){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var b=a.document,c=function(){return a.URL||a.webkitURL||a},d=a.URL||a.webkitURL||a,e=b.createElementNS("http://www.w3.org/1999/xhtml","a"),f=!a.externalHost&&"download"in e,g=a.webkitRequestFileSystem,h=a.requestFileSystem||g||a.mozRequestFileSystem,i=function(b){(a.setImmediate||a.setTimeout)(function(){throw b},0)},j="application/octet-stream",k=0,l=[],m=function(){for(var a=l.length;a--;){var b=l[a];"string"==typeof b?d.revokeObjectURL(b):b.remove()}l.length=0},n=function(a,b,c){b=[].concat(b);for(var d=b.length;d--;){var e=a["on"+b[d]];if("function"==typeof e)try{e.call(a,c||a)}catch(f){i(f)}}},o=function(d,i){var m,o,p,q=this,r=d.type,s=!1,t=function(){var a=c().createObjectURL(d);return l.push(a),a},u=function(){n(q,"writestart progress write writeend".split(" "))},v=function(){(s||!m)&&(m=t(d)),o?o.location.href=m:window.open(m,"_blank"),q.readyState=q.DONE,u()},w=function(a){return function(){return q.readyState!==q.DONE?a.apply(this,arguments):void 0}},x={create:!0,exclusive:!1};if(q.readyState=q.INIT,i||(i="download"),f){m=t(d),b=a.document,e=b.createElementNS("http://www.w3.org/1999/xhtml","a"),e.href=m,e.download=i;var y=b.createEvent("MouseEvents");return y.initMouseEvent("click",!0,!1,a,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(y),q.readyState=q.DONE,void u()}return a.chrome&&r&&r!==j&&(p=d.slice||d.webkitSlice,d=p.call(d,0,d.size,j),s=!0),g&&"download"!==i&&(i+=".download"),(r===j||g)&&(o=a),h?(k+=d.size,void h(a.TEMPORARY,k,w(function(a){a.root.getDirectory("saved",x,w(function(a){var b=function(){a.getFile(i,x,w(function(a){a.createWriter(w(function(b){b.onwriteend=function(b){o.location.href=a.toURL(),l.push(a),q.readyState=q.DONE,n(q,"writeend",b)},b.onerror=function(){var a=b.error;a.code!==a.ABORT_ERR&&v()},"writestart progress write abort".split(" ").forEach(function(a){b["on"+a]=q["on"+a]}),b.write(d),q.abort=function(){b.abort(),q.readyState=q.DONE},q.readyState=q.WRITING}),v)}),v)};a.getFile(i,{create:!1},w(function(a){a.remove(),b()}),w(function(a){a.code===a.NOT_FOUND_ERR?b():v()}))}),v)}),v)):void v()},p=o.prototype,q=function(a,b){return new o(a,b)};return p.abort=function(){var a=this;a.readyState=a.DONE,n(a,"abort")},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,a.addEventListener("unload",m,!1),q.unload=function(){m(),a.removeEventListener("unload",m,!1)},q}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&(module.exports=saveAs);var __slice=Array.prototype.slice;!function(a){var b;return a.fn.sketch=function(){var c,d,e;return d=arguments[0],c=2<=arguments.length?__slice.call(arguments,1):[],this.length>1&&a.error("Sketch.js can only be called on one element at a time."),e=this.data("sketch"),"string"==typeof d&&e?e[d]?"function"==typeof e[d]?e[d].apply(e,c):0===c.length?e[d]:1===c.length?e[d]=c[0]:void 0:a.error("Sketch.js did not recognize the given command."):e?e:(this.data("sketch",new b(this.get(0),d)),this)},b=function(){function b(b,c){this.el=b,this.canvas=a(b),this.context=b.getContext("2d"),this.options=a.extend({toolLinks:!0,defaultTool:"marker",defaultColor:"#000000",defaultSize:5},c),this.painting=!1,this.color=this.options.defaultColor,this.size=this.options.defaultSize,this.tool=this.options.defaultTool,this.actions=[],this.action=[],this.canvas.bind("click mousedown mouseup mousemove mouseleave mouseout touchstart touchmove touchend touchcancel",this.onEvent),this.options.toolLinks&&a("body").delegate('a[href="#'+this.canvas.attr("id")+'"]',"click",function(){var b,c,d,e,f,g,h;for(c=a(this),b=a(c.attr("href")),e=b.data("sketch"),h=["color","size","tool"],f=0,g=h.length;g>f;f++)d=h[f],c.attr("data-"+d)&&e.set(d,a(this).attr("data-"+d));return a(this).attr("data-download")&&e.download(a(this).attr("data-download")),!1})}return b.prototype.download=function(a){var b;return a||(a="png"),"jpg"===a&&(a="jpeg"),b="image/"+a,window.open(this.el.toDataURL(b))},b.prototype.set=function(a,b){return this[a]=b,this.canvas.trigger("sketch.change"+a,b)},b.prototype.startPainting=function(){return this.painting=!0,this.action={tool:this.tool,color:this.color,size:parseFloat(this.size),events:[]}},b.prototype.stopPainting=function(){return this.action&&this.actions.push(this.action),this.painting=!1,this.action=null,this.redraw()},b.prototype.onEvent=function(b){return b.originalEvent&&b.originalEvent.targetTouches&&(b.pageX=b.originalEvent.targetTouches[0].pageX,b.pageY=b.originalEvent.targetTouches[0].pageY),a.sketch.tools[a(this).data("sketch").tool].onEvent.call(a(this).data("sketch"),b),b.preventDefault(),!1},b.prototype.redraw=function(){},b}(),a.sketch={tools:{}},a.sketch.tools.marker={onEvent:function(a){switch(a.type){case"mousedown":case"touchstart":this.startPainting();break;case"mouseup":case"mouseout":case"mouseleave":case"touchend":case"touchcancel":this.stopPainting()}return this.painting?(this.action.events.push({x:a.pageX-this.canvas.offset().left,y:a.pageY-this.canvas.offset().top,event:a.type}),this.redraw()):void 0},draw:function(a){var b,c,d,e,f;for(this.context.lineJoin="round",this.context.lineCap="round",this.context.beginPath(),this.context.moveTo(a.events[0].x,a.events[0].y),f=a.events,d=0,e=f.length;e>d;d++)b=f[d],this.context.lineTo(b.x,b.y),c=b;return this.context.strokeStyle=a.color,this.context.lineWidth=a.size,this.context.stroke()}},a.sketch.tools.eraser={onEvent:function(b){return a.sketch.tools.marker.onEvent.call(this,b)},draw:function(b){var c;return c=this.context.globalCompositeOperation,this.context.globalCompositeOperation="copy",b.color="rgba(0,0,0,0)",a.sketch.tools.marker.draw.call(this,b),this.context.globalCompositeOperation=c}}}(jQuery);